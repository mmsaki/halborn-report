<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.22">
<meta name="author" content="Meek Msaki">
<title>Halborn CTF Secutiy Report: Halborn Offensive Security Engineer applying for a full time position</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.pygments .hll { background-color: #6e7681 }
pre.pygments { background: #0d1117; color: #e6edf3 }
pre.pygments .tok-c { color: #8b949e; font-style: italic } /* Comment */
pre.pygments .tok-err { color: #f85149 } /* Error */
pre.pygments .tok-esc { color: #e6edf3 } /* Escape */
pre.pygments .tok-g { color: #e6edf3 } /* Generic */
pre.pygments .tok-k { color: #ff7b72 } /* Keyword */
pre.pygments .tok-l { color: #a5d6ff } /* Literal */
pre.pygments .tok-n { color: #e6edf3 } /* Name */
pre.pygments .tok-o { color: #ff7b72; font-weight: bold } /* Operator */
pre.pygments .tok-x { color: #e6edf3 } /* Other */
pre.pygments .tok-p { color: #e6edf3 } /* Punctuation */
pre.pygments .tok-ch { color: #8b949e; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #8b949e; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #8b949e; font-weight: bold; font-style: italic } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #8b949e; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #8b949e; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #8b949e; font-weight: bold; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #ffa198; background-color: #490202 } /* Generic.Deleted */
pre.pygments .tok-ge { color: #e6edf3; font-style: italic } /* Generic.Emph */
pre.pygments .tok-gr { color: #ffa198 } /* Generic.Error */
pre.pygments .tok-gh { color: #79c0ff; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #56d364; background-color: #0f5323 } /* Generic.Inserted */
pre.pygments .tok-go { color: #8b949e } /* Generic.Output */
pre.pygments .tok-gp { color: #8b949e } /* Generic.Prompt */
pre.pygments .tok-gs { color: #e6edf3; font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #79c0ff } /* Generic.Subheading */
pre.pygments .tok-gt { color: #ff7b72 } /* Generic.Traceback */
pre.pygments .tok-g-Underline { color: #e6edf3; text-decoration: underline } /* Generic.Underline */
pre.pygments .tok-kc { color: #79c0ff } /* Keyword.Constant */
pre.pygments .tok-kd { color: #ff7b72 } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #ff7b72 } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #79c0ff } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #ff7b72 } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #ff7b72 } /* Keyword.Type */
pre.pygments .tok-ld { color: #79c0ff } /* Literal.Date */
pre.pygments .tok-m { color: #a5d6ff } /* Literal.Number */
pre.pygments .tok-s { color: #a5d6ff } /* Literal.String */
pre.pygments .tok-na { color: #e6edf3 } /* Name.Attribute */
pre.pygments .tok-nb { color: #e6edf3 } /* Name.Builtin */
pre.pygments .tok-nc { color: #f0883e; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #79c0ff; font-weight: bold } /* Name.Constant */
pre.pygments .tok-nd { color: #d2a8ff; font-weight: bold } /* Name.Decorator */
pre.pygments .tok-ni { color: #ffa657 } /* Name.Entity */
pre.pygments .tok-ne { color: #f0883e; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #d2a8ff; font-weight: bold } /* Name.Function */
pre.pygments .tok-nl { color: #79c0ff; font-weight: bold } /* Name.Label */
pre.pygments .tok-nn { color: #ff7b72 } /* Name.Namespace */
pre.pygments .tok-nx { color: #e6edf3 } /* Name.Other */
pre.pygments .tok-py { color: #79c0ff } /* Name.Property */
pre.pygments .tok-nt { color: #7ee787 } /* Name.Tag */
pre.pygments .tok-nv { color: #79c0ff } /* Name.Variable */
pre.pygments .tok-ow { color: #ff7b72; font-weight: bold } /* Operator.Word */
pre.pygments .tok-pm { color: #e6edf3 } /* Punctuation.Marker */
pre.pygments .tok-w { color: #6e7681 } /* Text.Whitespace */
pre.pygments .tok-mb { color: #a5d6ff } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #a5d6ff } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #a5d6ff } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #a5d6ff } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #a5d6ff } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #79c0ff } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #a5d6ff } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #a5d6ff } /* Literal.String.Char */
pre.pygments .tok-dl { color: #79c0ff } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #a5d6ff } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #a5d6ff } /* Literal.String.Double */
pre.pygments .tok-se { color: #79c0ff } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #79c0ff } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #a5d6ff } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #a5d6ff } /* Literal.String.Other */
pre.pygments .tok-sr { color: #79c0ff } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #a5d6ff } /* Literal.String.Single */
pre.pygments .tok-ss { color: #a5d6ff } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #e6edf3 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #d2a8ff; font-weight: bold } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #79c0ff } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #79c0ff } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #79c0ff } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #79c0ff } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #a5d6ff } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="book">
<div id="header">
<h1>Halborn CTF Secutiy Report: Halborn Offensive Security Engineer applying for a full time position</h1>
<div class="details">
<span id="author" class="author">Meek Msaki</span><br>
<span id="email" class="email"><a href="mailto:meek10x@gmail.com">meek10x@gmail.com</a></span><br>
<span id="revnumber">version v1.0,</span>
<span id="revdate">04.01.2024</span>
<br><span id="revremark">Final Draft</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_summary">Summary</a></li>
</ul>
</li>
<li><a href="#_critical">I: Critical</a>
<ul class="sectlevel1">
<li><a href="#_c_1_btcd_mishandles_witness_size_checking">1. C-1 btcd mishandles witness size checking</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810">1.1. CVSS Score: 9.8/10</a></li>
<li><a href="#_specific_go_packages_affected">1.2. Specific Go Packages Affected</a></li>
</ul>
</li>
<li><a href="#_c_2_crossbeam_deque_data_race_before_v0_7_4_and_v0_8_1">2. C-2 crossbeam-deque Data Race before v0.7.4 and v0.8.1</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_2">2.1. CVSS Score: 9.8/10</a></li>
<li><a href="#_impact">2.2. Impact</a></li>
<li><a href="#_patches">2.3. Patches</a></li>
<li><a href="#_credits">2.4. Credits</a></li>
<li><a href="#_license">2.5. License</a></li>
</ul>
</li>
<li><a href="#_c_3_crossbeam_deque_data_race_before_v0_7_4_and_v0_8_1">3. C-3 crossbeam-deque Data Race before v0.7.4 and v0.8.1</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_3">3.1. CVSS Score: 9.8/10</a></li>
<li><a href="#_impact_2">3.2. Impact</a></li>
<li><a href="#_patches_2">3.3. Patches</a></li>
<li><a href="#_credits_2">3.4. Credits</a></li>
<li><a href="#_license_2">3.5. License</a></li>
</ul>
</li>
<li><a href="#_c_4_overflow_in_libsecp256k1">4. C-4 Overflow in libsecp256k1</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_4">4.1. CVSS Score: 9.8/10</a></li>
</ul>
</li>
<li><a href="#_c_5_out_of_bounds_write_in_nalgebra">5. C-5 Out of bounds write in nalgebra</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_5">5.1. CVSS Score: 9.8/10</a></li>
</ul>
</li>
<li><a href="#_c_6_rust_failure_crate_vulnerable_to_type_confusion">6. C-6 Rust Failure Crate Vulnerable to Type confusion</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_6">6.1. CVSS Score: 9.8/10</a></li>
</ul>
</li>
<li><a href="#_c_7_memory_flaw_in_zeroize_derive">7. C-7 Memory flaw in zeroize_derive</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_7">7.1. CVSS Score: 9.8/10</a></li>
</ul>
</li>
<li><a href="#_c_8_type_confusion_if_private_get_type_id_is_overriden">8. C-8 Type confusion if <em>private_get_type_id</em> is overriden</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_8">8.1. CVSS Score: 9.8/10</a></li>
</ul>
</li>
<li><a href="#_c_9_deserialization_of_untrusted_data_in_rust_cpuid">9. C-9 Deserialization of Untrusted Data in rust-cpuid</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_9_810_9">9.1. CVSS Score: 9.8/10</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_high">II: High</a>
<ul class="sectlevel1">
<li><a href="#_h_1_uncontrolled_resource_consumption">10. H-1 Uncontrolled Resource Consumption</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510">10.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_2_golang_orgxcryptossh_denial_of_service_via_crafted_signer">11. H-2 golang.org/x/crypto/ssh Denial of service via crafted Signer</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_2">11.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_3_golang_orgxnethttp2_denial_of_service_vulnerability">12. H-3 golang.org/x/net/http2 Denial of Service vulnerability</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_3">12.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_4_golang_orgxtextlanguage_denial_of_service_via_crafted_accept_language_header">13. H-4 golang.org/x/text/language Denial of service via crafted Accept-Language header</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_4">13.1. CVSS Score: 7.5/10</a></li>
<li><a href="#_specific_go_packages_affected_2">13.2. Specific Go Packages Affected</a></li>
</ul>
</li>
<li><a href="#_h_5_golang_orgxnethttp2h2c_vulnerable_to_request_smuggling_attack">14. H-5 golang.org/x/net/http2/h2c vulnerable to request smuggling attack</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_5">14.1. CVSS Score: 7.5/10</a></li>
<li><a href="#_specific_go_packages_affected_3">14.2. Specific Go Packages Affected</a></li>
</ul>
</li>
<li><a href="#_h_6_opencontainers_runc_incorrect_authorization_vulnerability">15. H-6 Opencontainers runc Incorrect Authorization vulnerability</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_010">15.1. CVSS Score: 7.0/10</a></li>
</ul>
</li>
<li><a href="#_h_7_docker_swarm_encrypted_overlay_network_may_be_unauthenticated">16. H-7 Docker Swarm encrypted overlay network may be unauthenticated</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_6">16.1. CVSS Score: 7.5/10</a></li>
<li><a href="#_impact_3">16.2. Impact</a></li>
<li><a href="#_patches_3">16.3. Patches</a></li>
<li><a href="#_workarounds">16.4. Workarounds</a></li>
<li><a href="#_background">16.5. Background</a></li>
<li><a href="#_related">16.6. Related</a></li>
</ul>
</li>
<li><a href="#_h_8_gopkg_inyaml_v3_denial_of_service">17. H-8 gopkg.in/yaml.v3 Denial of Service</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_7">17.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_9_http2_rapid_reset_can_cause_excessive_work_in_nethttp">18. H-9 HTTP/2 rapid reset can cause excessive work in net/http</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_8">18.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_10_grpc_go_http2_rapid_reset_vulnerability">19. H-10 gRPC-Go HTTP/2 Rapid Reset vulnerability</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_9">19.1. CVSS Score: 7.5/10</a></li>
<li><a href="#_impact_4">19.2. Impact</a></li>
<li><a href="#_patches_4">19.3. Patches</a></li>
<li><a href="#_workarounds_2">19.4. Workarounds</a></li>
<li><a href="#_references">19.5. References</a></li>
</ul>
</li>
<li><a href="#_h_11_runc_vulnerable_to_container_breakout_through_process_cwd_trickery_and_leaked_fds">20. H-11 runc vulnerable to container breakout through process.cwd trickery and leaked fds</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_8_610">20.1. CVSS Score: 8.6/10</a></li>
<li><a href="#_impact_5">20.2. Impact</a></li>
<li><a href="#_attack_1_process_cwd_mis_configuration">20.3. Attack 1: <code>process.cwd</code> "mis-configuration"</a></li>
<li><a href="#_attack_2_runc_exec_container_breakout">20.4. Attack 2: <code>runc exec</code> container breakout</a></li>
<li><a href="#_attacks_3a_and_3b_process_args_host_binary_overwrite_attack">20.5. Attacks 3a and 3b: <code>process.args</code> host binary overwrite attack</a></li>
<li><a href="#_patches_5">20.6. Patches</a></li>
<li><a href="#_other_runtimes">20.7. Other Runtimes</a></li>
<li><a href="#_workarounds_3">20.8. Workarounds</a></li>
<li><a href="#_see_also">20.9. See Also</a></li>
<li><a href="#_credits_3">20.10. Credits</a></li>
</ul>
</li>
<li><a href="#_h_12_memory_access_due_to_code_generation_flaw_in_cranelift_module">21. H-12 Memory access due to code generation flaw in Cranelift module</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_210">21.1. CVSS Score: 7.2/10</a></li>
<li><a href="#_description">21.2. Description</a></li>
<li><a href="#_general_impact_to_lucet">21.3. General Impact to Lucet</a></li>
<li><a href="#_general_impact_on_wasmtime">21.4. General Impact on Wasmtime</a></li>
</ul>
</li>
<li><a href="#_h_13_overflow_in_prost_types">22. H-13 Overflow in prost-types</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_10">22.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_14_soundness_issue_in_raw_cpuid">23. H-14 Soundness issue in raw-cpuid</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_11">23.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_15_use_after_free_in_lru">24. H-15 Use After Free in lru</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_12">24.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_16_crossbeam_utils_race_condition_vulnerability">25. H-16 crossbeam-utils Race Condition vulnerability</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_8_110">25.1. CVSS Score: 8.1/10</a></li>
<li><a href="#_impact_6">25.2. Impact</a></li>
<li><a href="#_patches_6">25.3. Patches</a></li>
<li><a href="#_references_2">25.4. References</a></li>
<li><a href="#_license_3">25.5. License</a></li>
</ul>
</li>
<li><a href="#_h_17_rusts_regex_crate_vulnerable_to_regular_expression_denial_of_service">26. H-17 Rust&#8217;s regex crate vulnerable to regular expression denial of service</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_13">26.1. CVSS Score: 7.5/10</a></li>
<li><a href="#_overview">26.2. Overview</a></li>
<li><a href="#_affected_versions">26.3. Affected versions</a></li>
<li><a href="#_mitigations">26.4. Mitigations</a></li>
<li><a href="#_acknowledgements">26.5. Acknowledgements</a></li>
</ul>
</li>
<li><a href="#_h_18_use_after_free_in_wasmtime">27. H-18 Use after free in Wasmtime</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_8_110_2">27.1. CVSS Score: 8.1/10</a></li>
</ul>
</li>
<li><a href="#_h_19_parser_creates_invalid_uninitialized_value">28. H-19 Parser creates invalid uninitialized value</a></li>
<li><a href="#_h_20_use_after_free_in_lru_crate">29. H-20 Use after free in lru crate</a></li>
<li><a href="#_h_21_data_race_in_iter_and_itermut">30. H-21 Data race in <code>Iter</code> and <code>IterMut</code></a></li>
<li><a href="#_h_22_wasmtime_may_have_data_leakage_between_instances_in_the_pooling_allocator">31. H-22 Wasmtime may have data leakage between instances in the pooling allocator</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_8_610_2">31.1. CVSS Score: 8.6/10</a></li>
<li><a href="#_impact_7">31.2. Impact</a></li>
<li><a href="#_patches_7">31.3. Patches</a></li>
<li><a href="#_workarounds_4">31.4. Workarounds</a></li>
<li><a href="#_references_3">31.5. References</a></li>
<li><a href="#_for_more_information">31.6. For more information</a></li>
</ul>
</li>
<li><a href="#_h_23_libp2p_dos_vulnerability_from_lack_of_resource_management">32. H-23 libp2p DoS vulnerability from lack of resource management</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_14">32.1. CVSS Score: 7.5/10</a></li>
<li><a href="#_impact_8">32.2. Impact</a></li>
<li><a href="#_details">32.3. Details</a></li>
<li><a href="#_patches_8">32.4. Patches</a></li>
<li><a href="#_references_4">32.5. References</a></li>
<li><a href="#_for_more_information_2">32.6. For more information</a></li>
</ul>
</li>
<li><a href="#_h_24_race_condition_in_tokio">33. H-24 Race Condition in tokio</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_8_110_3">33.1. CVSS Score: 8.1/10</a></li>
</ul>
</li>
<li><a href="#_h_25_webpki_cpu_denial_of_service_in_certificate_path_building">34. H-25 webpki: CPU denial of service in certificate path building</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_7_510_15">34.1. CVSS Score: 7.5/10</a></li>
</ul>
</li>
<li><a href="#_h_26_multiple_issues_involving_quote_api_in_shlex">35. H-26 Multiple issues involving quote API in shlex</a>
<ul class="sectlevel2">
<li><a href="#_issue_1_failure_to_quote_characters">35.1. Issue 1: Failure to quote characters</a></li>
<li><a href="#_issue_2_dangerous_api_w_r_t_nul_bytes">35.2. Issue 2: Dangerous API w.r.t. nul bytes</a></li>
<li><a href="#_issue_3_lack_of_documentation_for_interactive_shell_risks">35.3. Issue 3: Lack of documentation for interactive shell risks</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_medium">III: Medium</a>
<ul class="sectlevel1">
<li><a href="#_m_1_default_inheritable_capabilities_for_linux_container_should_be_empty">36. M-1 Default inheritable capabilities for linux container should be empty</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_910">36.1. CVSS Score: 5.9/10</a></li>
<li><a href="#_impact_9">36.2. Impact</a></li>
<li><a href="#_patches_9">36.3. Patches</a></li>
<li><a href="#_credits_4">36.4. Credits</a></li>
<li><a href="#_for_more_information_3">36.5. For more information</a></li>
</ul>
</li>
<li><a href="#_m_2_golang_orgxsysunix_has_incorrect_privilege_reporting_in_syscall">37. M-2 golang.org/x/sys/unix has Incorrect privilege reporting in syscall</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_310">37.1. CVSS Score: 5.3/10</a></li>
<li><a href="#_specific_go_packages_affected_4">37.2. Specific Go Packages Affected</a></li>
</ul>
</li>
<li><a href="#_m_3_runc_apparmor_bypass_with_symlinked_proc">38. M-3 runc AppArmor bypass with symlinked /proc</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_110">38.1. CVSS Score: 6.1/10</a></li>
<li><a href="#_impact_10">38.2. Impact</a></li>
<li><a href="#_patches_10">38.3. Patches</a></li>
<li><a href="#_workarounds_5">38.4. Workarounds</a></li>
</ul>
</li>
<li><a href="#_m_4_docker_swarm_encrypted_overlay_network_with_a_single_endpoint_is_unauthenticated">39. M-4 Docker Swarm encrypted overlay network with a single endpoint is unauthenticated</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_810">39.1. CVSS Score: 6.8/10</a></li>
<li><a href="#_impact_11">39.2. Impact</a></li>
<li><a href="#_patches_11">39.3. Patches</a></li>
<li><a href="#_workarounds_6">39.4. Workarounds</a></li>
<li><a href="#_background_2">39.5. Background</a></li>
<li><a href="#_related_2">39.6. Related</a></li>
</ul>
</li>
<li><a href="#_m_5_docker_swarm_encrypted_overlay_network_traffic_may_be_unencrypted">40. M-5 Docker Swarm encrypted overlay network traffic may be unencrypted</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_810_2">40.1. CVSS Score: 6.8/10</a></li>
<li><a href="#_impact_12">40.2. Impact</a></li>
<li><a href="#_patches_12">40.3. Patches</a></li>
<li><a href="#_workarounds_7">40.4. Workarounds</a></li>
<li><a href="#_background_3">40.5. Background</a></li>
<li><a href="#_related_3">40.6. Related</a></li>
</ul>
</li>
<li><a href="#_m_6_cosmos_sdk_cosmovisor_component_may_be_vulnerable_to_denial_of_service">41. M-6 Cosmos-SDK Cosmovisor component may be vulnerable to denial of service</a>
<ul class="sectlevel2">
<li><a href="#_how_to_tell_if_i_am_affected">41.1. How to tell if I am affected?</a></li>
</ul>
</li>
<li><a href="#_m_7_improper_rendering_of_text_nodes_in_golang_orgxnethtml">42. M-7 Improper rendering of text nodes in golang.org/x/net/html</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_110_2">42.1. CVSS Score: 6.1/10</a></li>
</ul>
</li>
<li><a href="#_m_8_http2_stream_cancellation_attack">43. M-8 HTTP/2 Stream Cancellation Attack</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_310_2">43.1. CVSS Score: 5.3/10</a></li>
<li><a href="#_http2_rapid_reset_attack">43.2. HTTP/2 Rapid reset attack</a></li>
<li><a href="#_swift_nio_http2_specific_advisory">43.3. swift-nio-http2 specific advisory</a></li>
</ul>
</li>
<li><a href="#_m_9_http2_stream_cancellation_attack">44. M-9 HTTP/2 Stream Cancellation Attack</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_310_3">44.1. CVSS Score: 5.3/10</a></li>
<li><a href="#_http2_rapid_reset_attack_2">44.2. HTTP/2 Rapid reset attack</a></li>
<li><a href="#_swift_nio_http2_specific_advisory_2">44.3. swift-nio-http2 specific advisory</a></li>
</ul>
</li>
<li><a href="#_m_10_prefix_truncation_attack_against_chacha20_poly1305_and_encrypt_then_mac_aka_terrapin">45. M-10 Prefix Truncation Attack against ChaCha20-Poly1305 and Encrypt-then-MAC aka Terrapin</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_910_2">45.1. CVSS Score: 5.9/10</a></li>
<li><a href="#_summary_2">45.2. Summary</a></li>
<li><a href="#_mitigations_2">45.3. Mitigations</a></li>
<li><a href="#_details_2">45.4. Details</a></li>
<li><a href="#_impact_13">45.5. Impact</a></li>
</ul>
</li>
<li><a href="#_m_11_denial_of_service_when_decrypting_attack_controlled_input_in_github_comdvsekhvalnovjose2go">46. M-11 Denial of service when decrypting attack controlled input in github.com/dvsekhvalnov/jose2go</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_310_4">46.1. CVSS Score: 5.3/10</a></li>
</ul>
</li>
<li><a href="#_m_12_sysdevicesvirtualpowercap_accessible_by_default_to_containers">47. M-12 /sys/devices/virtual/powercap accessible by default to containers</a>
<ul class="sectlevel2">
<li><a href="#_references_5">47.1. References</a></li>
</ul>
</li>
<li><a href="#_m_13_asa_2024_002_default_prepareproposalhandler_may_produce_invalid_proposals_when_used_with_default_sendernoncemempool">48. M-13 ASA-2024-002: Default <code>PrepareProposalHandler</code> may produce invalid proposals when used with default <code>SenderNonceMempool</code></a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_310_5">48.1. CVSS Score: 5.3/10</a></li>
<li><a href="#_asa_2024_002_default_prepareproposalhandler_may_produce_invalid_proposals_when_used_with_default_sendernoncemempool">48.2. ASA-2024-002: Default <code>PrepareProposalHandler</code> may produce invalid proposals when used with default <code>SenderNonceMempool</code></a></li>
<li><a href="#_summary_3">48.3. Summary</a></li>
<li><a href="#_next_steps_for_impacted_parties">48.4. Next Steps for Impacted Parties</a></li>
</ul>
</li>
<li><a href="#_m_14_jose2go_vulnerable_to_denial_of_service_via_large_p2c_value">49. M-14 jose2go vulnerable to denial of service via large p2c value</a></li>
<li><a href="#_m_15_golang_protojson_unmarshal_function_infinite_loop_when_unmarshaling_certain_forms_of_invalid_json">50. M-15 Golang protojson.Unmarshal function infinite loop when unmarshaling certain forms of invalid JSON</a></li>
<li><a href="#_m_16_classic_builder_cache_poisoning">51. M-16 Classic builder cache poisoning</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_910">51.1. CVSS Score: 6.9/10</a></li>
<li><a href="#_impact_14">51.2. Impact</a></li>
<li><a href="#_patches_13">51.3. Patches</a></li>
<li><a href="#_workarounds_8">51.4. Workarounds</a></li>
</ul>
</li>
<li><a href="#_m_17_mobys_external_dns_requests_from_internal_networks_could_lead_to_data_exfiltration">52. M-17 Moby&#8217;s external DNS requests from 'internal' networks could lead to data exfiltration</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_910_3">52.1. CVSS Score: 5.9/10</a></li>
<li><a href="#_impact_15">52.2. Impact</a></li>
<li><a href="#_patches_14">52.3. Patches</a></li>
<li><a href="#_workarounds_9">52.4. Workarounds</a></li>
<li><a href="#_background_4">52.5. Background</a></li>
</ul>
</li>
<li><a href="#_m_18_integer_overflow_in_chunked_transfer_encoding">53. M-18 Integer Overflow in Chunked Transfer-Encoding</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_910_4">53.1. CVSS Score: 5.9/10</a></li>
<li><a href="#_summary_4">53.2. Summary</a></li>
<li><a href="#_vulnerability">53.3. Vulnerability</a></li>
<li><a href="#_impact_16">53.4. Impact</a></li>
<li><a href="#_patches_15">53.5. Patches</a></li>
<li><a href="#_workarounds_10">53.6. Workarounds</a></li>
<li><a href="#_credits_5">53.7. Credits</a></li>
</ul>
</li>
<li><a href="#_m_19_error_on_unsupported_architectures_in_raw_cpuid">54. M-19 Error on unsupported architectures in raw-cpuid</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_510">54.1. CVSS Score: 5.5/10</a></li>
</ul>
</li>
<li><a href="#_m_20_data_races_in_lock_api">55. M-20 Data races in lock_api</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_4_710">55.1. CVSS Score: 4.7/10</a></li>
</ul>
</li>
<li><a href="#_m_21_data_races_in_lock_api">56. M-21 Data races in lock_api</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_4_710_2">56.1. CVSS Score: 4.7/10</a></li>
</ul>
</li>
<li><a href="#_m_22_data_races_in_lock_api">57. M-22 Data races in lock_api</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_4_710_3">57.1. CVSS Score: 4.7/10</a></li>
</ul>
</li>
<li><a href="#_m_23_data_races_in_lock_api">58. M-23 Data races in lock_api</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_4_710_4">58.1. CVSS Score: 4.7/10</a></li>
</ul>
</li>
<li><a href="#_m_24_data_races_in_lock_api">59. M-24 Data races in lock_api</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_510_2">59.1. CVSS Score: 5.5/10</a></li>
</ul>
</li>
<li><a href="#_m_25_invalid_drop_of_partially_initialized_instances_in_the_pooling_instance_allocator_for_modules_with_defined_externref_globals">60. M-25 Invalid drop of partially-initialized instances in the pooling instance allocator for modules with defined <code>externref</code> globals</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_110">60.1. CVSS Score: 5.1/10</a></li>
<li><a href="#_impact_17">60.2. Impact</a></li>
<li><a href="#_patches_16">60.3. Patches</a></li>
<li><a href="#_workarounds_11">60.4. Workarounds</a></li>
<li><a href="#_for_more_information_4">60.5. For more information</a></li>
</ul>
</li>
<li><a href="#_m_26_wrong_type_for_linker_define_functions_when_used_across_two_engines">61. M-26 Wrong type for <code>Linker</code>-define functions when used across two `Engine`s</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_310">61.1. CVSS Score: 6.3/10</a></li>
<li><a href="#_impact_18">61.2. Impact</a></li>
<li><a href="#_patches_17">61.3. Patches</a></li>
<li><a href="#_workarounds_12">61.4. Workarounds</a></li>
<li><a href="#_for_more_information_5">61.5. For more information</a></li>
</ul>
</li>
<li><a href="#_m_27_miscompilation_of_i8x16_swizzle_and_select_with_v128_inputs">62. M-27 Miscompilation of <code>i8x16.swizzle</code> and <code>select</code> with v128 inputs</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_4_810">62.1. CVSS Score: 4.8/10</a></li>
<li><a href="#_impact_19">62.2. Impact</a></li>
<li><a href="#_patches_18">62.3. Patches</a></li>
<li><a href="#_workarounds_13">62.4. Workarounds</a></li>
<li><a href="#_references_6">62.5. References</a></li>
<li><a href="#_for_more_information_6">62.6. For more information</a></li>
</ul>
</li>
<li><a href="#_m_28_cranelift_vulnerable_to_miscompilation_of_constant_values_in_division_on_aarch64">63. M-28 Cranelift vulnerable to miscompilation of constant values in division on AArch64</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_910_5">63.1. CVSS Score: 5.9/10</a></li>
<li><a href="#_impact_20">63.2. Impact</a></li>
<li><a href="#_patches_19">63.3. Patches</a></li>
<li><a href="#_workarounds_14">63.4. Workarounds</a></li>
<li><a href="#_for_more_information_7">63.5. For more information</a></li>
</ul>
</li>
<li><a href="#_m_29_cranelift_vulnerable_to_miscompilation_of_constant_values_in_division_on_aarch64">64. M-29 Cranelift vulnerable to miscompilation of constant values in division on AArch64</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_910_6">64.1. CVSS Score: 5.9/10</a></li>
<li><a href="#_impact_21">64.2. Impact</a></li>
<li><a href="#_patches_20">64.3. Patches</a></li>
<li><a href="#_workarounds_15">64.4. Workarounds</a></li>
<li><a href="#_for_more_information_8">64.5. For more information</a></li>
</ul>
</li>
<li><a href="#_m_30_owning_ref_vulnerable_to_multiple_soundness_issues">65. M-30 owning_ref vulnerable to multiple soundness issues</a></li>
<li><a href="#_m_31_rocksdb_vulnerable_to_out_of_bounds_read">66. M-31 rocksdb vulnerable to out-of-bounds read</a></li>
<li><a href="#_m_32_bumpalo_has_use_after_free_due_to_a_lifetime_error_in_vecinto_iter">67. M-32 bumpalo has use-after-free due to a lifetime error in <code>Vec::into_iter()</code></a></li>
<li><a href="#_m_33_wasmtime_out_of_bounds_readwrite_with_zero_memory_pages_configuration">68. M-33 Wasmtime out of bounds read/write with zero-memory-pages configuration</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_5_910_7">68.1. CVSS Score: 5.9/10</a></li>
<li><a href="#_impact_22">68.2. Impact</a></li>
<li><a href="#_patches_21">68.3. Patches</a></li>
<li><a href="#_workarounds_16">68.4. Workarounds</a></li>
<li><a href="#_references_7">68.5. References</a></li>
<li><a href="#_for_more_information_9">68.6. For more information</a></li>
</ul>
</li>
<li><a href="#_m_34_segmentation_fault_in_time">69. M-34 Segmentation fault in time</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_210">69.1. CVSS Score: 6.2/10</a></li>
<li><a href="#_impact_23">69.2. Impact</a></li>
<li><a href="#_patches_22">69.3. Patches</a></li>
<li><a href="#_workarounds_17">69.4. Workarounds</a></li>
<li><a href="#_references_8">69.5. References</a></li>
</ul>
</li>
<li><a href="#_m_35_h2_vulnerable_to_denial_of_service">70. M-35 h2 vulnerable to denial of service</a></li>
<li><a href="#_m_36_optional_deserialize_implementations_lacking_validation">71. M-36 Optional <code>Deserialize</code> implementations lacking validation</a></li>
<li><a href="#_m_37_use_after_free_passing_externrefs_to_wasm_in_wasmtime">72. M-37 Use after free passing `externref`s to Wasm in Wasmtime</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_6_310_2">72.1. CVSS Score: 6.3/10</a></li>
<li><a href="#_impact_24">72.2. Impact</a></li>
<li><a href="#_patches_23">72.3. Patches</a></li>
<li><a href="#_workarounds_18">72.4. Workarounds</a></li>
<li><a href="#_references_9">72.5. References</a></li>
<li><a href="#_for_more_information_10">72.6. For more information</a></li>
</ul>
</li>
<li><a href="#_m_38_memoffset_allows_reading_uninitialized_memory">73. M-38 memoffset allows reading uninitialized memory</a></li>
<li><a href="#_m_39_ed25519_dalek_double_public_key_signing_function_oracle_attack">74. M-39 <code>ed25519-dalek</code> Double Public Key Signing Function Oracle Attack</a></li>
<li><a href="#_m_40_resource_exhaustion_vulnerability_in_h2_may_lead_to_denial_of_service_dos">75. M-40 Resource exhaustion vulnerability in h2 may lead to Denial of Service (DoS)</a></li>
<li><a href="#_m_41_unauthenticated_nonce_increment_in_snow">76. M-41 Unauthenticated Nonce Increment in snow</a>
<ul class="sectlevel2">
<li><a href="#_impact_25">76.1. Impact</a></li>
<li><a href="#_patches_24">76.2. Patches</a></li>
<li><a href="#_references_10">76.3. References</a></li>
</ul>
</li>
<li><a href="#_m_42_miscompilation_of_i8x16_swizzle_and_select_with_v128_inputs">77. M-42 Miscompilation of <code>i8x16.swizzle</code> and <code>select</code> with v128 inputs</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_4_810_2">77.1. CVSS Score: 4.8/10</a></li>
<li><a href="#_impact_26">77.2. Impact</a></li>
<li><a href="#_patches_25">77.3. Patches</a></li>
<li><a href="#_workarounds_19">77.4. Workarounds</a></li>
<li><a href="#_references_11">77.5. References</a></li>
<li><a href="#_for_more_information_11">77.6. For more information</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_low">IV: Low</a>
<ul class="sectlevel1">
<li><a href="#_l_1_rootless_sysfscgroup_is_writable_when_cgroupns_isnt_unshared_in_runc">78. L-1 rootless: <code>/sys/fs/cgroup</code> is writable when cgroupns isn&#8217;t unshared in runc</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_2_510">78.1. CVSS Score: 2.5/10</a></li>
<li><a href="#_impact_27">78.2. Impact</a></li>
<li><a href="#_patches_26">78.3. Patches</a></li>
<li><a href="#_workarounds_20">78.4. Workarounds</a></li>
</ul>
</li>
<li><a href="#_l_2_go_package_github_comcosmoscosmos_sdk_module_xcrisis_does_not_cause_chain_halt">79. L-2 Go package github.com/cosmos/cosmos-sdk module x/crisis does NOT cause chain halt</a>
<ul class="sectlevel2">
<li><a href="#_xcrisis_does_not_cause_chain_halt">79.1. x/crisis does NOT cause chain halt</a></li>
<li><a href="#_impact_28">79.2. Impact</a></li>
<li><a href="#_details_3">79.3. Details</a></li>
<li><a href="#_patches_27">79.4. Patches</a></li>
<li><a href="#_workarounds_21">79.5. Workarounds</a></li>
<li><a href="#_references_12">79.6. References</a></li>
</ul>
</li>
<li><a href="#_l_3_github_comcosmoscosmos_sdks_xcrisis_does_not_charge_constantfee">80. L-3 github.com/cosmos/cosmos-sdk&#8217;s x/crisis does not charge ConstantFee</a>
<ul class="sectlevel2">
<li><a href="#_xcrisis_does_not_charge_constantfee">80.1. x/crisis does not charge ConstantFee</a></li>
<li><a href="#_impact_29">80.2. Impact</a></li>
<li><a href="#_details_4">80.3. Details</a></li>
<li><a href="#_patches_28">80.4. Patches</a></li>
<li><a href="#_workarounds_22">80.5. Workarounds</a></li>
<li><a href="#_references_13">80.6. References</a></li>
</ul>
</li>
<li><a href="#_l_4_asa_2024_003_missing_blockedaddressed_validation_in_vesting_module">81. L-4 ASA-2024-003: Missing <code>BlockedAddressed</code> Validation in Vesting Module</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_3_510">81.1. CVSS Score: 3.5/10</a></li>
<li><a href="#_asa_2024_003_missing_blockedaddressed_validation_in_vesting_module">81.2. ASA-2024-003: Missing <code>BlockedAddressed</code> Validation in Vesting Module</a></li>
<li><a href="#_description_2">81.3. Description</a></li>
<li><a href="#_next_steps_for_impacted_parties_2">81.4. Next Steps for Impacted Parties</a></li>
</ul>
</li>
<li><a href="#_l_5_asa_2024_005_potential_slashing_evasion_during_re_delegation">82. L-5 ASA-2024-005: Potential slashing evasion during re-delegation</a>
<ul class="sectlevel2">
<li><a href="#_asa_2024_005_potential_slashing_evasion_during_re_delegation">82.1. ASA-2024-005: Potential slashing evasion during re-delegation</a></li>
<li><a href="#_summary_5">82.2. Summary</a></li>
<li><a href="#_next_steps_for_impacted_parties_3">82.3. Next Steps for Impacted Parties</a></li>
</ul>
</li>
<li><a href="#_l_6_lenient_parsing_of_content_length_header_when_prefixed_with_plus_sign">83. L-6 Lenient Parsing of Content-Length Header When Prefixed with Plus Sign</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_3_110">83.1. CVSS Score: 3.1/10</a></li>
<li><a href="#_summary_6">83.2. Summary</a></li>
<li><a href="#_vulnerability_2">83.3. Vulnerability</a></li>
<li><a href="#_impact_30">83.4. Impact</a></li>
<li><a href="#_patches_29">83.5. Patches</a></li>
<li><a href="#_workarounds_23">83.6. Workarounds</a></li>
<li><a href="#_credits_6">83.7. Credits</a></li>
</ul>
</li>
<li><a href="#_l_7_tokioioreadhalftunsplit_is_unsound">84. L-7 <code>tokio::io::ReadHalf&lt;T&gt;::unsplit</code> is Unsound</a></li>
<li><a href="#_l_8_race_condition_enabling_link_following_and_time_of_check_time_of_use_toctou_race_condition_in_remove_dir_all">85. L-8 Race Condition Enabling Link Following and Time-of-check Time-of-use (TOCTOU) Race Condition in remove_dir_all</a></li>
<li><a href="#_l_9_undefined_behavior_in_rust_runtime_functions">86. L-9 Undefined Behavior in Rust runtime functions</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_3_910">86.1. CVSS Score: 3.9/10</a></li>
<li><a href="#_impact_31">86.2. Impact</a></li>
<li><a href="#_patches_30">86.3. Patches</a></li>
<li><a href="#_workarounds_24">86.4. Workarounds</a></li>
<li><a href="#_references_14">86.5. References</a></li>
<li><a href="#_for_more_information_12">86.6. For more information</a></li>
</ul>
</li>
<li><a href="#_l_10_atty_potential_unaligned_read">87. L-10 atty potential unaligned read</a>
<ul class="sectlevel2">
<li><a href="#_atty_is_unmaintained">87.1. atty is Unmaintained</a></li>
<li><a href="#_possible_alternatives">87.2. Possible Alternative(s)</a></li>
</ul>
</li>
<li><a href="#_l_11_wasmtime_trap_code_c_api_function_has_out_of_bounds_write_vulnerability">88. L-11 wasmtime_trap_code C API function has out of bounds write vulnerability</a>
<ul class="sectlevel2">
<li><a href="#_cvss_score_3_810">88.1. CVSS Score: 3.8/10</a></li>
<li><a href="#_impact_32">88.2. Impact</a></li>
<li><a href="#_patches_31">88.3. Patches</a></li>
<li><a href="#_workarounds_25">88.4. Workarounds</a></li>
<li><a href="#_references_15">88.5. References</a></li>
<li><a href="#_for_more_information_13">88.6. For more information</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_informational">V: Informational</a>
<ul class="sectlevel1">
<li><a href="#_i_1_malicious_ds_store_file">89. I-1 Malicious <code>.DS_Store</code> file</a>
<ul class="sectlevel2">
<li><a href="#_impact_33">89.1. Impact</a></li>
<li><a href="#_recommendation">89.2. Recommendation</a></li>
</ul>
</li>
<li><a href="#_tools_used">Exhibit A: Tools Used</a>
<ul class="sectlevel2">
<li><a href="#_dependabot">A.1. Dependabot</a></li>
</ul>
</li>
<li><a href="#_challenges">Exhibit B: Challenges</a>
<ul class="sectlevel2">
<li><a href="#_context">B.1. Context</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_terminology">Terminology</a></li>
<li><a href="#_references_16">References</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_summary">Summary</h3>
<div class="paragraph">
<p>This security assessment was conducted on the commit <a href="https://github.com/HalbornSecurity/CTFs/commit/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee">e0e91e5&#8230;&#8203;ca1ee</a> of master <a href="https://github.com/HalbornSecurity/CTFs">CTFs</a> repo starting on March 25th, 2024 and ended on April 2nd, 2024.</p>
</div>
<div class="sect3">
<h4 id="_document_revisions">Document Revisions</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Draft report</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">03.26.2024</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Final report</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">04.02.2024</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixes review</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<h1 id="_critical" class="sect0">I: Critical</h1>
<div class="sect1">
<h2 id="_c_1_btcd_mishandles_witness_size_checking">1. C-1 btcd mishandles witness size checking</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-44797">CVE-2022-44797</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-2chg-86hq-7w38">GHSA-2chg-86hq-7w38</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L60" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L60</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">btcsuite</span><span class="tok-o">/</span><span class="tok-nx">btcd</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.22.0</span><span class="tok-o">-</span><span class="tok-nx">beta</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810">1.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>btcd before 0.23.2, as used in Lightning Labs lnd before 0.15.2-beta and other Bitcoin-related products, mishandles witness size checking.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specific_go_packages_affected">1.2. Specific Go Packages Affected</h3>
<div class="paragraph">
<p>github.com/btcsuite/btcd/wire</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_2_crossbeam_deque_data_race_before_v0_7_4_and_v0_8_1">2. C-2 crossbeam-deque Data Race before v0.7.4 and v0.8.1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32810">CVE-2021-32810</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-pqqp-xmhj-wgcw">GHSA-pqqp-xmhj-wgcw</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1005" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1005</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;crossbeam-deque&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.7.3&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;9f02af974daeee82218205558e51ec8768b48cf524bd01d550abe5573a608285&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_2">2.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact">2.2. Impact</h3>
<div class="paragraph">
<p>In the affected version of this crate, the result of the race condition is that one or more tasks in the worker queue can be popped twice instead of other tasks that are forgotten and never popped. If tasks are allocated on the heap, this can cause double free and a memory leak. If not, this still can cause a logical bug.</p>
</div>
<div class="paragraph">
<p>Crates using <code>Stealer::steal</code>, <code>Stealer::steal_batch</code>, or <code>Stealer::steal_batch_and_pop</code> are affected by this issue.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches">2.3. Patches</h3>
<div class="paragraph">
<p>This has been fixed in crossbeam-deque 0.8.1 and 0.7.4.</p>
</div>
</div>
<div class="sect2">
<h3 id="_credits">2.4. Credits</h3>
<div class="paragraph">
<p>This issue was reported and fixed by Maor Kleinberger.</p>
</div>
</div>
<div class="sect2">
<h3 id="_license">2.5. License</h3>
<div class="paragraph">
<p>This advisory is in the public domain.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_3_crossbeam_deque_data_race_before_v0_7_4_and_v0_8_1">3. C-3 crossbeam-deque Data Race before v0.7.4 and v0.8.1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32810">CVE-2021-32810</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-pqqp-xmhj-wgcw">GHSA-pqqp-xmhj-wgcw</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1005" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1005</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;crossbeam-deque&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.7.3&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;9f02af974daeee82218205558e51ec8768b48cf524bd01d550abe5573a608285&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_3">3.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_2">3.2. Impact</h3>
<div class="paragraph">
<p>In the affected version of this crate, the result of the race condition is that one or more tasks in the worker queue can be popped twice instead of other tasks that are forgotten and never popped. If tasks are allocated on the heap, this can cause double free and a memory leak. If not, this still can cause a logical bug.</p>
</div>
<div class="paragraph">
<p>Crates using <code>Stealer::steal</code>, <code>Stealer::steal_batch</code>, or <code>Stealer::steal_batch_and_pop</code> are affected by this issue.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_2">3.3. Patches</h3>
<div class="paragraph">
<p>This has been fixed in crossbeam-deque 0.8.1 and 0.7.4.</p>
</div>
</div>
<div class="sect2">
<h3 id="_credits_2">3.4. Credits</h3>
<div class="paragraph">
<p>This issue was reported and fixed by Maor Kleinberger.</p>
</div>
</div>
<div class="sect2">
<h3 id="_license_2">3.5. License</h3>
<div class="paragraph">
<p>This advisory is in the public domain.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_4_overflow_in_libsecp256k1">4. C-4 Overflow in libsecp256k1</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/190.html">CWE-190</a>, <a href="https://cwe.mitre.org/data/definitions/347.html">CWE-347</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-38195">CVE-2021-38195</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-g4vj-x7v9-h82m">GHSA-g4vj-x7v9-h82m</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3167" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3167</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;libsecp256k1&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.3.5&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1fc1e2c808481a63dc6da2074752fdd4336a3c8fcc68b83db6f1fd5224ae7962&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_4">4.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the libsecp256k1 crate before 0.5.0 for Rust. It can verify an invalid signature because it allows the R or S parameter to be larger than the curve order, aka an overflow.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_5_out_of_bounds_write_in_nalgebra">5. C-5 Out of bounds write in nalgebra</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/119.html">CWE-119</a>, <a href="https://cwe.mitre.org/data/definitions/787.html">CWE-787</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-38190">CVE-2021-38190</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-3w8g-xr3f-2mp8">GHSA-3w8g-xr3f-2mp8</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3688" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3688</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;nalgebra&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.19.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0abb021006c01b126a936a8dd1351e0720d83995f4fc942d0d426c654f990745&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_5">5.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>Deserialize</code> implementation for <code>VecStorage</code> did not maintain the invariant that the number of elements must equal <code>nrows * ncols</code>. Deserialization of specially crafted inputs could allow memory access beyond allocation of the vector.</p>
</div>
<div class="paragraph">
<p>This flaw was introduced in v0.11.0 (<a href="https://github.com/dimforge/nalgebra/commit/086e6e719f53fecba6dadad2e953a487976387f5"><code>086e6e</code></a>) due to the addition of an automatically derived implementation of <code>Deserialize</code> for <code>MatrixVec</code>. <code>MatrixVec</code> was later renamed to <code>VecStorage</code> in v0.16.13 (<a href="https://github.com/dimforge/nalgebra/commit/0f66403cbbe9eeac15cedd8a906c0d6a3d8841f2"><code>0f66403</code></a>) and continued to use the automatically derived implementation of <code>Deserialize</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_6_rust_failure_crate_vulnerable_to_type_confusion">6. C-6 Rust Failure Crate Vulnerable to Type confusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/843.html">CWE-843</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-25010">CVE-2019-25010</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-r98r-j25q-rmpr">GHSA-r98r-j25q-rmpr</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1409" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1409</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;failure&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.8&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;d32e9bd16cc02eae7db7ef620b392808b89f6a5e16bb3497d159c6b92a0f4f86&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_6">6.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Safe Rust code can implement malfunctioning <code><em>private_get_type_id</em></code> and cause type confusion when downcasting, which is an undefined behavior.</p>
</div>
<div class="paragraph">
<p>Users who derive Fail trait are not affected.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_7_memory_flaw_in_zeroize_derive">7. C-7 Memory flaw in zeroize_derive</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/459.html">CWE-459</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45706">CVE-2021-45706</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-c5hx-w945-j4pq">GHSA-c5hx-w945-j4pq</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8936" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8936</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;zeroize_derive&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1.1.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;a2c1e130bebaeab2f23886bf9acbaca14b092408c452543c857f66399cd6dab1&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_7">7.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the zeroize_derive crate before 1.1.1 for Rust. Dropped memory is not zeroed out for an enum.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_8_type_confusion_if_private_get_type_id_is_overriden">8. C-8 Type confusion if <em>private_get_type_id</em> is overriden</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/843.html">CWE-843</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-25575">CVE-2020-25575</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-jq66-xh47-j9f3">GHSA-jq66-xh47-j9f3</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1409" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1409</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;failure&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.8&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;d32e9bd16cc02eae7db7ef620b392808b89f6a5e16bb3497d159c6b92a0f4f86&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_8">8.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the failure crate through 0.1.5 for Rust. It has a type confusion flaw when downcasting. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_9_deserialization_of_untrusted_data_in_rust_cpuid">9. C-9 Deserialization of Untrusted Data in rust-cpuid</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45687">CVE-2021-45687</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-w428-f65r-h4q2">GHSA-w428-f65r-h4q2</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;raw-cpuid&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;8.1.2&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1fdf7d9dbd43f3d81d94a49c1c3df73cc2b3827995147e6cf7f89d4ec5483e73&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_9_810_9">9.1. CVSS Score: 9.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the raw-cpuid crate before 9.1.1 for Rust. If the serialize feature is used (which is not the the default), a Deserialize operation may lack sufficient validation, leading to memory corruption or a panic.</p>
</div>
</div>
</div>
</div>
<h1 id="_high" class="sect0">II: High</h1>
<div class="sect1">
<h2 id="_h_1_uncontrolled_resource_consumption">10. H-1 Uncontrolled Resource Consumption</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-41723">CVE-2022-41723</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-vvpx-j8f3-3w6h">GHSA-vvpx-j8f3-3w6h</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">net</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20211208012354</span><span class="tok-o">-</span><span class="tok-nx">db4efeb81f4b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510">10.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A maliciously crafted HTTP/2 stream could cause excessive CPU consumption in the HPACK decoder, sufficient to cause a denial of service from a small number of small requests.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_2_golang_orgxcryptossh_denial_of_service_via_crafted_signer">11. H-2 golang.org/x/crypto/ssh Denial of service via crafted Signer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/327.html">CWE-327</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-27191">CVE-2022-27191</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-8c26-wmh5-6g9v">GHSA-8c26-wmh5-6g9v</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L245" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L245</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">crypto</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20220214200702</span><span class="tok-o">-</span><span class="tok-mf">86341886e292</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_2">11.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The golang.org/x/crypto/ssh package before 0.0.0-20220314234659-1baeb1ce4c0b for Go allows an attacker to crash a server in certain circumstances involving AddHostKey.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_3_golang_orgxnethttp2_denial_of_service_vulnerability">12. H-3 golang.org/x/net/http2 Denial of Service vulnerability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-27664">CVE-2022-27664</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-69cg-p879-7622">GHSA-69cg-p879-7622</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">net</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20211208012354</span><span class="tok-o">-</span><span class="tok-nx">db4efeb81f4b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_3">12.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In net/http in Go before 1.18.6 and 1.19.x before 1.19.1, attackers can cause a denial of service because an HTTP/2 connection can hang during closing if shutdown were preempted by a fatal error.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_4_golang_orgxtextlanguage_denial_of_service_via_crafted_accept_language_header">13. H-4 golang.org/x/text/language Denial of service via crafted Accept-Language header</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/772.html">CWE-772</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-32149">CVE-2022-32149</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-69ch-w2m2-3vjp">GHSA-69ch-w2m2-3vjp</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L251" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L251</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">text</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.3.7</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_4">13.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The BCP 47 tag parser has quadratic time complexity due to inherent aspects of its design. Since the parser is, by design, exposed to untrusted user input, this can be leveraged to force a program to consume significant time parsing Accept-Language headers. The parser cannot be easily rewritten to fix this behavior for various reasons. Instead the solution implemented in this CL is to limit the total complexity of tags passed into ParseAcceptLanguage by limiting the number of dashes in the string to 1000. This should be more than enough for the majority of real world use cases, where the number of tags being sent is likely to be in the single digits.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specific_go_packages_affected_2">13.2. Specific Go Packages Affected</h3>
<div class="paragraph">
<p>golang.org/x/text/language</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_5_golang_orgxnethttp2h2c_vulnerable_to_request_smuggling_attack">14. H-5 golang.org/x/net/http2/h2c vulnerable to request smuggling attack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/444.html">CWE-444</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-41721">CVE-2022-41721</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-fxg5-wq6x-vr4w">GHSA-fxg5-wq6x-vr4w</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">net</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20211208012354</span><span class="tok-o">-</span><span class="tok-nx">db4efeb81f4b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_5">14.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A request smuggling attack is possible when using MaxBytesHandler. When using MaxBytesHandler, the body of an HTTP request is not fully consumed. When the server attempts to read HTTP2 frames from the connection, it will instead be reading the body of the HTTP request, which could be attacker-manipulated to represent arbitrary HTTP2 requests.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specific_go_packages_affected_3">14.2. Specific Go Packages Affected</h3>
<div class="paragraph">
<p>golang.org/x/net/http2/h2c</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_6_opencontainers_runc_incorrect_authorization_vulnerability">15. H-6 Opencontainers runc Incorrect Authorization vulnerability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/706.html">CWE-706</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-27561">CVE-2023-27561</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-vpvm-3wq2-2wvm">GHSA-vpvm-3wq2-2wvm</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">opencontainers</span><span class="tok-o">/</span><span class="tok-nx">runc</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.0.3</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_010">15.1. CVSS Score: 7.0/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>runc 1.0.0-rc95 through 1.1.4 has Incorrect Access Control leading to Escalation of Privileges, related to <code>libcontainer/rootfs_linux.go</code>. To exploit this, an attacker must be able to spawn two containers with custom volume-mount configurations, and be able to run custom images. NOTE: this issue exists because of a CVE-2019-19921 regression.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_7_docker_swarm_encrypted_overlay_network_may_be_unauthenticated">16. H-7 Docker Swarm encrypted overlay network may be unauthenticated</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/420.html">CWE-420</a>, <a href="https://cwe.mitre.org/data/definitions/636.html">CWE-636</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28840">CVE-2023-28840</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-232p-vwff-86mp">GHSA-232p-vwff-86mp</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-w"> </span><span class="tok-nx">v20</span><span class="tok-mf">.10.7</span><span class="tok-o">+</span><span class="tok-nx">incompatible</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_6">16.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <strong>Docker</strong>.</p>
</div>
<div class="paragraph">
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
</div>
<div class="paragraph">
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
</div>
<div class="paragraph">
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
</div>
<div class="paragraph">
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet&#8217;s VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L230-L234">Two iptables rules</a> serve to filter incoming VXLAN datagrams with a VNI that corresponds to an encrypted network and discards unencrypted datagrams. The rules are appended to the end of the <code>INPUT</code> filter chain, following any rules that have been previously set by the system administrator. Administrator-set rules take precedence over the rules Moby sets to discard unencrypted VXLAN datagrams, which can potentially admit unencrypted datagrams that should have been discarded.</p>
</div>
<div class="paragraph">
<p>On Red Hat Enterprise Linux and derivatives such as CentOS and Rocky, the <code>xt_u32</code> module has been:
* <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.3_release_notes/rhel-8-3-0-release#technology-preview_networking">moved to the kernel-modules-extra package and no longer installed by default in RHEL 8.3</a>
* <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.6_release_notes/deprecated_functionality#deprecated-functionality_networking">officially deprecated in RHEL 8.6</a>
* <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/considerations_in_adopting_rhel_9/assembly_networking_considerations-in-adopting-rhel-9#ref_firewall-networking_assembly_networking">removed completely in RHEL 9</a></p>
</div>
<div class="paragraph">
<p>These rules are not created when <code>xt_u32</code> is unavailable, even though the container is still attached to the network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_3">16.2. Impact</h3>
<div class="paragraph">
<p>Encrypted overlay networks on affected configurations silently accept cleartext VXLAN datagrams that are tagged with the VNI of an encrypted overlay network. As a result, it is possible to inject arbitrary Ethernet frames into the encrypted overlay network by encapsulating them in VXLAN datagrams.</p>
</div>
<div class="paragraph">
<p>The injection of arbitrary Ethernet frames can enable a Denial of Service attack. A sophisticated attacker may be able to establish a UDP or TCP connection by way of the containers outbound gateway that would otherwise be blocked by a stateful firewall, or carry out other escalations beyond simple injection by smuggling packets into the overlay network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_3">16.3. Patches</h3>
<div class="paragraph">
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime&#8217;s 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds">16.4. Workarounds</h3>
<div class="ulist">
<ul>
<li>
<p>Close the VXLAN port (by default, UDP port 4789) to incoming traffic at the Internet boundary (see <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a>) to prevent all VXLAN packet injection.</p>
</li>
<li>
<p>Ensure that the <code>xt_u32</code> kernel module is available on all nodes of the Swarm cluster.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_background">16.5. Background</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/moby/moby/issues/43382">#43382</a> partially discussed this concern, but did not consider the security implications.</p>
</li>
<li>
<p>Mirantis FIELD-5788 essentially duplicates <a href="https://github.com/moby/moby/issues/43382">#43382</a>, and was created six months earlier; it similarly overlooked the security implications.</p>
</li>
<li>
<p><a href="https://github.com/moby/moby/pull/45118">#45118</a> is the ancestor of the final patches, and was where the security implications were discovered.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related">16.6. Related</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841: Encrypted overlay network traffic may be unencrypted</a></p>
</li>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">CVE-2023-28842: Encrypted overlay network with a single endpoint is unauthenticated</a></p>
</li>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></p>
</li>
<li>
<p><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_8_gopkg_inyaml_v3_denial_of_service">17. H-8 gopkg.in/yaml.v3 Denial of Service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-28948">CVE-2022-28948</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-hp87-p4gw-j4gq">GHSA-hp87-p4gw-j4gq</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L255" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L255</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">gopkg</span><span class="tok-p">.</span><span class="tok-nx">in</span><span class="tok-o">/</span><span class="tok-nx">yaml</span><span class="tok-p">.</span><span class="tok-nx">v3</span><span class="tok-w"> </span><span class="tok-nx">v3</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20210107192922</span><span class="tok-o">-</span><span class="tok-mi">496545</span><span class="tok-nx">a6307b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_7">17.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue in the Unmarshal function in Go-Yaml v3 can cause a program to panic when attempting to deserialize invalid input.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_9_http2_rapid_reset_can_cause_excessive_work_in_nethttp">18. H-9 HTTP/2 rapid reset can cause excessive work in net/http</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, <a href="https://cwe.mitre.org/data/definitions/770.html">CWE-770</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-39325">CVE-2023-39325</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-4374-p667-p6c8">GHSA-4374-p667-p6c8</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">net</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20211208012354</span><span class="tok-o">-</span><span class="tok-nx">db4efeb81f4b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_8">18.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A malicious HTTP/2 client which rapidly creates requests and immediately resets them can cause excessive server resource consumption. While the total number of requests is bounded by the http2.Server.MaxConcurrentStreams setting, resetting an in-progress request allows the attacker to create a new request while the existing one is still executing.</p>
</div>
<div class="paragraph">
<p>With the fix applied, HTTP/2 servers now bound the number of simultaneously executing handler goroutines to the stream concurrency limit (MaxConcurrentStreams). New requests arriving when at the limit (which can only happen after the client has reset an existing, in-flight request) will be queued until a handler exits. If the request queue grows too large, the server will terminate the connection.</p>
</div>
<div class="paragraph">
<p>This issue is also fixed in golang.org/x/net/http2 for users manually configuring HTTP/2.</p>
</div>
<div class="paragraph">
<p>The default stream concurrency limit is 250 streams (requests) per HTTP/2 connection. This value may be adjusted using the golang.org/x/net/http2 package; see the Server.MaxConcurrentStreams setting and the ConfigureServer function.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_10_grpc_go_http2_rapid_reset_vulnerability">19. H-10 gRPC-Go HTTP/2 Rapid Reset vulnerability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-m425-mq94-257g">GHSA-m425-mq94-257g</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L28" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L28</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">google</span><span class="tok-p">.</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">grpc</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.45.0</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_9">19.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_4">19.2. Impact</h3>
<div class="paragraph">
<p>In affected releases of gRPC-Go, it is possible for an attacker to send HTTP/2 requests, cancel them, and send subsequent requests, which is valid by the HTTP/2 protocol, but would cause the gRPC-Go server to launch more concurrent method handlers than the configured maximum stream limit.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_4">19.3. Patches</h3>
<div class="paragraph">
<p>This vulnerability was addressed by #6703 and has been included in patch releases: 1.56.3, 1.57.1, 1.58.3.  It is also included in the latest release, 1.59.0.</p>
</div>
<div class="paragraph">
<p>Along with applying the patch, users should also ensure they are using the <code>grpc.MaxConcurrentStreams</code> server option to apply a limit to the server&#8217;s resources used for any single connection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_2">19.4. Workarounds</h3>
<div class="paragraph">
<p>None.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references">19.5. References</h3>
<div class="paragraph">
<p>#6703</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_11_runc_vulnerable_to_container_breakout_through_process_cwd_trickery_and_leaked_fds">20. H-11 runc vulnerable to container breakout through process.cwd trickery and leaked fds</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/403.html">CWE-403</a>, <a href="https://cwe.mitre.org/data/definitions/668.html">CWE-668</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21626">CVE-2024-21626</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-xr7r-f8xq-vfvv">GHSA-xr7r-f8xq-vfvv</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">opencontainers</span><span class="tok-o">/</span><span class="tok-nx">runc</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.0.3</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_8_610">20.1. CVSS Score: 8.6/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_5">20.2. Impact</h3>
<div class="paragraph">
<p>In runc 1.1.11 and earlier, due to an internal file descriptor leak, an attacker could cause a newly-spawned container process (from <code>runc exec</code>) to have a working directory in the host filesystem namespace, allowing for a container escape by giving access to the host filesystem ("attack 2"). The same attack could be used by a malicious image to allow a container process to gain access to the host filesystem through <code>runc run</code> ("attack 1"). Variants of attacks 1 and 2 could be also be used to overwrite semi-arbitrary host binaries, allowing for complete container escapes ("attack 3a" and "attack 3b").</p>
</div>
<div class="paragraph">
<p>Strictly speaking, while attack 3a is the most severe from a CVSS perspective, attacks 2 and 3b are arguably more dangerous in practice because they allow for a breakout from inside a container as opposed to requiring a user execute a malicious image. The reason attacks 1 and 3a are scored higher is because being able to socially engineer users is treated as a given for UI:R vectors, despite attacks 2 and 3b requiring far more minimal user interaction (just reasonable <code>runc exec</code> operations on a container the attacker has access to). In any case, all four attacks can lead to full control of the host system.</p>
</div>
</div>
<div class="sect2">
<h3 id="_attack_1_process_cwd_mis_configuration">20.3. Attack 1: <code>process.cwd</code> "mis-configuration"</h3>
<div class="paragraph">
<p>In runc 1.1.11 and earlier, several file descriptors were inadvertently leaked internally within runc into <code>runc init</code>, including a handle to the host&#8217;s <code>/sys/fs/cgroup</code> (this leak was added in v1.0.0-rc93). If the container was configured to have <code>process.cwd</code> set to <code>/proc/self/fd/7/</code> (the actual fd can change depending on file opening order in <code>runc</code>), the resulting pid1 process will have a working directory in the host mount namespace and thus the spawned process can access the entire host filesystem. This alone is not an exploit against runc, however a malicious image could make any innocuous-looking non-<code>/</code> path a symlink to <code>/proc/self/fd/7/</code> and thus trick a user into starting a container whose binary has access to the host filesystem.</p>
</div>
<div class="paragraph">
<p>Furthermore, prior to runc 1.1.12, runc also did not verify that the final working directory was inside the container&#8217;s mount namespace after calling <code>chdir(2)</code> (as we have already joined the container namespace, it was incorrectly assumed there would be no way to chdir outside the container after <code>pivot_root(2)</code>).</p>
</div>
<div class="paragraph">
<p>The CVSS score for this attack is CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N (8.2, high severity).</p>
</div>
<div class="paragraph">
<p>Note that this attack requires a privileged user to be tricked into running a malicious container image. It should be noted that when using higher-level runtimes (such as Docker or Kubernetes), this exploit can be considered critical as it can be done remotely by anyone with the rights to start a container image (and can be exploited from within Dockerfiles using <code>ONBUILD</code> in the case of Docker).</p>
</div>
</div>
<div class="sect2">
<h3 id="_attack_2_runc_exec_container_breakout">20.4. Attack 2: <code>runc exec</code> container breakout</h3>
<div class="paragraph">
<p>(This is a modification of attack 1, constructed to allow for a process inside a container to break out.)</p>
</div>
<div class="paragraph">
<p>The same fd leak and lack of verification of the working directory in attack 1 also apply to <code>runc exec</code>. If a malicious process inside the container knows that some administrative process will call <code>runc exec</code> with the <code>--cwd</code> argument and a given path, in most cases they can replace that path with a symlink to <code>/proc/self/fd/7/</code>. Once the container process has executed the container binary, <code>PR_SET_DUMPABLE</code> protections no longer apply and the attacker can open <code>/proc/$exec_pid/cwd</code> to get access to the host filesystem.</p>
</div>
<div class="paragraph">
<p><code>runc exec</code> defaults to a cwd of <code>/</code> (which cannot be replaced with a symlink), so this attack depends on the attacker getting a user (or some administrative process) to use <code>--cwd</code> and figuring out what path the target working directory is. Note that if the target working directory is a parent of the program binary being executed, the attacker might be unable to replace the path with a symlink (the <code>execve</code> will fail in most cases, unless the host filesystem layout specifically matches the container layout in specific ways and the attacker knows which binary the <code>runc exec</code> is executing).</p>
</div>
<div class="paragraph">
<p>The CVSS score for this attack is CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N (7.2, high severity).</p>
</div>
</div>
<div class="sect2">
<h3 id="_attacks_3a_and_3b_process_args_host_binary_overwrite_attack">20.5. Attacks 3a and 3b: <code>process.args</code> host binary overwrite attack</h3>
<div class="paragraph">
<p>(These are modifications of attacks 1 and 2, constructed to overwrite a host binary by using <code>execve</code> to bring a magic-link reference into the container.)</p>
</div>
<div class="paragraph">
<p>Attacks 1 and 2 can be adapted to overwrite a host binary by using a path like <code>/proc/self/fd/7/../../../bin/bash</code> as the <code>process.args</code> binary argument, causing a host binary to be executed by a container process. The <code>/proc/$pid/exe</code> handle can then be used to overwrite the host binary, as seen in CVE-2019-5736 (note that the same <code>#!</code> trick can be used to avoid detection as an attacker). As the overwritten binary could be something like <code>/bin/bash</code>, as soon as a privileged user executes the target binary on the host, the attacker can pivot to gain full access to the host.</p>
</div>
<div class="paragraph">
<p>For the purposes of CVSS scoring:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Attack 3a is attack 1 but adapted to overwrite a host binary, where a malicious image is set up to execute <code>/proc/self/fd/7/../../../bin/bash</code> and run a shell script that overwrites <code>/proc/self/exe</code>, overwriting the host copy of <code>/bin/bash</code>. The CVSS score for this attack is CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H (8.6, high severity).</p>
</li>
<li>
<p>Attack 3b is attack 2 but adapted to overwrite a host binary, where the malicious container process overwrites all of the possible <code>runc exec</code> target binaries inside the container (such as <code>/bin/bash</code>) such that a host target binary is executed and then the container process opens <code>/proc/$pid/exe</code> to get access to the host binary and overwrite it. The CVSS score for this attack is CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H (8.2, high severity).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As mentioned in attack 1, while 3b is scored lower it is more dangerous in practice as it doesn&#8217;t require a user to run a malicious image.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_5">20.6. Patches</h3>
<div class="paragraph">
<p>runc 1.1.12 has been released, and includes patches for this issue. Note that there are four separate fixes applied:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checking that the working directory is actually inside the container by checking whether <code>os.Getwd</code> returns <code>ENOENT</code> (Linux provides a way of detecting if cwd is outside the current namespace root). This explicitly blocks runc from executing a container process when inside a non-container path and thus eliminates attacks 1 and 2 even in the case of fd leaks.</p>
</li>
<li>
<p>Close all internal runc file descriptors in the final stage of <code>runc init</code>, right before <code>execve</code>. This ensures that internal file descriptors cannot be used as an argument to <code>execve</code> and thus eliminates attacks 3a and 3b, even in the case of fd leaks. This requires hooking into some Go runtime internals to make sure we don&#8217;t close critical Go internal file descriptors.</p>
</li>
<li>
<p>Fixing the specific fd leaks that made these bug exploitable (mark <code>/sys/fs/cgroup</code> as <code>O_CLOEXEC</code> and backport a fix for some <code>*os.File</code> leaks).</p>
</li>
<li>
<p>In order to protect against future <code>runc init</code> file descriptor leaks, mark all non-stdio files as <code>O_CLOEXEC</code> before executing <code>runc init</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_other_runtimes">20.7. Other Runtimes</h3>
<div class="paragraph">
<p>We have discovered that several other container runtimes are either potentially vulnerable to similar attacks, or do not have sufficient protection against attacks of this nature. We recommend other container runtime authors look at #Patches[our patches] and make sure they at least add a <code>getcwd() != ENOENT</code> check as well as consider whether <code>close_range(3, UINT_MAX, CLOSE_RANGE_CLOEXEC)</code> before executing their equivalent of <code>runc init</code> is appropriate.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>crun 1.12 does not leak any useful file descriptors into the <code>runc init</code>-equivalent process (so this attack is <em>not exploitable</em> as far as we can tell), but no care is taken to make sure all non-stdio files are <code>O_CLOEXEC</code> and there is no check after <code>chdir(2)</code> to ensure the working directory is inside the container. If a file descriptor happened to be leaked in the future, this could be exploitable. In addition, any file descriptors passed to <code>crun</code> are not closed until the container process is executed, meaning that easily-overlooked programming errors by users of <code>crun</code> can lead to these attacks becoming exploitable.</p>
</li>
<li>
<p>youki 0.3.1 does not leak any useful file descriptors into the <code>runc init</code>-equivalent process (so this attack is <em>not exploitable</em> as far as we can tell) however this appears to be pure luck. <code>youki</code> does leak a directory file descriptor from the host mount namespace, but it just so happens that the directory is the rootfs of the container (which then gets <code>pivot_root&#8217;d into and so ends up as a in-root path thanks to `chroot_fs_refs</code>). In addition, no care is taken to make sure all non-stdio files are <code>O_CLOEXEC</code> and there is no check after <code>chdir(2)</code> to ensure the working directory is inside the container. If a file descriptor happened to be leaked in the future, this could be exploitable. In addition, any file descriptors passed to <code>youki</code> are not closed until the container process is executed, meaning that easily-overlooked programming errors by users of <code>youki</code> can lead to these attacks becoming exploitable.</p>
</li>
<li>
<p>LXC 5.0.3 does not appear to leak any useful file descriptors, and they have comments noting the importance of not leaking file descriptors in <code>lxc-attach</code>. However, they don&#8217;t seem to have any proactive protection against file descriptor leaks at the point of <code>chdir</code> such as using <code>close_range(&#8230;&#8203;)</code> (they do have RAII-like <code>__do_fclose</code> closers but those don&#8217;t necessarily stop all leaks in this context) nor do they have any check after <code>chdir(2)</code> to ensure the working directory is inside the container. Unfortunately it seems they cannot use <code>CLOSE_RANGE_CLOEXEC</code> because they don&#8217;t need to re-exec themselves.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_3">20.8. Workarounds</h3>
<div class="paragraph">
<p>For attacks 1 and 2, only permit containers (and <code>runc exec</code>) to use a <code>process.cwd</code> of <code>/</code>. It is not possible for <code>/</code> to be replaced with a symlink (the path is resolved from within the container&#8217;s mount namespace, and you cannot change the root of a mount namespace or an fs root to a symlink).</p>
</div>
<div class="paragraph">
<p>For attacks 1 and 3a, only permit users to run trusted images.</p>
</div>
<div class="paragraph">
<p>For attack 3b, there is no practical workaround other than never using <code>runc exec</code> because any binary you try to execute with <code>runc exec</code> could end up being a malicious binary target.</p>
</div>
</div>
<div class="sect2">
<h3 id="_see_also">20.9. See Also</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.cve.org/CVERecord?id=CVE-2024-21626" class="bare">https://www.cve.org/CVERecord?id=CVE-2024-21626</a></p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/releases/tag/v1.1.12" class="bare">https://github.com/opencontainers/runc/releases/tag/v1.1.12</a></p>
</li>
<li>
<p>The runc 1.1.12 merge commit <a href="https://github.com/opencontainers/runc/commit/a9833ff391a71b30069a6c3f816db113379a4346" class="bare">https://github.com/opencontainers/runc/commit/a9833ff391a71b30069a6c3f816db113379a4346</a>, which contains the following security patches:</p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/commit/506552a88bd3455e80a9b3829568e94ec0160309" class="bare">https://github.com/opencontainers/runc/commit/506552a88bd3455e80a9b3829568e94ec0160309</a></p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/commit/0994249a5ec4e363bfcf9af58a87a722e9a3a31b" class="bare">https://github.com/opencontainers/runc/commit/0994249a5ec4e363bfcf9af58a87a722e9a3a31b</a></p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/commit/fbe3eed1e568a376f371d2ced1b4ac16b7d7adde" class="bare">https://github.com/opencontainers/runc/commit/fbe3eed1e568a376f371d2ced1b4ac16b7d7adde</a></p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/commit/284ba3057e428f8d6c7afcc3b0ac752e525957df" class="bare">https://github.com/opencontainers/runc/commit/284ba3057e428f8d6c7afcc3b0ac752e525957df</a></p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/commit/b6633f48a8c970433737b9be5bfe4f25d58a5aa7" class="bare">https://github.com/opencontainers/runc/commit/b6633f48a8c970433737b9be5bfe4f25d58a5aa7</a></p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/commit/683ad2ff3b01fb142ece7a8b3829de17150cf688" class="bare">https://github.com/opencontainers/runc/commit/683ad2ff3b01fb142ece7a8b3829de17150cf688</a></p>
</li>
<li>
<p><a href="https://github.com/opencontainers/runc/commit/e9665f4d606b64bf9c4652ab2510da368bfbd951" class="bare">https://github.com/opencontainers/runc/commit/e9665f4d606b64bf9c4652ab2510da368bfbd951</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_credits_3">20.10. Credits</h3>
<div class="paragraph">
<p>Thanks to Rory McNamara from Snyk for discovering and disclosing the original vulnerability (attack 1) to Docker, @lifubang from acmcoder for discovering how to adapt the attack to overwrite host binaries (attack 3a), and Aleksa Sarai from SUSE for discovering how to adapt the attacks to work as container breakouts using <code>runc exec</code> (attacks 2 and 3b).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_12_memory_access_due_to_code_generation_flaw_in_cranelift_module">21. H-12 Memory access due to code generation flaw in Cranelift module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/125.html">CWE-125</a>, <a href="https://cwe.mitre.org/data/definitions/788.html">CWE-788</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32629">CVE-2021-32629</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-hpqh-2wqx-7qp5">GHSA-hpqh-2wqx-7qp5</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L901" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L901</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;cranelift-codegen&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.69.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1a54e4beb833a3c873a18a8fe735d73d732044004c7539a072c8faa35ccb0c60&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_210">21.1. CVSS Score: 7.2/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There is a bug in 0.73.0 of the Cranelift x64 backend that can create a scenario that could result in a potential sandbox escape in a WebAssembly module.  Users of versions 0.73.0 of Cranelift should upgrade to either 0.73.1 or 0.74 to remediate this vulnerability.  Users of Cranelift prior to 0.73.0 should update to 0.73.1 or 0.74 if they were not using the old default backend.</p>
</div>
</div>
<div class="sect2">
<h3 id="_description">21.2. Description</h3>
<div class="paragraph">
<p>This bug was introduced in the new backend on 2020-09-08 and first included in a release on 2020-09-30, but the new backend was not the default prior to 0.73.0. The recently-released version 0.73.0 with default settings, and prior versions with an explicit build flag to select the new backend, are vulnerable.  The bug in question performs a sign-extend instead of a zero-extend on a value loaded from the stack, under a specific set of circumstances.  If those circumstances occur, the bug could allow access to memory addresses up to 2GiB before the start of the heap allocated for the WebAssembly module.</p>
</div>
<div class="paragraph">
<p>If the heap bound is larger than 2GiB, then it would be possible to read memory from a computable range dependent on the size of the heap&#8217;s bound.</p>
</div>
<div class="paragraph">
<p>The impact of this bug is highly dependent on heap implementation; specifically:
* if the heap has bounds checks, and
* does not rely exclusively on guard pages, and
* the heap bound is 2GiB or smaller</p>
</div>
<div class="paragraph">
<p>then this bug cannot be used to reach memory from another WebAssembly module heap.</p>
</div>
<div class="paragraph">
<p>The impact of the vulnerability is mitigated if there is no memory mapped in the range accessible using this bug, for example, if there is a 2 GiB guard region before the WebAssembly module heap.</p>
</div>
<div class="paragraph">
<p>The bug in question performs a sign-extend instead of a zero-extend on a value loaded from the stack when the register allocator reloads a spilled integer value narrower than 64 bits. This interacts poorly with another optimization: the instruction selector elides a 32-to-64-bit zero-extend operator when we know that an instruction producing a 32-bit value actually zeros the upper 32 bits of its destination register. Hence, we rely on these zeroed bits, but the type of the value is still i32, and the spill/reload reconstitutes those bits as the sign extension of the i32s MSB.</p>
</div>
<div class="paragraph">
<p>The issue would thus occur when:
* An i32 value is greater than or equal to 0x8000_0000;
* The value is spilled and reloaded by the register allocator due to high register pressure in the program between the values definition and its use;
* The value is produced by an instruction that we know to be "special" in that it zeroes the upper 32 bits of its destination: add, sub, mul, and, or;
* The value is then zero-extended to 64 bits;
* The resulting 64-bit value is used.</p>
</div>
<div class="paragraph">
<p>Under these circumstances there is a potential sandbox escape when the i32 value is a pointer. The usual code emitted for heap accesses zero-extends the WebAssembly heap address, adds it to a 64-bit heap base, and accesses the resulting address. If the zero-extend becomes a sign-extend, the module could reach backward and access memory up to 2GiB before the start of its heap.</p>
</div>
<div class="paragraph">
<p>This bug was identified by developers at Fastly following a report from Javier Cabrera Arteaga, KTH Royal Institute of Technology, with support from project Trustful of Stiftelsen fr Strategisk Forskning.  In addition to supporting the analysis and remediation of this vulnerability, Fastly will publish a related Fastly Security Advisory at <a href="https://www.fastly.com/security-advisories">https://www.fastly.com/security-advisories</a>.</p>
</div>
<div class="paragraph">
<p>In addition to assessing the nature of the code generation bug in Cranelift, we have also determined that under specific circumstances, both Lucet and Wasmtime using this version of Cranelift may be exploitable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_impact_to_lucet">21.3. General Impact to Lucet</h3>
<div class="paragraph">
<p>Lucet inherits the heap address computation and bounds-checks of Cranelift, which it uses as its backend code generator. Of particular importance specifically is the address-space layout used by Lucet. In the default configuration for Lucet, only a single module is running, and therefore it is not possible to access memory from another module.</p>
</div>
<div class="paragraph">
<p>By default, the open source implementation of Lucet uses a maximum heap size of 4 GiB, and an instance slot size of 8 GiB, when invoking an instance from the lucet-wasi command-line tool. These settings are within the range of vulnerability described above, but only a single instance is running, so there is no other instance to read. When embedding the runtime (for example, in a long-running daemon), the default for the heap size as described in the source is 1MB; with this setting, the runtime is not vulnerable.</p>
</div>
<div class="paragraph">
<p>Lucet allocates its WebAssembly module instances into "instance slots", which are contiguous zones of virtual address space that contain the VM context at the bottom, the WebAssembly heap in the next page after that, a guard region in the middle, and other data at the top: the stack and the globals.</p>
</div>
<div class="paragraph">
<p>If the instance slot size is less than (max heap) + 2GiB, then the lowest accessible address using the bug will overlap with the prior instances heap. If the size of VM context + stack + globals is greater than (4GiB - heap limit), then the highest accessible address using the bug will overlap with this critical data. If neither of these conditions are true, the bug should only result in an access to the prior instances guard region.</p>
</div>
<div class="paragraph">
<p>Generally, if the limit is between 2GiB and 4GiB - ~1MB (depending on stack/global size) and the instance slot size is less than 6GiB, the configuration is vulnerable. If the limit is greater than 4GiB - ~1MB, the configuration is vulnerable regardless of instance slot size. Otherwise, the configuration is not vulnerable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_impact_on_wasmtime">21.4. General Impact on Wasmtime</h3>
<div class="paragraph">
<p>In Wasmtime, the same Cranelift heap address computations and heap types are used as above. The memory layout, however, is slightly different, with different outcomes:
* With the mmap implementation impact is mitigated probabilistically if ASLR is enabled.
* With the pooling allocator, the vulnerability only exists if a memory reservation size lower than the default of 6GB is used.</p>
</div>
<div class="paragraph">
<p>With the default mmap-based instance memory implementation, Wasmtime uses mmap() to allocate a block of memory large enough for the heap and guard region, as specified in its configuration. If the underlying OS implements ASLR (modern Linux, macOS and Windows do) then this address will be randomized, and the region below it will (probabilistically) be free. Hence, the bug is mitigated probabilistically in the default configuration if ASLR is enabled.</p>
</div>
<div class="paragraph">
<p>If using the pooling allocator, the vulnerability exists if instance memory size (<code>memory_reservation_size</code> in InstanceLimit) is strictly less than 6GiB (4 GiB + 2 GiB of guard pages). The default is 6GiB, so the vulnerability is masked in the default pooling allocator configuration.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_13_overflow_in_prost_types">22. H-13 Overflow in prost-types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/120.html">CWE-120</a>, <a href="https://cwe.mitre.org/data/definitions/190.html">CWE-190</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-38192">CVE-2021-38192</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-x4qm-mcjq-v2gf">GHSA-x4qm-mcjq-v2gf</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L4937" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L4937</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;prost-types&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.7.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;b518d7cdd93dab1d1122cf07fa9a60771836c668dde9d9e2a139f957f0d9f1bb&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_10">22.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Affected versions of this crate contained a bug in which untrusted input could cause an overflow and panic when converting a Timestamp to SystemTime. It is recommended to upgrade to prost-types v0.8 and switch the usage of From&lt;Timestamp&gt; for SystemTime to TryFrom&lt;Timestamp&gt; for SystemTime.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_14_soundness_issue_in_raw_cpuid">23. H-14 Soundness issue in raw-cpuid</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/198.html">CWE-198</a>, <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-26306">CVE-2021-26306</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-hvqc-pc78-x9wh">GHSA-hvqc-pc78-x9wh</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;raw-cpuid&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;8.1.2&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1fdf7d9dbd43f3d81d94a49c1c3df73cc2b3827995147e6cf7f89d4ec5483e73&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_11">23.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>VendorInfo::as_string(), SoCVendorBrand::as_string(), and ExtendedFunctionInfo::processor_brand_string() construct byte slices using std::slice::from_raw_parts(), with data coming from #[repr(Rust)] structs. This is always undefined behavior.
This flaw has been fixed in v9.0.0, by making the relevant structs #[repr&#169;].</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_15_use_after_free_in_lru">24. H-15 Use After Free in lru</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/416.html">CWE-416</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45720">CVE-2021-45720</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-v362-2895-h9r2">GHSA-v362-2895-h9r2</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;lru&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.6.5&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1f374d42cdfc1d7dbf3d3dec28afab2eb97ffbf43a3234d795b5986dbf4b90ba&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_12">24.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Lru crate has two functions for getting an iterator. Both iterators give references to key and value. Calling specific functions, like pop(), will remove and free the value, and but it&#8217;s still possible to access the reference of value which is already dropped causing use after free.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_16_crossbeam_utils_race_condition_vulnerability">25. H-16 crossbeam-utils Race Condition vulnerability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-23639">CVE-2022-23639</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-qc84-gqf4-9926">GHSA-qc84-gqf4-9926</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1066" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1066</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;crossbeam-utils&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.7.2&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c3c7c73a2d1e9fc0886a08b93e98eb643461230d5f1925e4036204d5f2e261a8&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_8_110">25.1. CVSS Score: 8.1/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_6">25.2. Impact</h3>
<div class="paragraph">
<p>The affected version of this crate incorrectly assumed that the alignment of <code>{i,u}64</code> was always the same as <code>Atomic{I,U}64</code>.</p>
</div>
<div class="paragraph">
<p>However, the alignment of <code>{i,u}64</code> on a 32-bit target can be smaller than <code>Atomic{I,U}64</code>.</p>
</div>
<div class="paragraph">
<p>This can cause the following problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unaligned memory accesses</p>
</li>
<li>
<p>Data race</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Crates using <code>fetch_*</code> methods with <code>AtomicCell&lt;{i,u}64&gt;</code> are affected by this issue.</p>
</div>
<div class="paragraph">
<p>32-bit targets without <code>Atomic{I,U}64</code> and 64-bit targets are not affected by this issue.
32-bit targets with <code>Atomic{I,U}64</code> and <code>{i,u}64</code> have the same alignment are also not affected by this issue.</p>
</div>
<div class="paragraph">
<p>The following is a complete list of the builtin targets that may be affected. (last update: nightly-2022-02-11)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>armv7-apple-ios (tier 3)</p>
</li>
<li>
<p>armv7s-apple-ios (tier 3)</p>
</li>
<li>
<p>i386-apple-ios (tier 3)</p>
</li>
<li>
<p>i586-unknown-linux-gnu</p>
</li>
<li>
<p>i586-unknown-linux-musl</p>
</li>
<li>
<p>i686-apple-darwin (tier 3)</p>
</li>
<li>
<p>i686-linux-android</p>
</li>
<li>
<p>i686-unknown-freebsd</p>
</li>
<li>
<p>i686-unknown-haiku (tier 3)</p>
</li>
<li>
<p>i686-unknown-linux-gnu</p>
</li>
<li>
<p>i686-unknown-linux-musl</p>
</li>
<li>
<p>i686-unknown-netbsd (tier 3)</p>
</li>
<li>
<p>i686-unknown-openbsd (tier 3)</p>
</li>
<li>
<p>i686-wrs-vxworks (tier 3)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>(<a href="https://gist.github.com/taiki-e/3c7891e8c5f5e0cbcb44d7396aabfe10">script to get list</a>)</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_6">25.3. Patches</h3>
<div class="paragraph">
<p>This has been fixed in crossbeam-utils 0.8.7.</p>
</div>
<div class="paragraph">
<p>Affected 0.8.x releases have been yanked.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_2">25.4. References</h3>
<div class="paragraph">
<p><a href="https://github.com/crossbeam-rs/crossbeam/pull/781" class="bare">https://github.com/crossbeam-rs/crossbeam/pull/781</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_license_3">25.5. License</h3>
<div class="paragraph">
<p>This advisory is in the public domain.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_17_rusts_regex_crate_vulnerable_to_regular_expression_denial_of_service">26. H-17 Rust&#8217;s regex crate vulnerable to regular expression denial of service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, <a href="https://cwe.mitre.org/data/definitions/1333.html">CWE-1333</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-24713">CVE-2022-24713</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-m5pq-gvj9-9vr8">GHSA-m5pq-gvj9-9vr8</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5261" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5261</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;regex&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1.5.4&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;d07a8629359eb56f1e2fb1652bb04212c072a87ba68546a04065d525673ac461&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_13">26.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>This is a cross-post of [the official security advisory][advisory]. The official advisory contains a signed version with our PGP key, as well.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>[advisory]: <a href="https://groups.google.com/g/rustlang-security-announcements/c/NcNNL1Jq7Yw" class="bare">https://groups.google.com/g/rustlang-security-announcements/c/NcNNL1Jq7Yw</a></p>
</div>
<div class="paragraph">
<p>The Rust Security Response WG was notified that the <code>regex</code> crate did not properly limit the complexity of the regular expressions (regex) it parses. An attacker could use this security issue to perform a denial of service, by sending a specially crafted regex to a service accepting untrusted regexes. No known vulnerability is present when parsing untrusted input with trusted regexes.</p>
</div>
<div class="paragraph">
<p>This issue has been assigned CVE-2022-24713. The severity of this vulnerability is "high" when the <code>regex</code> crate is used to parse untrusted regexes. Other uses of the <code>regex</code> crate are not affected by this vulnerability.</p>
</div>
</div>
<div class="sect2">
<h3 id="_overview">26.2. Overview</h3>
<div class="paragraph">
<p>The <code>regex</code> crate features built-in mitigations to prevent denial of service attacks caused by untrusted regexes, or untrusted input matched by trusted regexes. Those (tunable) mitigations already provide sane defaults to prevent attacks. This guarantee is documented and it&#8217;s considered part of the crate&#8217;s API.</p>
</div>
<div class="paragraph">
<p>Unfortunately a bug was discovered in the mitigations designed to prevent untrusted regexes to take an arbitrary amount of time during parsing, and it&#8217;s possible to craft regexes that bypass such mitigations. This makes it possible to perform denial of service attacks by sending specially crafted regexes to services accepting user-controlled, untrusted regexes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_affected_versions">26.3. Affected versions</h3>
<div class="paragraph">
<p>All versions of the <code>regex</code> crate before or equal to 1.5.4 are affected by this issue. The fix is include starting from  <code>regex</code> 1.5.5.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mitigations">26.4. Mitigations</h3>
<div class="paragraph">
<p>We recommend everyone accepting user-controlled regexes to upgrade immediately to the latest version of the <code>regex</code> crate.</p>
</div>
<div class="paragraph">
<p>Unfortunately there is no fixed set of problematic regexes, as there are practically infinite regexes that could be crafted to exploit this vulnerability. Because of this, we do not recommend denying known problematic regexes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_acknowledgements">26.5. Acknowledgements</h3>
<div class="paragraph">
<p>We want to thank Addison Crump for responsibly disclosing this to us according to the <a href="https://www.rust-lang.org/policies/security">Rust security policy</a>, and for helping review the fix.</p>
</div>
<div class="paragraph">
<p>We also want to thank Andrew Gallant for developing the fix, and Pietro Albini for coordinating the disclosure and writing this advisory.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_18_use_after_free_in_wasmtime">27. H-18 Use after free in Wasmtime</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/416.html">CWE-416</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-24791">CVE-2022-24791</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-gwc9-348x-qwv2">GHSA-gwc9-348x-qwv2</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_8_110_2">27.1. CVSS Score: 8.1/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There is a use after free vulnerability in Wasmtime when both running Wasm that uses `externref`s and enabling <a href="https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.epoch_interruption">epoch interruption</a> in Wasmtime. If you are not explicitly enabling epoch interruption (it is disabled by default) then you are not affected. If you are explicitly disabling the Wasm reference types proposal (it is enabled by default) then you are also not affected.</p>
</div>
<div class="paragraph">
<p>The use after free is caused by Cranelift failing to emit stack maps when there are safepoints inside cold blocks. Cold blocks occur when epoch interruption is enabled. Cold blocks are emitted at the end of compiled functions, and change the order blocks are emitted versus defined. This reordering accidentally caused Cranelift to skip emitting some stack maps because it expected to emit the stack maps in block definition order, rather than block emission order. When Wasmtime would eventually collect garbage, it would fail to find live references on the stack because of the missing stack maps, think that they were unreferenced garbage, and therefore reclaim them. Then after the collection ended, the Wasm code could use the reclaimed-too-early references, which is a use after free.</p>
</div>
<div class="paragraph">
<p>This bug was discovered while extending our fuzz targets for `externref`s and GC in Wasmtime. The updated fuzz target thoroughly exercises these code paths and feature combinations now. We have also added a regression test for this bug. Released versions 0.34.2 and 0.35.2, which fix the vulnerability. We recommend all Wasmtime users upgrade to these patched versions. If upgrading is not an option for you at this time, you can avoid the vulnerability by either disabling the Wasm reference types proposal or by disabling epoch interruption if you were previously enabling it.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_19_parser_creates_invalid_uninitialized_value">28. H-19 Parser creates invalid uninitialized value</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-f67m-9j94-qv9j">GHSA-f67m-9j94-qv9j</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2259" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2259</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;hyper&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.12.36&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;5c843caf6296fc1f93444735205af9ed4e109a539005abb2564ae1d6fad34c52&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Affected versions of this crate called <code>mem::uninitialized()</code> in the HTTP1 parser to create values of type <code>httparse::Header</code> (from the <code>httparse</code> crate).
This is unsound, since <code>Header</code> contains references and thus must be non-null.</p>
</div>
<div class="paragraph">
<p>The flaw was corrected by avoiding the use of <code>mem::uninitialized()</code>, using <code>MaybeUninit</code> instead.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_20_use_after_free_in_lru_crate">29. H-20 Use after free in lru crate</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-qqmc-hwqp-8g2w">GHSA-qqmc-hwqp-8g2w</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;lru&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.6.5&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1f374d42cdfc1d7dbf3d3dec28afab2eb97ffbf43a3234d795b5986dbf4b90ba&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lru crate has use after free vulnerability.</p>
</div>
<div class="paragraph">
<p>Lru crate has two functions for getting an iterator. Both iterators give
references to key and value. Calling specific functions, like pop(), will remove
and free the value, and but it&#8217;s still possible to access the reference of value
which is already dropped causing use after free.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_21_data_race_in_iter_and_itermut">30. H-21 Data race in <code>Iter</code> and <code>IterMut</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-9hpw-r23r-xgm5">GHSA-9hpw-r23r-xgm5</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7766" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7766</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;thread_local&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1.1.3&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;8018d24e04c95ac8790716a5987d0fec4f8b27249ffa0f7d33f1369bdfb88cbd&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the affected version of this crate, <code>{Iter, IterMut}::next</code> used a weaker memory ordering when loading values than what was required, exposing a potential data race
when iterating over a `ThreadLocal&#8217;s values.</p>
</div>
<div class="paragraph">
<p>Crates using <code>Iter::next</code>, or <code>IterMut::next</code> are affected by this issue.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_22_wasmtime_may_have_data_leakage_between_instances_in_the_pooling_allocator">31. H-22 Wasmtime may have data leakage between instances in the pooling allocator</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/212.html">CWE-212</a>, <a href="https://cwe.mitre.org/data/definitions/226.html">CWE-226</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-39393">CVE-2022-39393</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-wh6w-3828-g9qf">GHSA-wh6w-3828-g9qf</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_8_610_2">31.1. CVSS Score: 8.6/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_7">31.2. Impact</h3>
<div class="paragraph">
<p>There is a bug in Wasmtime&#8217;s implementation of it&#8217;s pooling instance allocator where when a linear memory is reused for another instance the initial heap snapshot of the prior instance can be visible, erroneously to the next instance. The pooling instance allocator in Wasmtime works by preallocating virtual memory for a fixed number of instances to reside in and then new instantiations pick a slot to use. Most conventional modules additionally have an initial copy-on-write "heap image" which is mapped in Wasmtime into the linear memory slot. When a heap slot is deallocated Wasmtime resets all of its contents back to the initial state but it does not unmap the image in case the next instance is an instantiation of the same module.</p>
</div>
<div class="paragraph">
<p>The bug in Wasmtime occurs when a slot in the pooling allocator previously was used for a module with a heap image, meaning that its current state of memory contains the initial heap contents of that module. If the next instantiation within that slot does not itself contain a heap image then Wasmtime would leave the old heap image in place erroneously and continue with instantiation. This means that instantiations of modules without a heap image can see the initial heap image of the prior instantiation within that slot.</p>
</div>
<div class="paragraph">
<p>Heap images in Wasmtime are created by precomputing WebAssembly <code>data</code> segments into one large mapping to be placed into linear memory at a particular offset. Most modules produced by toolchains today will have a heap image and an initialization snapshot. Creating a module without a heap image would require a hand-crafted <code>*.wat</code> file or a specially crafted source program. This consequence means that this bug is highly unlikely to be accidentally triggered and would otherwise require an intentional trigger with a hand-crafted module.</p>
</div>
<div class="paragraph">
<p>One important part of this vulnerability is Wasmtime is highly likely to segfault when the slot is reused again with a module that itself has an initialization image. For example if module A has a heap initialization image and module B does not have a heap initialization image, then the following sequence of events could happen if they all are instantiated into the same instance slot:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Module A is instantiated, and then deallocated. This leaves A&#8217;s heap image in place, reset to its initial contents.</p>
</li>
<li>
<p>Module B is instantiated and erroneously can see the initial heap contents of A. Module B is then deallocated and the entire heap is unmapped and reset back to zero.</p>
</li>
<li>
<p>Module A is instantiated again, but the state tracking the slot did not account for module B so it thinks the module image is still mapped and proceeds with instantiation. Any action on A&#8217;s part to access linear memory will then trap and if the host accesses A&#8217;s memory it will segfault because the data that&#8217;s supposed to be mapped is all unmapped.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Adding this all together this means that in practice modules must be deliberately crafted to not have an initial heap image to view the contents of a prior image. If this module is instantiated though then when the slot is reused the next, likely image-using, module will believe its memory is mapped when it isn&#8217;t, causing the host to segfault on unmapped memory it believed was mapped.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_7">31.3. Patches</h3>
<div class="paragraph">
<p>This bug has been patched and users should upgrade to Wasmtime 2.0.2.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_4">31.4. Workarounds</h3>
<div class="paragraph">
<p>Trigging this bug requires the pooling allocator to be configured and for copy-on-write heap images to also be enabled. Pooling allocation is not enabled by default but copy-on-write heap images are. Mitigations for this bug include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disabling the pooling allocator - note that pooling allocation is not enabled by default in Wasmtime</p>
</li>
<li>
<p>Disabling the <code>memory-init-cow</code> feature or with <a href="https://docs.rs/wasmtime/2.0.1/wasmtime/struct.Config.html#method.memory_init_cow"><code>Config::memory_init_cow</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_references_3">31.5. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.rs/wasmtime/2.0.1/wasmtime/struct.Config.html#method.allocation_strategy"><code>Config::allocation_strategy</code></a> - configuration required to enable the pooling allocator.</p>
</li>
<li>
<p><a href="https://docs.rs/wasmtime/2.0.1/wasmtime/struct.Config.html#method.memory_init_cow"><code>Config::memory_init_cow</code></a> - configuration required to enable or disable copy-on-write (this is enabled by default).</p>
</li>
<li>
<p><a href="https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/c1HBDDJwNPA">Mailing list announcement</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/2614f2e9d2d36805ead8a8da0fa0c6e0d9e428a0">Patch for <code>release-2.0.0</code> branch</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/3535acbf3be032ef1ba0b469b8ab92538a8a18a6">Patch for <code>main</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information">31.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_23_libp2p_dos_vulnerability_from_lack_of_resource_management">32. H-23 libp2p DoS vulnerability from lack of resource management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, <a href="https://cwe.mitre.org/data/definitions/770.html">CWE-770</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-23486">CVE-2022-23486</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-jvgw-gccv-q5p8">GHSA-jvgw-gccv-q5p8</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2748" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2748</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;libp2p&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.34.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;d5133112ce42be9482f6a87be92a605dd6bbc9e93c297aee77d172ff06908f3a&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_14">32.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_8">32.2. Impact</h3>
<div class="paragraph">
<p>An attacker node can cause a victim node to allocate a large number of small memory chunks, which can ultimately lead to the victims process running out of memory and thus getting killed by its operating system. When executed continuously, this can lead to a denial of service attack, especially relevant on a larger scale when run against more than one node of a libp2p based network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_details">32.3. Details</h3>
<div class="paragraph">
<p>In the original version of the attack, the malicious node would continuously open new streams on a single connection using a stream multiplexer that doesnt provide sufficient back pressure (mplex or yamux). While allocations per stream might be considered small, they multiply with the number of streams and connections. It is easy to defend against this one attack, e.g. by setting a strict per connection stream limit and connection limit. But there are other variations of this attack, e.g. causing memory allocations by sending partial payloads on various protocol levels, forcing the victim to buffer the partial payload for a period of time or by tricking the victim into pre-allocating buffers for messages which are never sent by the attacker.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_8">32.4. Patches</h3>
<div class="paragraph">
<p>Users are advised to upgrade to <code>libp2p</code> <code>v0.45.1</code> or above.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_4">32.5. References</h3>
<div class="paragraph">
<p>Please see our DoS Mitigation page for more information on how to incorporate mitigation strategies, monitor your application, and respond to attacks: <a href="https://docs.libp2p.io/reference/dos-mitigation/" class="bare">https://docs.libp2p.io/reference/dos-mitigation/</a>.</p>
</div>
<div class="paragraph">
<p>Please see the related disclosure for go-libp2p: <a href="https://github.com/libp2p/go-libp2p/security/advisories/GHSA-j7qp-mfxf-8xjw" class="bare">https://github.com/libp2p/go-libp2p/security/advisories/GHSA-j7qp-mfxf-8xjw</a> and js-libp2p: <a href="https://github.com/libp2p/js-libp2p/security/advisories/GHSA-f44q-634c-jvwv" class="bare">https://github.com/libp2p/js-libp2p/security/advisories/GHSA-f44q-634c-jvwv</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_2">32.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@libp2p.io">security@libp2p.io</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_24_race_condition_in_tokio">33. H-24 Race Condition in tokio</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45710">CVE-2021-45710</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-fg7r-2g4j-5cgr">GHSA-fg7r-2g4j-5cgr</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7837" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7837</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;tokio&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.22&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;5a09c0b5bb588872ab2f09afa13ee6e9dac11e10a0ec9e8e3ba39a5a5d530af6&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_8_110_3">33.1. CVSS Score: 8.1/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If a tokio::sync::oneshot channel is closed (via the oneshot::Receiver::close method), a data race may occur if the oneshot::Sender::send method is called while the corresponding oneshot::Receiver is awaited or calling try_recv.</p>
</div>
<div class="paragraph">
<p>When these methods are called concurrently on a closed channel, the two halves of the channel can concurrently access a shared memory location, resulting in a data race. This has been observed to cause memory corruption.</p>
</div>
<div class="paragraph">
<p>Note that the race only occurs when both halves of the channel are used after the Receiver half has called close. Code where close is not used, or where the Receiver is not awaited and try_recv is not called after calling close, is not affected.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_25_webpki_cpu_denial_of_service_in_certificate_path_building">34. H-25 webpki: CPU denial of service in certificate path building</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-8qv2-5vq6-g2g7">GHSA-8qv2-5vq6-g2g7</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8805" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8805</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;webpki&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.21.4&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;b8e38c0608262c46d4a56202ebabdeb094cef7e560ca7a226c6bf055188aa4ea&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_7_510_15">34.1. CVSS Score: 7.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When this crate is given a pathological certificate chain to validate, it will spend CPU time exponential with the number of candidate certificates at each step of path building.</p>
</div>
<div class="paragraph">
<p>Both TLS clients and TLS servers that accept client certificate are affected.</p>
</div>
<div class="paragraph">
<p>This was previously reported in <a href="https://github.com/briansmith/webpki/issues/69" class="bare">https://github.com/briansmith/webpki/issues/69</a>.</p>
</div>
<div class="paragraph">
<p><code>rustls-webpki</code> is a fork of this crate which contains a fix for this issue and is actively maintained.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_h_26_multiple_issues_involving_quote_api_in_shlex">35. H-26 Multiple issues involving quote API in shlex</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-r7qv-8r2h-pg27">GHSA-r7qv-8r2h-pg27</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L6680" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L6680</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;shlex&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.1&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7fdf1b9db47230893d76faad238fd6097fd6d6a9245cd7a4d90dbd639536bbd2&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_issue_1_failure_to_quote_characters">35.1. Issue 1: Failure to quote characters</h3>
<div class="paragraph">
<p>Affected versions of this crate allowed the bytes <code>{</code> and <code>\xa0</code> to appear
unquoted and unescaped in command arguments.</p>
</div>
<div class="paragraph">
<p>If the output of <code>quote</code> or <code>join</code> is passed to a shell, then what should be a
single command argument could be interpreted as multiple arguments.</p>
</div>
<div class="paragraph">
<p>This does not <strong>directly</strong> allow arbitrary command execution (you can&#8217;t inject a
command substitution or similar).  But depending on the command you&#8217;re running,
being able to inject multiple arguments where only one is expected could lead
to undesired consequences, potentially including arbitrary command execution.</p>
</div>
<div class="paragraph">
<p>The flaw was corrected in version 1.2.1 by escaping additional characters.
Updating to 1.3.0 is recommended, but 1.2.1 offers a more minimal fix if
desired.</p>
</div>
<div class="paragraph">
<p>Workaround: Check for the bytes <code>{</code> and <code>\xa0</code> in <code>quote</code>/<code>join</code> input or
output.</p>
</div>
<div class="paragraph">
<p>(Note: <code>{</code> is problematic because it is used for glob expansion.  <code>\xa0</code> is
problematic because it&#8217;s treated as a word separator in [specific
environments][solved-xa0].)</p>
</div>
</div>
<div class="sect2">
<h3 id="_issue_2_dangerous_api_w_r_t_nul_bytes">35.2. Issue 2: Dangerous API w.r.t. nul bytes</h3>
<div class="paragraph">
<p>Version 1.3.0 deprecates the <code>quote</code> and <code>join</code> APIs in favor of <code>try_quote</code>
and <code>try_join</code>, which behave the same except that they have <code>Result</code> return
type, returning <code>Err</code> if the input contains nul bytes.</p>
</div>
<div class="paragraph">
<p>Strings containing nul bytes generally cannot be used in Unix command arguments
or environment variables, and most shells cannot handle nul bytes even
internally.  If you try to pass one anyway, then the results might be
security-sensitive in uncommon scenarios.  [More details here.][nul-bytes]</p>
</div>
<div class="paragraph">
<p>Due to the low severity, the behavior of the original <code>quote</code> and <code>join</code> APIs
has not changed; they continue to allow nuls.</p>
</div>
<div class="paragraph">
<p>Workaround: Manually check for nul bytes in <code>quote</code>/<code>join</code> input or output.</p>
</div>
</div>
<div class="sect2">
<h3 id="_issue_3_lack_of_documentation_for_interactive_shell_risks">35.3. Issue 3: Lack of documentation for interactive shell risks</h3>
<div class="paragraph">
<p>The <code>quote</code> family of functions does not and cannot escape control characters.
With non-interactive shells this is perfectly safe, as control characters have
no special effect.  But if you writing directly to the standard input of an
interactive shell (or through a pty), then control characters [can cause
misbehavior including arbitrary command injection.][control-characters]</p>
</div>
<div class="paragraph">
<p>This is essentially unfixable, and has not been patched.  But as of version
1.3.0, documentation has been added.</p>
</div>
<div class="paragraph">
<p>Future versions of <code>shlex</code> may add API variants that avoid the issue at the
cost of reduced portability.</p>
</div>
<div class="paragraph">
<p>[solved-xa0]: <a href="https://docs.rs/shlex/latest/shlex/quoting_warning/index.html#solved-xa0" class="bare">https://docs.rs/shlex/latest/shlex/quoting_warning/index.html#solved-xa0</a>
[nul-bytes]: <a href="https://docs.rs/shlex/latest/shlex/quoting_warning/index.html#nul-bytes" class="bare">https://docs.rs/shlex/latest/shlex/quoting_warning/index.html#nul-bytes</a>
[control-characters]: <a href="https://docs.rs/shlex/latest/shlex/quoting_warning/index.html#control-characters-interactive-contexts-only" class="bare">https://docs.rs/shlex/latest/shlex/quoting_warning/index.html#control-characters-interactive-contexts-only</a></p>
</div>
</div>
</div>
</div>
<h1 id="_medium" class="sect0">III: Medium</h1>
<div class="sect1">
<h2 id="_m_1_default_inheritable_capabilities_for_linux_container_should_be_empty">36. M-1 Default inheritable capabilities for linux container should be empty</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/276.html">CWE-276</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-29162">CVE-2022-29162</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-f3fp-gc8g-vw66">GHSA-f3fp-gc8g-vw66</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">opencontainers</span><span class="tok-o">/</span><span class="tok-nx">runc</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.0.3</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_910">36.1. CVSS Score: 5.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_9">36.2. Impact</h3>
<div class="paragraph">
<p>A bug was found in runc where <code>runc exec --cap</code> executed processes with non-empty inheritable Linux process capabilities, creating an atypical Linux environment and enabling programs with inheritable file capabilities to elevate those capabilities to the permitted set during execve(2).</p>
</div>
<div class="paragraph">
<p>This bug did not affect the container security sandbox as the inheritable set never contained more capabilities than were included in the container&#8217;s bounding set.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_9">36.3. Patches</h3>
<div class="paragraph">
<p>This bug has been fixed in runc 1.1.2. Users should update to this version as soon as possible.</p>
</div>
<div class="paragraph">
<p>This fix changes <code>runc exec --cap</code> behavior such that the additional capabilities granted to the process being executed (as specified via <code>--cap</code> arguments) do not include inheritable capabilities.</p>
</div>
<div class="paragraph">
<p>In addition, <code>runc spec</code> is changed to not set any inheritable capabilities in the created example OCI spec (<code>config.json</code>) file.</p>
</div>
</div>
<div class="sect2">
<h3 id="_credits_4">36.4. Credits</h3>
<div class="paragraph">
<p>The opencontainers project would like to thank <a href="https://github.com/AndrewGMorgan">Andrew G. Morgan</a> for responsibly disclosing this issue in accordance with the <a href="https://github.com/opencontainers/.github/blob/master/SECURITY.md">opencontainers org security policy</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_3">36.5. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/opencontainers/runc/issues/new">Open an issue</a></p>
</li>
<li>
<p>Email us at <a href="mailto:security@opencontainers.org">security@opencontainers.org</a> if you think youve found a security bug</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_2_golang_orgxsysunix_has_incorrect_privilege_reporting_in_syscall">37. M-2 golang.org/x/sys/unix has Incorrect privilege reporting in syscall</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/269.html">CWE-269</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-29526">CVE-2022-29526</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-p782-xgp4-8hr8">GHSA-p782-xgp4-8hr8</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L249" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L249</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">sys</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20220209214540</span><span class="tok-o">-</span><span class="tok-mi">3681064</span><span class="tok-nx">d5158</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_310">37.1. CVSS Score: 5.3/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Go before 1.17.10 and 1.18.x before 1.18.2 has Incorrect Privilege Reporting in syscall. When called with a non-zero flags parameter, the Faccessat function could incorrectly report that a file is accessible.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specific_go_packages_affected_4">37.2. Specific Go Packages Affected</h3>
<div class="paragraph">
<p>golang.org/x/sys/unix</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_3_runc_apparmor_bypass_with_symlinked_proc">38. M-3 runc AppArmor bypass with symlinked /proc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/59.html">CWE-59</a>, <a href="https://cwe.mitre.org/data/definitions/281.html">CWE-281</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28642">CVE-2023-28642</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-g2j6-57v7-gm8c">GHSA-g2j6-57v7-gm8c</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">opencontainers</span><span class="tok-o">/</span><span class="tok-nx">runc</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.0.3</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_110">38.1. CVSS Score: 6.1/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_10">38.2. Impact</h3>
<div class="paragraph">
<p>It was found that AppArmor, and potentially SELinux, can be bypassed when <code>/proc</code> inside the container is symlinked with a specific mount configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_10">38.3. Patches</h3>
<div class="paragraph">
<p>Fixed in runc v1.1.5, by prohibiting symlinked <code>/proc</code>: <a href="https://github.com/opencontainers/runc/pull/3785" class="bare">https://github.com/opencontainers/runc/pull/3785</a></p>
</div>
<div class="paragraph">
<p>This PR fixes CVE-2023-27561 as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_5">38.4. Workarounds</h3>
<div class="paragraph">
<p>Avoid using an untrusted container image.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_4_docker_swarm_encrypted_overlay_network_with_a_single_endpoint_is_unauthenticated">39. M-4 Docker Swarm encrypted overlay network with a single endpoint is unauthenticated</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/420.html">CWE-420</a>, <a href="https://cwe.mitre.org/data/definitions/636.html">CWE-636</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28842">CVE-2023-28842</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-6wrf-mxfj-pf5p">GHSA-6wrf-mxfj-pf5p</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-w"> </span><span class="tok-nx">v20</span><span class="tok-mf">.10.7</span><span class="tok-o">+</span><span class="tok-nx">incompatible</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_810">39.1. CVSS Score: 6.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <strong>Docker</strong>.</p>
</div>
<div class="paragraph">
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
</div>
<div class="paragraph">
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
</div>
<div class="paragraph">
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
</div>
<div class="paragraph">
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet&#8217;s VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
</div>
<div class="paragraph">
<p>The <code>overlay</code> driver dynamically and lazily defines the kernel configuration for the VXLAN network on each node as containers are attached and detached. Routes and encryption parameters are only defined for destination nodes that participate in the network. The iptables rules that prevent encrypted overlay networks from accepting unencrypted packets are not created until a peer is available with which to communicate.</p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_11">39.2. Impact</h3>
<div class="paragraph">
<p>Encrypted overlay networks silently accept cleartext VXLAN datagrams that are tagged with the VNI of an encrypted overlay network. As a result, it is possible to inject arbitrary Ethernet frames into the encrypted overlay network by encapsulating them in VXLAN datagrams. The implications of this can be quite dire, and <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a> should be referenced for a deeper exploration.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_11">39.3. Patches</h3>
<div class="paragraph">
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime&#8217;s 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_6">39.4. Workarounds</h3>
<div class="ulist">
<ul>
<li>
<p>In multi-node clusters, deploy a global pause container for each encrypted overlay network, on every node. For example, use the <code>registry.k8s.io/pause</code> image and a <code>--mode global</code> service.</p>
</li>
<li>
<p>For a single-node cluster, do not use overlay networks of any sort. Bridge networks provide the same connectivity on a single node and have no multi-node features.
The Swarm ingress feature is implemented using an overlay network, but can be disabled by publishing ports in <code>host</code> mode instead of <code>ingress</code> mode (allowing the use of an external load balancer), and removing the <code>ingress</code> network.</p>
</li>
<li>
<p>If encrypted overlay networks are in exclusive use, block UDP port 4789 from traffic that has not been validated by IPSec. For example, <code>iptables -A INPUT -m udp -dport 4789 -m policy --dir in --pol none -j DROP</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_background_2">39.5. Background</h3>
<div class="ulist">
<ul>
<li>
<p>This issue was discovered while characterizing and mitigating <a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840</a> and <a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_2">39.6. Related</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841: Encrypted overlay network traffic may be unencrypted</a></p>
</li>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840: Encrypted overlay network may be unauthenticated</a></p>
</li>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></p>
</li>
<li>
<p><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_5_docker_swarm_encrypted_overlay_network_traffic_may_be_unencrypted">40. M-5 Docker Swarm encrypted overlay network traffic may be unencrypted</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/311.html">CWE-311</a>, <a href="https://cwe.mitre.org/data/definitions/636.html">CWE-636</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28841">CVE-2023-28841</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-33pg-m6jh-5237">GHSA-33pg-m6jh-5237</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-w"> </span><span class="tok-nx">v20</span><span class="tok-mf">.10.7</span><span class="tok-o">+</span><span class="tok-nx">incompatible</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_810_2">40.1. CVSS Score: 6.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:N/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <strong>Docker</strong>.</p>
</div>
<div class="paragraph">
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
</div>
<div class="paragraph">
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
</div>
<div class="paragraph">
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
</div>
<div class="paragraph">
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet&#8217;s VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
</div>
<div class="paragraph">
<p>An <a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207">iptables rule</a> designates outgoing VXLAN datagrams with a VNI that corresponds to an encrypted overlay network for IPsec encapsulation.</p>
</div>
<div class="paragraph">
<p>On Red Hat Enterprise Linux and derivatives such as CentOS and Rocky, the <code>xt_u32</code> module has been:
* <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.3_release_notes/rhel-8-3-0-release#technology-preview_networking">moved to the kernel-modules-extra package and no longer installed by default in RHEL 8.3</a>
* <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.6_release_notes/deprecated_functionality#deprecated-functionality_networking">officially deprecated in RHEL 8.6</a>
* <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/considerations_in_adopting_rhel_9/assembly_networking_considerations-in-adopting-rhel-9#ref_firewall-networking_assembly_networking">removed completely in RHEL 9</a></p>
</div>
<div class="paragraph">
<p>This rule is not created when <code>xt_u32</code> is unavailable, even though the container is still attached to the network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_12">40.2. Impact</h3>
<div class="paragraph">
<p>Encrypted overlay networks on affected platforms silently transmit unencrypted data. As a result, <code>overlay</code> networks may appear to be functional, passing traffic as expected, but without any of the expected confidentiality or data integrity guarantees.</p>
</div>
<div class="paragraph">
<p>It is possible for an attacker sitting in a trusted position on the network to read all of the application traffic that is moving across the overlay network, resulting in unexpected secrets or user data disclosure. Thus, because many database protocols, internal APIs, etc. are not protected by a second layer of encryption, a user may rely on Swarm encrypted overlay networks to provide confidentiality, which due to this vulnerability is no longer guaranteed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_12">40.3. Patches</h3>
<div class="paragraph">
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime&#8217;s 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_7">40.4. Workarounds</h3>
<div class="ulist">
<ul>
<li>
<p>Close the VXLAN port (by default, UDP port 4789) to outgoing traffic at the Internet boundary (see <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a>) in order to prevent unintentionally leaking unencrypted traffic over the Internet.</p>
</li>
<li>
<p>Ensure that the <code>xt_u32</code> kernel module is available on all nodes of the Swarm cluster.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_background_3">40.5. Background</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/moby/moby/issues/43382">#43382 </a>partially discussed this concern, but did not consider the security implications.</p>
</li>
<li>
<p>Mirantis FIELD-5788 essentially duplicates <a href="https://github.com/moby/moby/issues/43382">#43382</a>, and was created six months earlier; it similarly overlooked the security implications.</p>
</li>
<li>
<p><a href="https://github.com/moby/moby/pull/45118">#45118</a> is the ancestor of the final patches, and was where the security implications were discovered.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_3">40.6. Related</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840: Encrypted overlay network may be unauthenticated</a></p>
</li>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">CVE-2023-28842: Encrypted overlay network with a single endpoint is unauthenticated</a></p>
</li>
<li>
<p><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></p>
</li>
<li>
<p><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_6_cosmos_sdk_cosmovisor_component_may_be_vulnerable_to_denial_of_service">41. M-6 Cosmos-SDK Cosmovisor component may be vulnerable to denial of service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-23px-mw2p-46qm">GHSA-23px-mw2p-46qm</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">-</span><span class="tok-nx">sdk</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.45.4</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Component</strong>: Cosmovisor
<strong>Criticality</strong>: Medium
<strong>Affected Versions</strong>: Cosmovisor &lt; v1.0.0 (distributed with Cosmos-SDK &lt; 0.46)
<strong>Affected Users</strong>: Validators and Node operators utilizing unsupported versions of Cosmovisor
<strong>Impact</strong>: DOS, potential RCE on node depending on configuration</p>
</div>
<div class="paragraph">
<p>An issue has been identified on unsupported versions of Cosmovisor which may result in a Denial of Service or Remote Code Execution path depending on configuration for a node or validator using the vulnerable version to manage their node.</p>
</div>
<div class="paragraph">
<p>If a validator is utilizing an affected version of Cosmovisor with <code>DAEMON_ALLOW_DOWNLOAD_BINARIES</code> set to true, a non-default configuration, it may be possible for an attacker to trigger a Remote Code Execution path as well on the host. In this configuration it is recommended to immediately stop use of the <code>DAEMON_ALLOW_DOWNLOAD_BINARIES</code> feature, and then proceed with an upgrade of Cosmovisor.</p>
</div>
<div class="paragraph">
<p>It is recommended that all validators utilizing unsupported versions of Cosmovisor to upgrade to the latest supported versions immediately.  If you are utilizing a forked version of Cosmos-SDK, it is recommended to stop use of Cosmovisor until it is possible to update to a supported version of Cosmovisor, whether through your projects fork, or directly compiled from the Cosmos-SDK. At the time of this advisory, the latest version of Cosmovisor is v1.5.0.</p>
</div>
<div class="paragraph">
<p>Additionally, the Amulet team recommends that developers building chains powered by Cosmos-SDK share this advisory with validators and node operators to ensure this information is available to all impacted parties within their ecosystems.</p>
</div>
<div class="paragraph">
<p>For more information about Cosmovisor, see <a href="https://docs.cosmos.network/main/tooling/cosmovisor" class="bare">https://docs.cosmos.network/main/tooling/cosmovisor</a></p>
</div>
<div class="paragraph">
<p>This issue was discovered by <a href="https://maxwelldulin.com">Maxwell Dulin</a> and Nathan Kirkland, who reported it to the Cosmos Bug Bounty Program.  If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
</div>
<div class="sect2">
<h3 id="_how_to_tell_if_i_am_affected">41.1. How to tell if I am affected?</h3>
<div class="paragraph">
<p>Running the following command will output whether your cosmovisor version is vulnerable to this issue or not.</p>
</div>
<div class="paragraph">
<p>Vulnerable to this issue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>strings ./cosmovisor | grep -q &quot;NEEDED at&quot; &amp;&amp; echo &quot;vulnerable&quot; || echo &quot;NOT vulnerable&quot;

vulnerable</code></pre>
</div>
</div>
<div class="paragraph">
<p>NOT vulnerable to this issue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>strings ./cosmovisor_new | grep -q &quot;NEEDED at&quot; &amp;&amp; echo &quot;vulnerable&quot; || echo &quot;NOT vulnerable&quot;

NOT vulnerable</code></pre>
</div>
</div>
<div class="paragraph">
<p>A Note from Amulet on the Security Advisory Process</p>
</div>
<div class="paragraph">
<p>In the interest of timely resolution of this issue for validators and node operators, the Amulet team has chosen to use existing processes and resources for distributing security advisories within the Cosmos and Interchain Ecosystems. Stay tuned as we implement an improved, more robust security advisory distribution system that will provide equitable access to information about security issues in the Interchain Stack.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_7_improper_rendering_of_text_nodes_in_golang_orgxnethtml">42. M-7 Improper rendering of text nodes in golang.org/x/net/html</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-3978">CVE-2023-3978</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-2wrh-6pvc-2jm9">GHSA-2wrh-6pvc-2jm9</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">net</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20211208012354</span><span class="tok-o">-</span><span class="tok-nx">db4efeb81f4b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_110_2">42.1. CVSS Score: 6.1/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Text nodes not in the HTML namespace are incorrectly literally rendered, causing text which should be escaped to not be. This could lead to an XSS attack.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_8_http2_stream_cancellation_attack">43. M-8 HTTP/2 Stream Cancellation Attack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-44487">CVE-2023-44487</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-qppj-fm5r-hxr3">GHSA-qppj-fm5r-hxr3</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L247</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">net</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20211208012354</span><span class="tok-o">-</span><span class="tok-nx">db4efeb81f4b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_310_2">43.1. CVSS Score: 5.3/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_http2_rapid_reset_attack">43.2. HTTP/2 Rapid reset attack</h3>
<div class="paragraph">
<p>The HTTP/2 protocol allows clients to indicate to the server that a previous stream should be canceled by sending a RST_STREAM frame. The protocol does not require the client and server to coordinate the cancellation in any way, the client may do it unilaterally. The client may also assume that the cancellation will take effect immediately when the server receives the RST_STREAM frame, before any other data from that TCP connection is processed.</p>
</div>
<div class="paragraph">
<p>Abuse of this feature is called a Rapid Reset attack because it relies on the ability for an endpoint to send a RST_STREAM frame immediately after sending a request frame, which makes the other endpoint start working and then rapidly resets the request. The request is canceled, but leaves the HTTP/2 connection open.</p>
</div>
<div class="paragraph">
<p>The HTTP/2 Rapid Reset attack built on this capability is simple: The client opens a large number of streams at once as in the standard HTTP/2 attack, but rather than waiting for a response to each request stream from the server or proxy, the client cancels each request immediately.</p>
</div>
<div class="paragraph">
<p>The ability to reset streams immediately allows each connection to have an indefinite number of requests in flight. By explicitly canceling the requests, the attacker never exceeds the limit on the number of concurrent open streams. The number of in-flight requests is no longer dependent on the round-trip time (RTT), but only on the available network bandwidth.</p>
</div>
<div class="paragraph">
<p>In a typical HTTP/2 server implementation, the server will still have to do significant amounts of work for canceled requests, such as allocating new stream data structures, parsing the query and doing header decompression, and mapping the URL to a resource. For reverse proxy implementations, the request may be proxied to the backend server before the RST_STREAM frame is processed. The client on the other hand paid almost no costs for sending the requests. This creates an exploitable cost asymmetry between the server and the client.</p>
</div>
<div class="paragraph">
<p>Multiple software artifacts implementing HTTP/2 are affected. This advisory was originally ingested from the <code>swift-nio-http2</code> repo advisory and their original conent follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="_swift_nio_http2_specific_advisory">43.3. swift-nio-http2 specific advisory</h3>
<div class="paragraph">
<p>swift-nio-http2 is vulnerable to a denial-of-service vulnerability in which a malicious client can create and then reset a large number of HTTP/2 streams in a short period of time. This causes swift-nio-http2 to commit to a large amount of expensive work which it then throws away, including creating entirely new <code>Channel`s to serve the traffic. This can easily overwhelm an `EventLoop</code> and prevent it from making forward progress.</p>
</div>
<div class="paragraph">
<p>swift-nio-http2 1.28 contains a remediation for this issue that applies reset counter using a sliding window. This constrains the number of stream resets that may occur in a given window of time. Clients violating this limit will have their connections torn down. This allows clients to continue to cancel streams for legitimate reasons, while constraining malicious actors.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_9_http2_stream_cancellation_attack">44. M-9 HTTP/2 Stream Cancellation Attack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-44487">CVE-2023-44487</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-qppj-fm5r-hxr3">GHSA-qppj-fm5r-hxr3</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L28" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L28</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">google</span><span class="tok-p">.</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">grpc</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.45.0</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_310_3">44.1. CVSS Score: 5.3/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_http2_rapid_reset_attack_2">44.2. HTTP/2 Rapid reset attack</h3>
<div class="paragraph">
<p>The HTTP/2 protocol allows clients to indicate to the server that a previous stream should be canceled by sending a RST_STREAM frame. The protocol does not require the client and server to coordinate the cancellation in any way, the client may do it unilaterally. The client may also assume that the cancellation will take effect immediately when the server receives the RST_STREAM frame, before any other data from that TCP connection is processed.</p>
</div>
<div class="paragraph">
<p>Abuse of this feature is called a Rapid Reset attack because it relies on the ability for an endpoint to send a RST_STREAM frame immediately after sending a request frame, which makes the other endpoint start working and then rapidly resets the request. The request is canceled, but leaves the HTTP/2 connection open.</p>
</div>
<div class="paragraph">
<p>The HTTP/2 Rapid Reset attack built on this capability is simple: The client opens a large number of streams at once as in the standard HTTP/2 attack, but rather than waiting for a response to each request stream from the server or proxy, the client cancels each request immediately.</p>
</div>
<div class="paragraph">
<p>The ability to reset streams immediately allows each connection to have an indefinite number of requests in flight. By explicitly canceling the requests, the attacker never exceeds the limit on the number of concurrent open streams. The number of in-flight requests is no longer dependent on the round-trip time (RTT), but only on the available network bandwidth.</p>
</div>
<div class="paragraph">
<p>In a typical HTTP/2 server implementation, the server will still have to do significant amounts of work for canceled requests, such as allocating new stream data structures, parsing the query and doing header decompression, and mapping the URL to a resource. For reverse proxy implementations, the request may be proxied to the backend server before the RST_STREAM frame is processed. The client on the other hand paid almost no costs for sending the requests. This creates an exploitable cost asymmetry between the server and the client.</p>
</div>
<div class="paragraph">
<p>Multiple software artifacts implementing HTTP/2 are affected. This advisory was originally ingested from the <code>swift-nio-http2</code> repo advisory and their original conent follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="_swift_nio_http2_specific_advisory_2">44.3. swift-nio-http2 specific advisory</h3>
<div class="paragraph">
<p>swift-nio-http2 is vulnerable to a denial-of-service vulnerability in which a malicious client can create and then reset a large number of HTTP/2 streams in a short period of time. This causes swift-nio-http2 to commit to a large amount of expensive work which it then throws away, including creating entirely new <code>Channel`s to serve the traffic. This can easily overwhelm an `EventLoop</code> and prevent it from making forward progress.</p>
</div>
<div class="paragraph">
<p>swift-nio-http2 1.28 contains a remediation for this issue that applies reset counter using a sliding window. This constrains the number of stream resets that may occur in a given window of time. Clients violating this limit will have their connections torn down. This allows clients to continue to cancel streams for legitimate reasons, while constraining malicious actors.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_10_prefix_truncation_attack_against_chacha20_poly1305_and_encrypt_then_mac_aka_terrapin">45. M-10 Prefix Truncation Attack against ChaCha20-Poly1305 and Encrypt-then-MAC aka Terrapin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/345.html">CWE-345</a>, <a href="https://cwe.mitre.org/data/definitions/354.html">CWE-354</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-48795">CVE-2023-48795</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-45x7-px36-x8w8">GHSA-45x7-px36-x8w8</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L245" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L245</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">x</span><span class="tok-o">/</span><span class="tok-nx">crypto</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20220214200702</span><span class="tok-o">-</span><span class="tok-mf">86341886e292</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_910_2">45.1. CVSS Score: 5.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_summary_2">45.2. Summary</h3>
<div class="paragraph">
<p>Terrapin is a prefix truncation attack targeting the SSH protocol. More precisely, Terrapin breaks the integrity of SSH&#8217;s secure channel. By carefully adjusting the sequence numbers during the handshake, an attacker can remove an arbitrary amount of messages sent by the client or server at the beginning of the secure channel without the client or server noticing it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mitigations_2">45.3. Mitigations</h3>
<div class="paragraph">
<p>To mitigate this protocol vulnerability, OpenSSH suggested a so-called "strict kex" which alters the SSH handshake to ensure a Man-in-the-Middle attacker cannot introduce unauthenticated messages as well as convey sequence number manipulation across handshakes.</p>
</div>
<div class="paragraph">
<p><strong>Warning: To take effect, both the client and server must support this countermeasure.</strong></p>
</div>
<div class="paragraph">
<p>As a stop-gap measure, peers may also (temporarily) disable the affected algorithms and use unaffected alternatives like AES-GCM instead until patches are available.</p>
</div>
</div>
<div class="sect2">
<h3 id="_details_2">45.4. Details</h3>
<div class="paragraph">
<p>The SSH specifications of ChaCha20-Poly1305 (<a href="mailto:chacha20-poly1305@openssh.com">chacha20-poly1305@openssh.com</a>) and Encrypt-then-MAC (*-<a href="mailto:etm@openssh.com">etm@openssh.com</a> MACs) are vulnerable against an arbitrary prefix truncation attack (a.k.a. Terrapin attack). This allows for an extension negotiation downgrade by stripping the SSH_MSG_EXT_INFO sent after the first message after SSH_MSG_NEWKEYS, downgrading security, and disabling attack countermeasures in some versions of OpenSSH. When targeting Encrypt-then-MAC, this attack requires the use of a CBC cipher to be practically exploitable due to the internal workings of the cipher mode. Additionally, this novel attack technique can be used to exploit previously unexploitable implementation flaws in a Man-in-the-Middle scenario.</p>
</div>
<div class="paragraph">
<p>The attack works by an attacker injecting an arbitrary number of SSH_MSG_IGNORE messages during the initial key exchange and consequently removing the same number of messages just after the initial key exchange has concluded. This is possible due to missing authentication of the excess SSH_MSG_IGNORE messages and the fact that the implicit sequence numbers used within the SSH protocol are only checked after the initial key exchange.</p>
</div>
<div class="paragraph">
<p>In the case of ChaCha20-Poly1305, the attack is guaranteed to work on every connection as this cipher does not maintain an internal state other than the message&#8217;s sequence number. In the case of Encrypt-Then-MAC, practical exploitation requires the use of a CBC cipher; while theoretical integrity is broken for all ciphers when using this mode, message processing will fail at the application layer for CTR and stream ciphers.</p>
</div>
<div class="paragraph">
<p>For more details see <a href="https://terrapin-attack.com">https://terrapin-attack.com</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_13">45.5. Impact</h3>
<div class="paragraph">
<p>This attack targets the specification of ChaCha20-Poly1305 (<a href="mailto:chacha20-poly1305@openssh.com">chacha20-poly1305@openssh.com</a>) and Encrypt-then-MAC (*-<a href="mailto:etm@openssh.com">etm@openssh.com</a>), which are widely adopted by well-known SSH implementations and can be considered de-facto standard. These algorithms can be practically exploited; however, in the case of Encrypt-Then-MAC, we additionally require the use of a CBC cipher. As a consequence, this attack works against all well-behaving SSH implementations supporting either of those algorithms and can be used to downgrade (but not fully strip) connection security in case SSH extension negotiation (RFC8308) is supported. The attack may also enable attackers to exploit certain implementation flaws in a man-in-the-middle (MitM) scenario.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_11_denial_of_service_when_decrypting_attack_controlled_input_in_github_comdvsekhvalnovjose2go">46. M-11 Denial of service when decrypting attack controlled input in github.com/dvsekhvalnov/jose2go</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-mhpq-9638-x6pw">GHSA-mhpq-9638-x6pw</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L88" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L88</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">dvsekhvalnov</span><span class="tok-o">/</span><span class="tok-nx">jose2go</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20200901110807</span><span class="tok-o">-</span><span class="tok-mi">248326</span><span class="tok-nx">c1351b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_310_4">46.1. CVSS Score: 5.3/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An attacker controlled input of a PBES2 encrypted JWE blob can have a very large p2c value that, when decrypted, produces a denial-of-service.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_12_sysdevicesvirtualpowercap_accessible_by_default_to_containers">47. M-12 /sys/devices/virtual/powercap accessible by default to containers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-jq35-85cj-fj4p">GHSA-jq35-85cj-fj4p</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-w"> </span><span class="tok-nx">v20</span><span class="tok-mf">.10.7</span><span class="tok-o">+</span><span class="tok-nx">incompatible</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Intel&#8217;s RAPL (Running Average Power Limit) feature, introduced by the Sandy Bridge microarchitecture, provides software insights into hardware energy consumption. To facilitate this, Intel introduced the powercap framework in Linux kernel 3.13, which reads values via relevant MSRs (model specific registers) and provides unprivileged userspace access via <code>sysfs</code>. As RAPL is an interface to access a hardware feature, it is only available when running on bare metal with the module compiled into the kernel.</p>
</div>
<div class="paragraph">
<p>By 2019, it was realized that in some cases unprivileged access to RAPL readings could be exploited as a power-based side-channel against security features including AES-NI (potentially inside a SGX enclave) and KASLR (kernel address space layout randomization). Also known as the <a href="https://platypusattack.com/">PLATYPUS attack</a>, Intel assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8694">CVE-2020-8694</a> and <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8695">CVE-2020-8695</a>, and AMD assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12912">CVE-2020-12912</a>.</p>
</div>
<div class="paragraph">
<p>Several mitigations were applied; Intel reduced the sampling resolution via a microcode update, and the Linux kernel <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=949dd0104c496fa7c14991a23c03c62e44637e71">prevents access by non-root users</a> since 5.10. However, this kernel-based mitigation does not apply to many container-based scenarios:
* Unless using user namespaces, root inside a container has the same level of privilege as root outside the container, but with a slightly more narrow view of the system
* <code>sysfs</code> is mounted inside containers read-only; however only read access is needed to carry out this attack on an unpatched CPU</p>
</div>
<div class="paragraph">
<p>While this is not a direct vulnerability in container runtimes, defense in depth and safe defaults are valuable and preferred, especially as this poses a risk to multi-tenant container environments running directly on affected hardware. This is provided by masking <code>/sys/devices/virtual/powercap</code> in the default mount configuration, and adding an additional set of rules to deny it in the default AppArmor profile.</p>
</div>
<div class="paragraph">
<p>While <code>sysfs</code> is not the only way to read from the RAPL subsystem, other ways of accessing it require additional capabilities such as <code>CAP_SYS_RAWIO</code> which is not available to containers by default, or <code>perf</code> paranoia level less than 1, which is a non-default kernel tunable.</p>
</div>
<div class="sect2">
<h3 id="_references_5">47.1. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8694" class="bare">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8694</a></p>
</li>
<li>
<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8695" class="bare">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8695</a></p>
</li>
<li>
<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12912" class="bare">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12912</a></p>
</li>
<li>
<p><a href="https://platypusattack.com/" class="bare">https://platypusattack.com/</a></p>
</li>
<li>
<p><a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=949dd0104c496fa7c14991a23c03c62e44637e71" class="bare">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=949dd0104c496fa7c14991a23c03c62e44637e71</a></p>
</li>
<li>
<p><a href="https://web.eece.maine.edu/~vweaver/projects/rapl/" class="bare">https://web.eece.maine.edu/~vweaver/projects/rapl/</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_13_asa_2024_002_default_prepareproposalhandler_may_produce_invalid_proposals_when_used_with_default_sendernoncemempool">48. M-13 ASA-2024-002: Default <code>PrepareProposalHandler</code> may produce invalid proposals when used with default <code>SenderNonceMempool</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/1285.html">CWE-1285</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-2557-x9mg-76w8">GHSA-2557-x9mg-76w8</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">-</span><span class="tok-nx">sdk</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.45.4</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_310_5">48.1. CVSS Score: 5.3/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_asa_2024_002_default_prepareproposalhandler_may_produce_invalid_proposals_when_used_with_default_sendernoncemempool">48.2. ASA-2024-002: Default <code>PrepareProposalHandler</code> may produce invalid proposals when used with default <code>SenderNonceMempool</code></h3>
<div class="paragraph">
<p><strong>Component</strong>: Cosmos SDK
<strong>Criticality</strong>: Medium
<strong>Affected</strong> Versions: Cosmos SDK versions &#8656; 0.50.3; &#8656; 0.47.8
<strong>Affected</strong> Users: Chain developers, Validator and Node operators
<strong>Impact</strong>: Denial of Service</p>
</div>
</div>
<div class="sect2">
<h3 id="_summary_3">48.3. Summary</h3>
<div class="paragraph">
<p>When using the default <code>PrepareProposalHandler</code> and the default <code>SenderNonceMempool</code>, an issue was identified which may allow invalid blocks to be proposed when a single sender includes multiple transactions with non-sequential sequence numbers in certain conditions. If this state is reached, it can lead to a reduction in block production for a network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_next_steps_for_impacted_parties">48.4. Next Steps for Impacted Parties</h3>
<div class="paragraph">
<p>If you are a chain developer on an affected version of the Cosmos SDK, it is advised to update to the latest available version of the Cosmos SDK for your project.  Once a patched version is available, it is recommended that network operators upgrade.</p>
</div>
<div class="paragraph">
<p>A Github Security Advisory for this issue is available in the Cosmos-SDK <a href="https://github.com/cosmos/cosmos-sdk/security/advisories">repository</a>. For more information about Cosmos SDK, see <a href="https://docs.cosmos.network/" class="bare">https://docs.cosmos.network/</a>.</p>
</div>
<div class="paragraph">
<p>This issue was found by <a href="https://github.com/KonradStaniec">KonradStaniec</a>, <a href="https://github.com/gitferry">gitferry</a>, <a href="https://github.com/SebastianElvis">SebastianElvis</a>, and <a href="https://github.com/vitsalis">vitsalis</a> who reported it to the Cosmos Bug Bounty Program on HackerOne on January 16, 2024. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos" class="bare">https://hackerone.com/cosmos</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_14_jose2go_vulnerable_to_denial_of_service_via_large_p2c_value">49. M-14 jose2go vulnerable to denial of service via large p2c value</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-50658">CVE-2023-50658</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-6294-6rgp-fr7r">GHSA-6294-6rgp-fr7r</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L88" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L88</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">dvsekhvalnov</span><span class="tok-o">/</span><span class="tok-nx">jose2go</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.0.0</span><span class="tok-o">-</span><span class="tok-mi">20200901110807</span><span class="tok-o">-</span><span class="tok-mi">248326</span><span class="tok-nx">c1351b</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The jose2go component before 1.6.0 for Go allows attackers to cause a denial of service (CPU consumption) via a large p2c (aka PBES2 Count) value.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_15_golang_protojson_unmarshal_function_infinite_loop_when_unmarshaling_certain_forms_of_invalid_json">50. M-15 Golang protojson.Unmarshal function infinite loop when unmarshaling certain forms of invalid JSON</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/835.html">CWE-835</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24786">CVE-2024-24786</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-8r3f-844c-mc37">GHSA-8r3f-844c-mc37</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L29" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L29</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">google</span><span class="tok-p">.</span><span class="tok-nx">golang</span><span class="tok-p">.</span><span class="tok-nx">org</span><span class="tok-o">/</span><span class="tok-nx">protobuf</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.27.1</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The protojson.Unmarshal function can enter an infinite loop when unmarshaling certain forms of invalid JSON. This condition can occur when unmarshaling into a message which contains a google.protobuf.Any value, or when the UnmarshalOptions.DiscardUnknown option is set.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_16_classic_builder_cache_poisoning">51. M-16 Classic builder cache poisoning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/345.html">CWE-345</a>, <a href="https://cwe.mitre.org/data/definitions/346.html">CWE-346</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-24557">CVE-2024-24557</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-xw73-rw38-6vjc">GHSA-xw73-rw38-6vjc</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-w"> </span><span class="tok-nx">v20</span><span class="tok-mf">.10.7</span><span class="tok-o">+</span><span class="tok-nx">incompatible</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_910">51.1. CVSS Score: 6.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:H/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The classic builder cache system is prone to cache poisoning if the image is built <code>FROM scratch</code>.
Also, changes to some instructions (most important being <code>HEALTHCHECK</code> and <code>ONBUILD</code>) would not cause a cache miss.</p>
</div>
<div class="paragraph">
<p>An attacker with the knowledge of the Dockerfile someone is using could poison their cache by making them pull a specially crafted image that would be considered as a valid cache candidate for some build steps.</p>
</div>
<div class="paragraph">
<p>For example, an attacker could create an image that is considered as a valid cache candidate for:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>FROM scratch
MAINTAINER Pawel</code></pre>
</div>
</div>
<div class="paragraph">
<p>when in fact the malicious image used as a cache would be an image built from a different Dockerfile.</p>
</div>
<div class="paragraph">
<p>In the second case, the attacker could for example substitute a different <code>HEALTCHECK</code> command.</p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_14">51.2. Impact</h3>
<div class="paragraph">
<p>23.0+ users are only affected if they explicitly opted out of Buildkit (<code>DOCKER_BUILDKIT=0</code> environment variable) or are using the <code>/build</code> API endpoint (which uses the classic builder by default).</p>
</div>
<div class="paragraph">
<p>All users on versions older than 23.0 could be impacted. An example could be a CI with a shared cache, or just a regular Docker user pulling a malicious image due to misspelling/typosquatting.</p>
</div>
<div class="paragraph">
<p>Image build API endpoint (<code>/build</code>) and <code>ImageBuild</code> function from <code>github.com/docker/docker/client</code> is also affected as it the uses classic builder by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_13">51.3. Patches</h3>
<div class="paragraph">
<p>Patches are included in Moby releases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>v25.0.2</p>
</li>
<li>
<p>v24.0.9</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_8">51.4. Workarounds</h3>
<div class="ulist">
<ul>
<li>
<p>Use <code>--no-cache</code> or use Buildkit if possible (<code>DOCKER_BUILDKIT=1</code>, it&#8217;s default on 23.0+ assuming that the buildx plugin is installed).</p>
</li>
<li>
<p>Use <code>Version = types.BuilderBuildKit</code> or <code>NoCache = true</code> in <code>ImageBuildOptions</code> for <code>ImageBuild</code> call.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_17_mobys_external_dns_requests_from_internal_networks_could_lead_to_data_exfiltration">52. M-17 Moby&#8217;s external DNS requests from 'internal' networks could lead to data exfiltration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/669.html">CWE-669</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-29018">CVE-2024-29018</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-mq39-4gv4-mvpx">GHSA-mq39-4gv4-mvpx</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L84</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-o">/</span><span class="tok-nx">docker</span><span class="tok-w"> </span><span class="tok-nx">v20</span><span class="tok-mf">.10.7</span><span class="tok-o">+</span><span class="tok-nx">incompatible</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_910_3">52.1. CVSS Score: 5.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Moby is an open source container framework originally developed by Docker Inc. as Docker. It is a key component of Docker Engine, Docker Desktop, and other distributions of container tooling or runtimes. As a batteries-included container runtime, Moby comes with a built-in networking implementation that enables communication between containers, and between containers and external resources.</p>
</div>
<div class="paragraph">
<p>Moby&#8217;s networking implementation allows for creating and using many networks, each with their own subnet and gateway. This feature is frequently referred to as custom networks, as each network can have a different driver, set of parameters, and thus behaviors. When creating a network, the <code>--internal</code> flag is used to designate a network as <em>internal</em>. The <code>internal</code> attribute in a docker-compose.yml file may also be used to mark a network <em>internal</em>, and other API clients may specify the <code>internal</code> parameter as well.</p>
</div>
<div class="paragraph">
<p>When containers with networking are created, they are assigned unique network interfaces and IP addresses (typically from a non-routable <a href="https://datatracker.ietf.org/doc/html/rfc1918">RFC 1918</a> subnet). The root network namespace (hereafter referred to as the 'host') serves as a router for non-internal networks, with a gateway IP that provides SNAT/DNAT to/from container IPs.</p>
</div>
<div class="paragraph">
<p>Containers on an <em>internal</em> network may communicate between each other, but are precluded from communicating with any networks the host has access to (LAN or WAN) as no default route is configured, and firewall rules are set up to drop all outgoing traffic. Communication with the gateway IP address (and thus appropriately configured host services) is possible, and the host may communicate with any container IP directly.</p>
</div>
<div class="paragraph">
<p>In addition to configuring the Linux kernel&#8217;s various networking features to enable container networking, <code>dockerd</code> directly provides some services to container networks. Principal among these is serving as a resolver, enabling service discovery (looking up other containers on the network by name), and resolution of names from an upstream resolver.</p>
</div>
<div class="paragraph">
<p>When a DNS request for a name that does not correspond to a container is received, the request is forwarded to the configured upstream resolver (by default, the host&#8217;s configured resolver). This request is made from the container network namespace: the level of access and routing of traffic is the same as if the request was made by the container itself.</p>
</div>
<div class="paragraph">
<p>As a consequence of this design, containers solely attached to <em>internal</em> network(s) will be unable to resolve names using the upstream resolver, as the container itself is unable to communicate with that nameserver. Only the names of containers also attached to the internal network are able to be resolved.</p>
</div>
<div class="paragraph">
<p>Many systems will run a local forwarding DNS resolver, typically present on a loopback address (<code>127.0.0.0/8</code>), such as systemd-resolved or dnsmasq. Common loopback address examples include <code>127.0.0.1</code> or <code>127.0.0.53</code>. As the host and any containers have separate loopback devices, a consequence of the design described above is that containers are unable to resolve names from the host&#8217;s configured resolver, as they cannot reach these addresses on the host loopback device.</p>
</div>
<div class="paragraph">
<p>To bridge this gap, and to allow containers to properly resolve names even when a local forwarding resolver is used on a loopback address, <code>dockerd</code> will detect this scenario and instead forward DNS requests from the host/root network namespace. The loopback resolver will then forward the requests to its configured upstream resolvers, as expected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_15">52.2. Impact</h3>
<div class="paragraph">
<p>Because <code>dockerd</code> will forward DNS requests to the host loopback device, bypassing the container network namespace&#8217;s normal routing semantics entirely, <em>internal</em> networks can unexpectedly forward DNS requests to an external nameserver.</p>
</div>
<div class="paragraph">
<p>By registering a domain for which they control the authoritative nameservers, an attacker could arrange for a compromised container to exfiltrate data by encoding it in DNS queries that will eventually be answered by their nameservers. For example, if the domain <code>evil.example</code> was registered, the authoritative nameserver(s) for that domain could (eventually and indirectly) receive a request for <code>this-is-a-secret.evil.example</code>.</p>
</div>
<div class="paragraph">
<p>Docker Desktop is not affected, as Docker Desktop always runs an internal resolver on a RFC 1918 address.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_14">52.3. Patches</h3>
<div class="paragraph">
<p>Moby releases 26.0.0-rc3, 25.0.5 (released) and 23.0.11 (to be released) are patched to prevent forwarding DNS requests from internal networks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_9">52.4. Workarounds</h3>
<div class="ulist">
<ul>
<li>
<p>Run containers intended to be solely attached to <em>internal</em> networks with a custom upstream address (<code>--dns</code> argument to <code>docker run</code>, or API equivalent), which will force all upstream DNS queries to be resolved from the container network namespace.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_background_4">52.5. Background</h3>
<div class="ulist">
<ul>
<li>
<p>yair zak originally reported this issue to the Docker security team.</p>
</li>
<li>
<p>PR <a href="https://github.com/moby/moby/pull/46609" class="bare">https://github.com/moby/moby/pull/46609</a> was opened in public to fix this issue, as it was not originally considered to have a security implication.</p>
</li>
<li>
<p><a href="https://docs.docker.com/network/drivers/ipvlan/#:~:text=If%20the%20parent,the%20network%20completely">The official documentation</a> claims that "the <code>--internal</code> flag that will completely isolate containers on a network from any communications external to that network," which necessitated this advisory and CVE.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_18_integer_overflow_in_chunked_transfer_encoding">53. M-18 Integer Overflow in Chunked Transfer-Encoding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/190.html">CWE-190</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32714">CVE-2021-32714</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-5h46-h7hh-c6x9">GHSA-5h46-h7hh-c6x9</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2259" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2259</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;hyper&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.12.36&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;5c843caf6296fc1f93444735205af9ed4e109a539005abb2564ae1d6fad34c52&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_910_4">53.1. CVSS Score: 5.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_summary_4">53.2. Summary</h3>
<div class="paragraph">
<p>hyper&#8217;s HTTP server and client code had a flaw that could trigger an integer overflow when decoding chunk sizes that are too big. This allows possible data loss, or if combined with an upstream HTTP proxy that allows chunk sizes larger than hyper does, can result in "request smuggling" or "desync attacks".</p>
</div>
</div>
<div class="sect2">
<h3 id="_vulnerability">53.3. Vulnerability</h3>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>GET / HTTP/1.1
Host: example.com
Transfer-Encoding: chunked

f0000000000000003
abc
0</code></pre>
</div>
</div>
<div class="paragraph">
<p>hyper only reads the rightmost 64-bit integer as the chunk size. So it reads <code>f0000000000000003</code> as <code>3</code>. A loss of data can occur since hyper would then read only 3 bytes of the body. Additionally, an HTTP request smuggling vulnerability would occur if using a proxy which instead has prefix truncation in the chunk size, or that understands larger than 64-bit chunk sizes.</p>
</div>
<div class="paragraph">
<p>Read more about desync attacks: <a href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn" class="bare">https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_16">53.4. Impact</h3>
<div class="paragraph">
<p>To determine if vulnerable to <em>data loss</em>, these things must be true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Using HTTP/1.1.</strong> Since HTTP/2 does not use chunked encoding, it is not vulnerable.</p>
</li>
<li>
<p><strong>Using hyper as a server or client.</strong> The body would be improperly truncated in either case.</p>
</li>
<li>
<p><strong>Users send requests or responses with chunk sizes greater than 18 exabytes</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To determine if vulnerable to <em>desync attacks</em>, these things must be true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Using an upstream proxy that allows chunks sizes larger than 64-bit.</strong> If the proxy rejects chunk sizes that are too large, that request won&#8217;t be forwarded to hyper.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_patches_15">53.5. Patches</h3>
<div class="paragraph">
<p>We have released the following patch versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>v0.14.10 (to be released when this advisory is published)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_10">53.6. Workarounds</h3>
<div class="paragraph">
<p>Besides upgrading hyper, you can take the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reject requests manually that contain a <code>Transfer-Encoding</code> header.</p>
</li>
<li>
<p>Ensure any upstream proxy rejects <code>Transfer-Encoding</code> chunk sizes greater than what fits in 64-bit unsigned integers.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_credits_5">53.7. Credits</h3>
<div class="paragraph">
<p>This issue was initially reported by <a href="https://grenfeldt.dev/">Mattias Grenfeldt</a> and Asta Olofsson.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_19_error_on_unsupported_architectures_in_raw_cpuid">54. M-19 Error on unsupported architectures in raw-cpuid</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a>, <a href="https://cwe.mitre.org/data/definitions/657.html">CWE-657</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-26307">CVE-2021-26307</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-jrf8-cmgg-gv2m">GHSA-jrf8-cmgg-gv2m</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;raw-cpuid&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;8.1.2&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1fdf7d9dbd43f3d81d94a49c1c3df73cc2b3827995147e6cf7f89d4ec5483e73&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_510">54.1. CVSS Score: 5.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>native_cpuid::cpuid_count() exposes the unsafe __cpuid_count() intrinsic from core::arch::x86 or core::arch::x86_64 as a safe function, and uses it internally, without checking the safety requirement:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The CPU the program is currently running on supports the function being called.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>CPUID is available in most, but not all, x86/x86_64 environments. The crate compiles only on these architectures, so others are unaffected. This issue is mitigated by the fact that affected programs are expected to crash deterministically every time.</p>
</div>
<div class="paragraph">
<p>The flaw has been fixed in v9.0.0, by intentionally breaking compilation when targeting SGX or 32-bit x86 without SSE. This covers all affected CPUs.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_20_data_races_in_lock_api">55. M-20 Data races in lock_api</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-35913">CVE-2020-35913</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-hj9h-wrgg-hgmx">GHSA-hj9h-wrgg-hgmx</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;lock_api&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.3.4&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c4da24a77a3d8a6d4862d95f72e6fdb9c09a643ecdb402d754004a557f2bec75&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_4_710">55.1. CVSS Score: 4.7/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 47. CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the lock_api crate before 0.4.2 for Rust. A data race can occur because of RwLockReadGuard unsoundness.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_21_data_races_in_lock_api">56. M-21 Data races in lock_api</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-35912">CVE-2020-35912</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-5wg8-7c9q-794v">GHSA-5wg8-7c9q-794v</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;lock_api&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.3.4&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c4da24a77a3d8a6d4862d95f72e6fdb9c09a643ecdb402d754004a557f2bec75&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_4_710_2">56.1. CVSS Score: 4.7/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 48. CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the lock_api crate before 0.4.2 for Rust. A data race can occur because of MappedRwLockWriteGuard unsoundness.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_22_data_races_in_lock_api">57. M-22 Data races in lock_api</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-35911">CVE-2020-35911</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-vh4p-6j7g-f4j9">GHSA-vh4p-6j7g-f4j9</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;lock_api&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.3.4&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c4da24a77a3d8a6d4862d95f72e6fdb9c09a643ecdb402d754004a557f2bec75&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_4_710_3">57.1. CVSS Score: 4.7/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 49. CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the lock_api crate before 0.4.2 for Rust. A data race can occur because of MappedRwLockReadGuard unsoundness.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_23_data_races_in_lock_api">58. M-23 Data races in lock_api</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-35914">CVE-2020-35914</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-gmv4-vmx3-x9f3">GHSA-gmv4-vmx3-x9f3</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;lock_api&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.3.4&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c4da24a77a3d8a6d4862d95f72e6fdb9c09a643ecdb402d754004a557f2bec75&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_4_710_4">58.1. CVSS Score: 4.7/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 50. CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the lock_api crate before 0.4.2 for Rust. A data race can occur because of RwLockWriteGuard unsoundness.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_24_data_races_in_lock_api">59. M-24 Data races in lock_api</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/362.html">CWE-362</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-35910">CVE-2020-35910</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-ppj3-7jw3-8vc4">GHSA-ppj3-7jw3-8vc4</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3219</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;lock_api&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.3.4&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c4da24a77a3d8a6d4862d95f72e6fdb9c09a643ecdb402d754004a557f2bec75&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_510_2">59.1. CVSS Score: 5.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 51. CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>An issue was discovered in the lock_api crate before 0.4.2 for Rust. A data race can occur because of MappedMutexGuard unsoundness.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_25_invalid_drop_of_partially_initialized_instances_in_the_pooling_instance_allocator_for_modules_with_defined_externref_globals">60. M-25 Invalid drop of partially-initialized instances in the pooling instance allocator for modules with defined <code>externref</code> globals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/824.html">CWE-824</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-23636">CVE-2022-23636</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-88xq-w8cq-xfg7">GHSA-88xq-w8cq-xfg7</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_110">60.1. CVSS Score: 5.1/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 52. CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_17">60.2. Impact</h3>
<div class="paragraph">
<p>There exists a bug in the pooling instance allocator in Wasmtime&#8217;s runtime where a failure to instantiate an instance for a module that defines an <code>externref</code> global will result in an invalid drop of a <code>VMExternRef</code> via an uninitialized pointer.</p>
</div>
<div class="paragraph">
<p>As instance slots may be reused between consecutive instantiations, the value of the uninitialized pointer may be from a previous instantiation and therefore under the control of an attacker via a module&#8217;s initial values for its globals. If the attacker can somehow determine an address under their control inside the mapped memory representing the instance pool, it is possible to trick the runtime to call <code>drop_in_place</code> on a trait object under the attacker&#8217;s control and therefore cause remote code execution.</p>
</div>
<div class="paragraph">
<p>Exploiting the bug to cause remote code execution would be very difficult as attackers cannot determine the addresses of globals from code executing within the WebAssembly VM and the memory space for the instance pool cannot be statically determined. Operating system mitigations, such as <a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization">address space layout randomization</a>, would additionally increase the difficulty for attackers to determine useful executable code to target with an exploit. It is also very unlikely that attackers will be able to directly influence the conditions that trigger the bug as described below.</p>
</div>
<div class="paragraph">
<p>When the conditions to trigger the bug are met, however, it is much easier to exploit this bug to cause a denial of service by crashing the host with an invalid memory read.</p>
</div>
<div class="paragraph">
<p>The following engine configuration (via <a href="https://docs.rs/wasmtime/0.34.0/wasmtime/struct.Config.html">Config</a>) is required to be impacted by this bug:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>support for the reference types proposal must be enabled (this is the default for <code>Config</code>).</p>
</li>
<li>
<p>a pooling allocation strategy must be configured via <a href="https://docs.rs/wasmtime/0.34.0/wasmtime/struct.Config.html#method.allocation_strategy">Config::allocation_strategy</a>, which is <strong>not the default allocation strategy</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A module must be instantiated with <strong>all the following characteristics</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The module defines at least one table or memory.</p>
</li>
<li>
<p>The module defines at least one <code>externref</code> global.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>During instantiation, <strong>one of the following</strong> must occur to cause the instantiation to fail:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a call to <code>mprotect</code> or <code>VirtualAlloc</code> fails (e.g. out-of-memory conditions).</p>
</li>
<li>
<p>a resource limiter was configured in the associated <code>Store</code> (via <a href="https://docs.rs/wasmtime/0.34.0/wasmtime/struct.Store.html#method.limiter">Store::limiter</a> or <a href="https://docs.rs/wasmtime/0.34.0/wasmtime/struct.Store.html#method.limiter_async">Store::limiter_async</a>) and the limiter returns <code>false</code> from the initial call to <code>memory_growing</code> or <code>table_growing</code>. <strong>Stores do not have a resource limiter set by default</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This results in a partially-initialized instance being dropped and that attempts to drop the uninitialized <code>VMExternRef</code> representing the defined <code>externref</code> global.</p>
</div>
<div class="paragraph">
<p>We have reason to believe that the effective impact of this bug is relatively small because the usage of <code>externref</code> is still uncommon and without a resource limiter configured on the <code>Store</code>, which is not the default configuration, it is only possible to trigger the bug from an error returned by <code>mprotect</code> or <code>VirtualAlloc</code>.</p>
</div>
<div class="paragraph">
<p>Note that on Linux with the <code>uffd</code> feature enabled, it is only possible to trigger the bug from a resource limiter as the call to <code>mprotect</code> is skipped; if no resource limiter is used, then this configuration is not vulnerable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_16">60.3. Patches</h3>
<div class="paragraph">
<p>The bug has been fixed in 0.34.1 and 0.33.1; users are encouraged to upgrade as soon as possible.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_11">60.4. Workarounds</h3>
<div class="paragraph">
<p>If it is not possible to upgrade to 0.34.1 or 0.33.1 of the <code>wasmtime</code> crate, it is recommend that support for the reference types proposal be disabled by passing <code>false</code> to <a href="https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_reference_types">Config::wasm_reference_types</a>.</p>
</div>
<div class="paragraph">
<p>Doing so will prevent modules that use <code>externref</code> from being loaded entirely.</p>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_4">60.5. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_26_wrong_type_for_linker_define_functions_when_used_across_two_engines">61. M-26 Wrong type for <code>Linker</code>-define functions when used across two `Engine`s</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/843.html">CWE-843</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-39219">CVE-2021-39219</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-q879-9g95-56mx">GHSA-q879-9g95-56mx</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_310">61.1. CVSS Score: 6.3/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 53. CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_18">61.2. Impact</h3>
<div class="paragraph">
<p>As a Rust library the <code>wasmtime</code> crate clearly marks which functions are safe and which are <code>unsafe</code>, guaranteeing that if consumers never use <code>unsafe</code> then it should not be possible to have memory unsafety issues in their embeddings of Wasmtime. An issue was discovered in the safe API of <code>Linker::func_*</code> APIs. These APIs were previously not sound when one <code>Engine</code> was used to create the <code>Linker</code> and then a different <code>Engine</code> was used to create a <code>Store</code> and then the <code>Linker</code> was used to instantiate a module into that <code>Store</code>. Cross-<code>Engine</code> usage of functions is not supported in Wasmtime and this can result in type confusion of function pointers, resulting in being able to safely call a function with the wrong type.</p>
</div>
<div class="paragraph">
<p>Triggering this bug requires using at least two <code>Engine</code> values in an embedding and then additionally using two different values with a <code>Linker</code> (one at the creation time of the <code>Linker</code> and another when instantiating a module with the <code>Linker</code>).</p>
</div>
<div class="paragraph">
<p>It&#8217;s expected that usage of more-than-one <code>Engine</code> in an embedding is relatively rare since an <code>Engine</code> is intended to be a globally shared resource, so the expectation is that the impact of this issue is relatively small.</p>
</div>
<div class="paragraph">
<p>The fix implemented is to change this behavior to <code>panic!()</code> in Rust instead of silently allowing it. Using different <code>Engine</code> instances with a <code>Linker</code> is a programmer bug that <code>wasmtime</code> catches at runtime.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_17">61.3. Patches</h3>
<div class="paragraph">
<p>This bug has been patched and users should upgrade to Wasmtime version 0.30.0.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_12">61.4. Workarounds</h3>
<div class="paragraph">
<p>If you cannot upgrade Wasmtime and are using more than one <code>Engine</code> in your embedding it&#8217;s recommended to instead use only one <code>Engine</code> for the entire program if possible. An <code>Engine</code> is designed to be a globally shared resource that is suitable to have only one for the lifetime of an entire process. If using multiple <code>Engine`s is required then code should be audited to ensure that `Linker</code> is only used with one <code>Engine</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_5">61.5. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the <code>bytecodealliance/wasmtime</code> repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_27_miscompilation_of_i8x16_swizzle_and_select_with_v128_inputs">62. M-27 Miscompilation of <code>i8x16.swizzle</code> and <code>select</code> with v128 inputs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/682.html">CWE-682</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-31104">CVE-2022-31104</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-jqwc-c49r-4w2x">GHSA-jqwc-c49r-4w2x</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_4_810">62.1. CVSS Score: 4.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 54. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_19">62.2. Impact</h3>
<div class="paragraph">
<p>Wasmtime&#8217;s implementation of the <a href="https://github.com/webassembly/simd">SIMD proposal for WebAssembly</a> on x86_64 contained two distinct bugs in the instruction lowerings implemented in Cranelift. The aarch64 implementation of the simd proposal is not affected. The bugs were presented in the <code>i8x16.swizzle</code> and <code>select</code> WebAssembly instructions. The <code>select</code> instruction is only affected when the inputs are of <code>v128</code> type. The correspondingly affected Cranelift instructions were <code>swizzle</code> and <code>select</code>.</p>
</div>
<div class="paragraph">
<p>The <code>swizzle</code> instruction lowering in Cranelift erroneously overwrote the mask input register which could corrupt a constant value, for example. This means that future uses of the same constant may see a different value than the constant itself.</p>
</div>
<div class="paragraph">
<p>The <code>select</code> instruction lowering in Cranelift wasn&#8217;t correctly implemented for vector types that are 128-bits wide. When the condition was 0 the wrong instruction was used to move the correct input to the output of the instruction meaning that only the low 32 bits were moved and the upper 96 bits of the result were left as whatever the register previously contained (instead of the input being moved from). The <code>select</code> instruction worked correctly if the condition was nonzero, however.</p>
</div>
<div class="paragraph">
<p>This bug in Wasmtime&#8217;s implementation of these instructions on x86_64 represents an incorrect implementation of the specified semantics of these instructions according to the <a href="https://webassembly.github.io/spec/">WebAssembly specification</a>. The impact of this is benign for hosts running WebAssembly but represents possible vulnerabilities within the execution of a guest program. For example a WebAssembly program could take unintended branches or materialize incorrect values internally which runs the risk of exposing the program itself to other related vulnerabilities which can occur from miscompilations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_18">62.3. Patches</h3>
<div class="paragraph">
<p>We have released Wasmtime 0.38.1 and cranelift-codegen (and other associated cranelift crates) 0.85.1 which contain the corrected implementations of these two instructions in Cranelift.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_13">62.4. Workarounds</h3>
<div class="paragraph">
<p>If upgrading is not an option for you at this time, you can avoid the vulnerability by <a href="https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_simd">disabling the Wasm simd proposal</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">config</span><span class="tok-p">.</span><span class="tok-n">wasm_simd</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally the bug is only present on x86_64 hosts. Other aarch64 hosts are not affected. Note that s390x hosts don&#8217;t yet implement the simd proposal and are not affected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_6">62.5. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/webassembly/simd">The WebAssembly simd proposal</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/issues/4315">Original test case showing the erroneous behavior</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/4318">Fix for the <code>swizzle</code> instruction</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/4317">Fix for the <code>select</code> instruction</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_6">62.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_28_cranelift_vulnerable_to_miscompilation_of_constant_values_in_division_on_aarch64">63. M-28 Cranelift vulnerable to miscompilation of constant values in division on AArch64</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/682.html">CWE-682</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-31169">CVE-2022-31169</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-7f6x-jwh5-m9r4">GHSA-7f6x-jwh5-m9r4</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_910_5">63.1. CVSS Score: 5.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 55. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_20">63.2. Impact</h3>
<div class="paragraph">
<p>There was a bug in Wasmtime&#8217;s code generator, Cranelift, for AArch64 targets where constant divisors could result in incorrect division results at runtime. The translation rules for constants did not take into account whether sign- or zero-extension should happen, which resulted in an incorrect value being placed into a register when a division was encountered. For example, a constant 32-bit unsigned divisor of <code>0xfffffffe</code> would be incorrectly sign-extended to 64-bits to <code>0xfffffffffffffffe</code>. Any kind of division of operands smaller than 64 bits is implemented with a 64-bit division instruction which would then result in an incorrect result because the divisor was larger than expected.</p>
</div>
<div class="paragraph">
<p>The impact of this bug is that programs executing within the WebAssembly sandbox would not behave according to the WebAssembly specification. This means that it is hypothetically possible for execution within the sandbox to go awry and WebAssembly programs could produce unexpected results. This should not impact hosts executing WebAssembly, but does affect the correctness of guest programs.</p>
</div>
<div class="paragraph">
<p>This bug was found with differential fuzzing of Wasmtime against other engines on the AArch64 platform. Fuzzing on AArch64 is not regularly performed at this time and the Wasmtime team is investigating how best to continuously fuzz AArch64 in the same manner as x86_64.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_19">63.3. Patches</h3>
<div class="paragraph">
<p>This bug has been patched and users should upgrade to Wasmtime version 0.38.2.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_14">63.4. Workarounds</h3>
<div class="paragraph">
<p>If upgrading is not an option at this time, direct users of Cranelift that control the exact Cranelift instructions being compiled can avoid the vulnerability by explicitly extending constant divisors to 64 bits using either the <code>sextend.i64</code> or the <code>uextend.i64</code> operation.</p>
</div>
<div class="paragraph">
<p>Note, though, that this issue only affects the AArch64 targets. Other platforms are not affected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_7">63.5. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_29_cranelift_vulnerable_to_miscompilation_of_constant_values_in_division_on_aarch64">64. M-29 Cranelift vulnerable to miscompilation of constant values in division on AArch64</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/682.html">CWE-682</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-31169">CVE-2022-31169</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-7f6x-jwh5-m9r4">GHSA-7f6x-jwh5-m9r4</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L901" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L901</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;cranelift-codegen&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.69.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1a54e4beb833a3c873a18a8fe735d73d732044004c7539a072c8faa35ccb0c60&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_910_6">64.1. CVSS Score: 5.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 56. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_21">64.2. Impact</h3>
<div class="paragraph">
<p>There was a bug in Wasmtime&#8217;s code generator, Cranelift, for AArch64 targets where constant divisors could result in incorrect division results at runtime. The translation rules for constants did not take into account whether sign- or zero-extension should happen, which resulted in an incorrect value being placed into a register when a division was encountered. For example, a constant 32-bit unsigned divisor of <code>0xfffffffe</code> would be incorrectly sign-extended to 64-bits to <code>0xfffffffffffffffe</code>. Any kind of division of operands smaller than 64 bits is implemented with a 64-bit division instruction which would then result in an incorrect result because the divisor was larger than expected.</p>
</div>
<div class="paragraph">
<p>The impact of this bug is that programs executing within the WebAssembly sandbox would not behave according to the WebAssembly specification. This means that it is hypothetically possible for execution within the sandbox to go awry and WebAssembly programs could produce unexpected results. This should not impact hosts executing WebAssembly, but does affect the correctness of guest programs.</p>
</div>
<div class="paragraph">
<p>This bug was found with differential fuzzing of Wasmtime against other engines on the AArch64 platform. Fuzzing on AArch64 is not regularly performed at this time and the Wasmtime team is investigating how best to continuously fuzz AArch64 in the same manner as x86_64.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_20">64.3. Patches</h3>
<div class="paragraph">
<p>This bug has been patched and users should upgrade to Wasmtime version 0.38.2.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_15">64.4. Workarounds</h3>
<div class="paragraph">
<p>If upgrading is not an option at this time, direct users of Cranelift that control the exact Cranelift instructions being compiled can avoid the vulnerability by explicitly extending constant divisors to 64 bits using either the <code>sextend.i64</code> or the <code>uextend.i64</code> operation.</p>
</div>
<div class="paragraph">
<p>Note, though, that this issue only affects the AArch64 targets. Other platforms are not affected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_8">64.5. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_30_owning_ref_vulnerable_to_multiple_soundness_issues">65. M-30 owning_ref vulnerable to multiple soundness issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-9qxh-258v-666c">GHSA-9qxh-258v-666c</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3891" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3891</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;owning_ref&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.4.1&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;6ff55baddef9e4ad00f88b6c743a2a8062d4c6ade126c2a528644b8e444d52ce&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OwningRef::map_with_owner</code> is <a href="https://github.com/Kimundi/owning-ref-rs/issues/77">unsound</a> and may result in a use-after-free.</p>
</li>
<li>
<p><code>OwningRef::map</code> is <a href="https://github.com/Kimundi/owning-ref-rs/issues/71">unsound</a> and may result in a use-after-free.</p>
</li>
<li>
<p><code>OwningRefMut::as_owner</code> and <code>OwningRefMut::as_owner_mut</code> are <a href="https://github.com/Kimundi/owning-ref-rs/issues/61">unsound</a> and may result in a use-after-free.</p>
</li>
<li>
<p>The crate <a href="https://github.com/Kimundi/owning-ref-rs/issues/49">violates Rust&#8217;s aliasing rules</a>, which may cause miscompilations on recent compilers that emit the LLVM <code>noalias</code> attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>No patched versions are available at this time. While a pull request with some fixes is outstanding, the maintainer appears to be unresponsive.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_31_rocksdb_vulnerable_to_out_of_bounds_read">66. M-31 rocksdb vulnerable to out-of-bounds read</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-xpp3-xrff-w6rh">GHSA-xpp3-xrff-w6rh</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5330" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5330</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;rocksdb&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.16.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c749134fda8bfc90d0de643d59bfc841dcb3ac8a1062e12b6754bd60235c48b3&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Affected versions of this crate called the RocksDB C API
<code>rocksdb_open_column_families_with_ttl()</code> with a pointer to a single integer
TTL value, but one TTL value for each column family is expected.</p>
</div>
<div class="paragraph">
<p>This is only relevant when using
<code>rocksdb::DBWithThreadMode::open_cf_descriptors_with_ttl()</code> with multiple
column families.</p>
</div>
<div class="paragraph">
<p>This bug has been fixed in v0.19.0.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_32_bumpalo_has_use_after_free_due_to_a_lifetime_error_in_vecinto_iter">67. M-32 bumpalo has use-after-free due to a lifetime error in <code>Vec::into_iter()</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-f85w-wvc7-crwc">GHSA-f85w-wvc7-crwc</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L634" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L634</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;bumpalo&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;3.7.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;9c59e7af012c713f529e7a3ee57ce9b31ddd858d4b512923602f74608b009631&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In affected versions of this crate, the lifetime of the iterator produced by <code>Vec::into_iter()</code> is not constrained to the lifetime of the <code>Bump</code> that allocated the vector&#8217;s memory. Using the iterator after the <code>Bump</code> is dropped causes use-after-free accesses.</p>
</div>
<div class="paragraph">
<p>The following example demonstrates memory corruption arising from a misuse of this unsoundness.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-k">use</span><span class="tok-w"> </span><span class="tok-n">bumpalo</span>::<span class="tok-p">{</span><span class="tok-n">collections</span>::<span class="tok-nb">Vec</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Bump</span><span class="tok-p">};</span>

<span class="tok-k">fn</span> <span class="tok-nf">main</span><span class="tok-p">()</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">bump</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Bump</span>::<span class="tok-n">new</span><span class="tok-p">();</span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-k">mut</span><span class="tok-w"> </span><span class="tok-n">vec</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-nb">Vec</span>::<span class="tok-n">new_in</span><span class="tok-p">(</span><span class="tok-o">&amp;</span><span class="tok-n">bump</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-n">vec</span><span class="tok-p">.</span><span class="tok-n">extend</span><span class="tok-p">([</span><span class="tok-mh">0x01</span><span class="tok-k">u8</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-mi">32</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">into_iter</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">vec</span><span class="tok-p">.</span><span class="tok-n">into_iter</span><span class="tok-p">();</span>
<span class="tok-w">    </span><span class="tok-nb">drop</span><span class="tok-p">(</span><span class="tok-n">bump</span><span class="tok-p">);</span>

<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">_</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-mi">0</span><span class="tok-o">..</span><span class="tok-mi">100</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">reuse_bump</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">Bump</span>::<span class="tok-n">new</span><span class="tok-p">();</span>
<span class="tok-w">        </span><span class="tok-kd">let</span><span class="tok-w"> </span><span class="tok-n">_reuse_alloc</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-n">reuse_bump</span><span class="tok-p">.</span><span class="tok-n">alloc</span><span class="tok-p">([</span><span class="tok-mh">0x41</span><span class="tok-k">u8</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-mi">10</span><span class="tok-p">]);</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-k">for</span><span class="tok-w"> </span><span class="tok-n">x</span><span class="tok-w"> </span><span class="tok-k">in</span><span class="tok-w"> </span><span class="tok-n">into_iter</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-fm">print!</span><span class="tok-p">(</span><span class="tok-s">&quot;0x{:02x} &quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">x</span><span class="tok-p">);</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-fm">println!</span><span class="tok-p">();</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The issue was corrected in version 3.11.1 by adding a lifetime to the <code>IntoIter</code> type, and updating the signature of <code>Vec::into_iter()</code> to constrain this lifetime.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_33_wasmtime_out_of_bounds_readwrite_with_zero_memory_pages_configuration">68. M-33 Wasmtime out of bounds read/write with zero-memory-pages configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/119.html">CWE-119</a>, <a href="https://cwe.mitre.org/data/definitions/125.html">CWE-125</a>, <a href="https://cwe.mitre.org/data/definitions/787.html">CWE-787</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-39392">CVE-2022-39392</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-44mr-8vmm-wjhg">GHSA-44mr-8vmm-wjhg</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_5_910_7">68.1. CVSS Score: 5.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 57. CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_22">68.2. Impact</h3>
<div class="paragraph">
<p>There is a bug in Wasmtime&#8217;s implementation of its pooling instance allocator when the allocator is configured to give WebAssembly instances a maximum of zero pages of memory. In this configuration the virtual memory mapping for WebAssembly memories did not meet the compiler-required configuration requirements for safely executing WebAssembly modules. Wasmtime&#8217;s default settings require virtual memory page faults to indicate that wasm reads/writes are out-of-bounds, but the pooling allocator&#8217;s configuration would not create an appropriate virtual memory mapping for this meaning out of bounds reads/writes can successfully read/write memory unrelated to the wasm sandbox within range of the base address of the memory mapping created by the pooling allocator.</p>
</div>
<div class="paragraph">
<p>This bug can only be triggered by setting <a href="https://docs.rs/wasmtime/2.0.1/wasmtime/struct.InstanceLimits.html#structfield.memory_pages"><code>InstanceLimits::memory_pages</code></a> to zero. This is expected to be a very rare configuration since this means that wasm modules cannot allocate any pages of linear memory. All wasm modules produced by all current toolchains are highly likely to use linear memory, so it&#8217;s expected to be unlikely that this configuration is set to zero by any production embedding of Wasmtime, hence the low severity of this bug despite the critical consequences.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_21">68.3. Patches</h3>
<div class="paragraph">
<p>This bug has been patched and users should upgrade to Wasmtime 2.0.2.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_16">68.4. Workarounds</h3>
<div class="paragraph">
<p>One way to mitigate this issue is to disable usage of the pooling allocator. Note that the pooling allocator is not enabled by default.</p>
</div>
<div class="paragraph">
<p>This bug can also only be worked around by increasing the <code>memory_pages</code> allotment when configuring the pooling allocator to a value greater than zero. If an embedding wishes to still prevent memory from actually being used then the <code>Store::limiter</code> method can be used to dynamically disallow growth of memory beyond 0 bytes large. Note that the default <code>memory_pages</code> value is greater than zero.</p>
</div>
<div class="paragraph">
<p>This bug is not applicable with the default settings of the <code>wasmtime</code> crate.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_7">68.5. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.rs/wasmtime/2.0.1/wasmtime/struct.Config.html#method.allocation_strategy"><code>Config::allocation_strategy</code></a> - configuration required to enable the pooling allocator.</p>
</li>
<li>
<p><a href="https://docs.rs/wasmtime/2.0.1/wasmtime/struct.InstanceLimits.html#structfield.memory_pages"><code>InstanceLimits::memory_pages</code></a> - configuration field that, when zero, exhibits this bug.</p>
</li>
<li>
<p><a href="https://docs.rs/wasmtime/2.0.1/wasmtime/struct.Store.html#method.limiter"><code>Store::limiter</code></a> - means of limiting memory without using <code>memory_pages</code></p>
</li>
<li>
<p><a href="https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/c1HBDDJwNPA">Mailing list announcement</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/e60c3742904ccbb3e26da201c9221c38a4981d72">Patch for the <code>release-2.0.0</code> branch</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_9">68.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_34_segmentation_fault_in_time">69. M-34 Segmentation fault in time</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/476.html">CWE-476</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26235">CVE-2020-26235</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-wcg3-cvx6-7396">GHSA-wcg3-cvx6-7396</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7784" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7784</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;time&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.44&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;6db9e6914ab8b1ae1c260a4ae7a49b6c5611b40328a735b21862567685e73255&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_210">69.1. CVSS Score: 6.2/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 58. CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_23">69.2. Impact</h3>
<div class="paragraph">
<p>Unix-like operating systems may segfault due to dereferencing a dangling pointer in specific circumstances. This requires an environment variable to be set in a different thread than the affected functions. This may occur without the user&#8217;s knowledge, notably in a third-party library.</p>
</div>
<div class="paragraph">
<p>The affected functions from time 0.2.7 through 0.2.22 are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>time::UtcOffset::local_offset_at</code></p>
</li>
<li>
<p><code>time::UtcOffset::try_local_offset_at</code></p>
</li>
<li>
<p><code>time::UtcOffset::current_local_offset</code></p>
</li>
<li>
<p><code>time::UtcOffset::try_current_local_offset</code></p>
</li>
<li>
<p><code>time::OffsetDateTime::now_local</code></p>
</li>
<li>
<p><code>time::OffsetDateTime::try_now_local</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The affected functions in time 0.1 (all versions) are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>at</code></p>
</li>
<li>
<p><code>at_utc</code></p>
</li>
<li>
<p><code>now</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Non-Unix targets (including Windows and wasm) are unaffected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_22">69.3. Patches</h3>
<div class="paragraph">
<p>In some versions of <code>time</code>, the internal method that determines the local offset has been modified to always return <code>None</code> on the affected operating systems. This has the effect of returning an <code>Err</code> on the <code>try_*</code> methods and <code>UTC</code> on the non-<code>try_*</code> methods. In later versions, <code>time</code> will attempt to determine the number of threads running in the process. If the process is single-threaded, the call will proceed as its safety invariant is upheld.</p>
</div>
<div class="paragraph">
<p>Users and library authors with time in their dependency tree must perform <code>cargo update</code>, which will pull in the updated, unaffected code.</p>
</div>
<div class="paragraph">
<p>Users of time 0.1 do not have a patch and must upgrade to an unaffected version: time 0.2.23 or greater or the 0.3 series.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_17">69.4. Workarounds</h3>
<div class="paragraph">
<p>Library authors must ensure that the program only has one running thread at the time of calling any affected method. Binary authors may do the same and/or ensure that no other thread is actively mutating the environment.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_8">69.5. References</h3>
<div class="paragraph">
<p><a href="https://github.com/time-rs/time/issues/293">time-rs/time#293</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_35_h2_vulnerable_to_denial_of_service">70. M-35 h2 vulnerable to denial of service</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/770.html">CWE-770</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-26964">CVE-2023-26964</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-f8vr-r385-rh5r">GHSA-f8vr-r385-rh5r</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2051" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2051</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;h2&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.26&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;a5b34c246847f938a410a03c5458c7fee2274436675e76d8b903c08efc29c462&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Hyper is an HTTP library for Rust and h2 is an HTTP 2.0 client &amp; server implementation for Rust. An issue was discovered in h2 v0.2.4 when processing header frames. It incorrectly processes the HTTP2 <code>RST_STREAM</code> frames by not always releasing the memory immediately upon receiving the reset frame, leading to stream stacking. As a result, the memory and CPU usage are high which can lead to a Denial of Service (DoS).</p>
</div>
<div class="paragraph">
<p>This issue affects users only when dealing with http2 connections.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_36_optional_deserialize_implementations_lacking_validation">71. M-36 Optional <code>Deserialize</code> implementations lacking validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-jf5h-cf95-w759">GHSA-jf5h-cf95-w759</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5154</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;raw-cpuid&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;8.1.2&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1fdf7d9dbd43f3d81d94a49c1c3df73cc2b3827995147e6cf7f89d4ec5483e73&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When activating the non-default feature <code>serialize</code>, most structs implement
<code>serde::Deserialize</code> without sufficient validation. This allows breaking
invariants in safe code, leading to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Undefined behavior in <code>as_string()</code> methods (which use
<code>std::str::from_utf8_unchecked()</code> internally).</p>
</li>
<li>
<p>Panics due to failed assertions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/gz/rust-cpuid/issues/43" class="bare">https://github.com/gz/rust-cpuid/issues/43</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_37_use_after_free_passing_externrefs_to_wasm_in_wasmtime">72. M-37 Use after free passing `externref`s to Wasm in Wasmtime</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/416.html">CWE-416</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-39216">CVE-2021-39216</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-v4cp-h94r-m7xf">GHSA-v4cp-h94r-m7xf</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_6_310_2">72.1. CVSS Score: 6.3/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 59. CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_24">72.2. Impact</h3>
<div class="paragraph">
<p>There was a use-after-free bug when passing `externref`s from the host to guest Wasm content.</p>
</div>
<div class="paragraph">
<p>To trigger the bug, you have to explicitly pass multiple `externref`s from the host to a Wasm instance at the same time, either by</p>
</div>
<div class="ulist">
<ul>
<li>
<p>passing multiple `externref`s as arguments from host code to a Wasm function,</p>
</li>
<li>
<p>or returning multiple `externref`s to Wasm from a multi-value return function defined in the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you do not have host code that matches one of these shapes, then you are not impacted.</p>
</div>
<div class="paragraph">
<p>If Wasmtime&#8217;s <a href="https://github.com/bytecodealliance/wasmtime/blob/37c094faf53f1b356aab3c79d451395e4f7edb34/crates/runtime/src/externref.rs#L493"><code>VMExternRefActivationsTable</code></a> became filled to capacity after passing the first <code>externref</code> in, then passing in the second <code>externref</code> could trigger a garbage collection. However the first <code>externref</code> is not rooted until we pass control to Wasm, and therefore could be reclaimed by the collector if nothing else was holding a reference to it or otherwise keeping it alive. Then, when control was passed to Wasm after the garbage collection, Wasm could use the first <code>externref</code>, which at this point has already been freed.</p>
</div>
<div class="paragraph">
<p>We have reason to believe that the effective impact of this bug is relatively small because usage of <code>externref</code> is currently quite rare.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_23">72.3. Patches</h3>
<div class="paragraph">
<p>The bug has been fixed, and users should upgrade to Wasmtime 0.30.0.</p>
</div>
<div class="paragraph">
<p>Additionally, we have updated <a href="https://github.com/bytecodealliance/wasmtime/blob/37c094faf53f1b356aab3c79d451395e4f7edb34/fuzz/fuzz_targets/table_ops.rs">our primary <code>externref</code> fuzz target</a> such that it better exercises these code paths and we can have greater confidence in their correctness going forward.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_18">72.4. Workarounds</h3>
<div class="paragraph">
<p>If you cannot upgrade Wasmtime yet, you can avoid the bug by disabling reference types support in Wasmtime by passing <code>false</code> to <a href="https://docs.rs/wasmtime/0.29.0/wasmtime/struct.Config.html#method.wasm_reference_types"><code>wasmtime::Config::wasm_reference_types</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_9">72.5. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/WebAssembly/reference-types/">The reference types Wasm proposal, which introduces <code>externref</code></a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_10">72.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the <code>bytecodealliance/wasmtime</code> repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_38_memoffset_allows_reading_uninitialized_memory">73. M-38 memoffset allows reading uninitialized memory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-wfg4-322g-9vqv">GHSA-wfg4-322g-9vqv</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3468" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L3468</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;memoffset&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.5.6&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;043175f069eda7b85febe4a74abbaeff828d9f8b448515d3151a14a3542811aa&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>memoffset allows attempt of reading data from address <code>0</code> with arbitrary type. This behavior is an undefined behavior because address <code>0</code> to <code>std::mem::size_of&lt;T&gt;</code> may not have valid bit-pattern with <code>T</code>. Old implementation dereferences uninitialized memory obtained from <code>std::mem::align_of</code>. Older implementation prior to it allows using uninitialized data obtained from <code>std::mem::uninitialized</code> with arbitrary type then compute offset by taking the address of field-projection. This may also result in an undefined behavior for "father" that includes (directly or transitively) type that <a href="https://doc.rust-lang.org/nightly/reference/behavior-considered-undefined.html">does not allow to be uninitialized</a>.</p>
</div>
<div class="paragraph">
<p>This flaw was corrected by using <code>std::ptr::addr_of</code> in <a href="https://github.com/Gilnaa/memoffset/pull/50" class="bare">https://github.com/Gilnaa/memoffset/pull/50</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_39_ed25519_dalek_double_public_key_signing_function_oracle_attack">74. M-39 <code>ed25519-dalek</code> Double Public Key Signing Function Oracle Attack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-w5vr-6qhr-36cc">GHSA-w5vr-6qhr-36cc</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1312" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L1312</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;ed25519-dalek&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1.0.1&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;c762bae6dcaf24c4c84667b8579785430908723d5c889f469d76a41d59cc7a9d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Versions of <code>ed25519-dalek</code> prior to v2.0 model private and public keys as separate types which can be assembled into a <code>Keypair</code>, and also provide APIs for serializing and deserializing 64-byte private/public keypairs.</p>
</div>
<div class="paragraph">
<p>Such APIs and serializations are inherently unsafe as the public key is one of the inputs used in the deterministic computation of the <code>S</code> part of the signature, but not in the <code>R</code> value. An adversary could somehow use the signing function as an oracle that allows arbitrary public keys as input can obtain two signatures for the same message sharing the same <code>R</code> and only differ on the <code>S</code> part.</p>
</div>
<div class="paragraph">
<p>Unfortunately, when this happens, one can easily extract the private key.</p>
</div>
<div class="paragraph">
<p>Revised public APIs in v2.0 of <code>ed25519-dalek</code> do NOT allow a decoupled private/public keypair as signing input, except as part of specially labeled "hazmat" APIs which are clearly labeled as being dangerous if misused.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_40_resource_exhaustion_vulnerability_in_h2_may_lead_to_denial_of_service_dos">75. M-40 Resource exhaustion vulnerability in h2 may lead to Denial of Service (DoS)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-8r5v-vm4m-4g25">GHSA-8r5v-vm4m-4g25</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2051" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2051</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;h2&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.26&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;a5b34c246847f938a410a03c5458c7fee2274436675e76d8b903c08efc29c462&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An attacker with an HTTP/2 connection to an affected endpoint can send a steady stream of invalid frames to force the
generation of reset frames on the victim endpoint.
By closing their recv window, the attacker could then force these resets to be queued in an unbounded fashion,
resulting in Out Of Memory (OOM) and high CPU usage.</p>
</div>
<div class="paragraph">
<p>This fix is corrected in <a href="https://github.com/hyperium/h2/pull/737">hyperium/h2#737</a>, which limits the total number of
internal error resets emitted by default before the connection is closed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_41_unauthenticated_nonce_increment_in_snow">76. M-41 Unauthenticated Nonce Increment in snow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/440.html">CWE-440</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-7g9j-g5jg-3vv3">GHSA-7g9j-g5jg-3vv3</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L6744" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L6744</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;snow&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.7.2&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;795dd7aeeee24468e5a32661f6d27f7b5cbed802031b2d7640c7b10f8fb2dd50&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_impact_25">76.1. Impact</h3>
<div class="paragraph">
<p>There was a logic bug where unauthenticated payloads could still cause a nonce increment in snow&#8217;s internal state. For an attacker with the ability to inject packets into the channel Noise is talking over, this allows a denial-of-service type attack which could prevent communication as it causes the sending and receiving side to be expecting different nonce values than would arrive.</p>
</div>
<div class="paragraph">
<p>Note that this only affects those who are using the stateful <code>TransportState</code>, not those using <code>StatelessTransportState</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_24">76.2. Patches</h3>
<div class="paragraph">
<p>This has been patched in version 0.9.5, and all users are recommended to update.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_10">76.3. References</h3>
<div class="paragraph">
<p>There will be a more formal report of this in the near future.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_m_42_miscompilation_of_i8x16_swizzle_and_select_with_v128_inputs">77. M-42 Miscompilation of <code>i8x16.swizzle</code> and <code>select</code> with v128 inputs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/682.html">CWE-682</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-31104">CVE-2022-31104</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-jqwc-c49r-4w2x">GHSA-jqwc-c49r-4w2x</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L901" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L901</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;cranelift-codegen&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.69.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;1a54e4beb833a3c873a18a8fe735d73d732044004c7539a072c8faa35ccb0c60&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_4_810_2">77.1. CVSS Score: 4.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 60. CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_26">77.2. Impact</h3>
<div class="paragraph">
<p>Wasmtime&#8217;s implementation of the <a href="https://github.com/webassembly/simd">SIMD proposal for WebAssembly</a> on x86_64 contained two distinct bugs in the instruction lowerings implemented in Cranelift. The aarch64 implementation of the simd proposal is not affected. The bugs were presented in the <code>i8x16.swizzle</code> and <code>select</code> WebAssembly instructions. The <code>select</code> instruction is only affected when the inputs are of <code>v128</code> type. The correspondingly affected Cranelift instructions were <code>swizzle</code> and <code>select</code>.</p>
</div>
<div class="paragraph">
<p>The <code>swizzle</code> instruction lowering in Cranelift erroneously overwrote the mask input register which could corrupt a constant value, for example. This means that future uses of the same constant may see a different value than the constant itself.</p>
</div>
<div class="paragraph">
<p>The <code>select</code> instruction lowering in Cranelift wasn&#8217;t correctly implemented for vector types that are 128-bits wide. When the condition was 0 the wrong instruction was used to move the correct input to the output of the instruction meaning that only the low 32 bits were moved and the upper 96 bits of the result were left as whatever the register previously contained (instead of the input being moved from). The <code>select</code> instruction worked correctly if the condition was nonzero, however.</p>
</div>
<div class="paragraph">
<p>This bug in Wasmtime&#8217;s implementation of these instructions on x86_64 represents an incorrect implementation of the specified semantics of these instructions according to the <a href="https://webassembly.github.io/spec/">WebAssembly specification</a>. The impact of this is benign for hosts running WebAssembly but represents possible vulnerabilities within the execution of a guest program. For example a WebAssembly program could take unintended branches or materialize incorrect values internally which runs the risk of exposing the program itself to other related vulnerabilities which can occur from miscompilations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_25">77.3. Patches</h3>
<div class="paragraph">
<p>We have released Wasmtime 0.38.1 and cranelift-codegen (and other associated cranelift crates) 0.85.1 which contain the corrected implementations of these two instructions in Cranelift.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_19">77.4. Workarounds</h3>
<div class="paragraph">
<p>If upgrading is not an option for you at this time, you can avoid the vulnerability by <a href="https://docs.rs/wasmtime/latest/wasmtime/struct.Config.html#method.wasm_simd">disabling the Wasm simd proposal</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-n">config</span><span class="tok-p">.</span><span class="tok-n">wasm_simd</span><span class="tok-p">(</span><span class="tok-kc">false</span><span class="tok-p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally the bug is only present on x86_64 hosts. Other aarch64 hosts are not affected. Note that s390x hosts don&#8217;t yet implement the simd proposal and are not affected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_11">77.5. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/webassembly/simd">The WebAssembly simd proposal</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/issues/4315">Original test case showing the erroneous behavior</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/4318">Fix for the <code>swizzle</code> instruction</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/pull/4317">Fix for the <code>select</code> instruction</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_11">77.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="_low" class="sect0">IV: Low</h1>
<div class="sect1">
<h2 id="_l_1_rootless_sysfscgroup_is_writable_when_cgroupns_isnt_unshared_in_runc">78. L-1 rootless: <code>/sys/fs/cgroup</code> is writable when cgroupns isn&#8217;t unshared in runc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/281.html">CWE-281</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-25809">CVE-2023-25809</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-m8cg-xc2p-r3fc">GHSA-m8cg-xc2p-r3fc</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L189</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">opencontainers</span><span class="tok-o">/</span><span class="tok-nx">runc</span><span class="tok-w"> </span><span class="tok-nx">v1</span><span class="tok-mf">.0.3</span><span class="tok-w"> </span><span class="tok-c1">// indirect</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_2_510">78.1. CVSS Score: 2.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 61. CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:C/C:N/I:N/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_27">78.2. Impact</h3>
<div class="paragraph">
<p>It was found that rootless runc makes <code>/sys/fs/cgroup</code> writable in following conditons:
1. when runc is executed inside the user namespace, and the <code>config.json</code> does not specify the cgroup namespace to be unshared (e.g.., <code>(docker|podman|nerdctl) run --cgroupns=host</code>, with Rootless Docker/Podman/nerdctl)
2. or, when runc is executed outside the user namespace, and <code>/sys</code> is mounted with <code>rbind, ro</code> (e.g., <code>runc spec --rootless</code>; this condition is very rare)</p>
</div>
<div class="paragraph">
<p>A container may gain the write access to user-owned cgroup hierarchy <code>/sys/fs/cgroup/user.slice/&#8230;&#8203;</code> on the host .
Other users&#8217;s cgroup hierarchies are not affected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_26">78.3. Patches</h3>
<div class="paragraph">
<p>v1.1.5 (planned)</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_20">78.4. Workarounds</h3>
<div class="ulist">
<ul>
<li>
<p>Condition 1: Unshare the cgroup namespace (<code>(docker|podman|nerdctl) run --cgroupns=private)</code>. This is the default behavior of Docker/Podman/nerdctl on cgroup v2 hosts.</p>
</li>
<li>
<p>Condition 2 (very rare): add <code>/sys/fs/cgroup</code> to <code>maskedPaths</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_2_go_package_github_comcosmoscosmos_sdk_module_xcrisis_does_not_cause_chain_halt">79. L-2 Go package github.com/cosmos/cosmos-sdk module x/crisis does NOT cause chain halt</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-qfc5-6r3j-jj22">GHSA-qfc5-6r3j-jj22</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">-</span><span class="tok-nx">sdk</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.45.4</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_xcrisis_does_not_cause_chain_halt">79.1. x/crisis does NOT cause chain halt</h3>

</div>
<div class="sect2">
<h3 id="_impact_28">79.2. Impact</h3>
<div class="paragraph">
<p>If an invariant check fails on a Cosmos SDK network and a transaction is sent to the <code>x/crisis</code> module to halt the chain, the chain does not halt. All versions of the <code>x/crisis</code> module is affected on all versions of the Cosmos SDK.</p>
</div>
</div>
<div class="sect2">
<h3 id="_details_3">79.3. Details</h3>
<div class="paragraph">
<p>The <code>x/crisis</code> module is supposed to allow anyone to halt a chain in the event of a violated invariant by sending a <code>MsgVerifyInvariant</code> with the name of the invariant. Processing this message is supposed to cause the nodes to panic. However, because the panic is within a transaction, it is caught by the SDKs built-in panic-recovery machinery and just treated as a normal invalid transaction (ie. it returns a non-zero abci Code). Thus the <code>x/crisis</code> transactions dont actually cause chains to halt. If there is an invariant violation, it can be confirmed with an <code>x/crisis</code> transaction, but it wont cause any nodes to halt, they will just continue processing blocks.</p>
</div>
<div class="paragraph">
<p>That said, any node running with <code>start --inv-check-period X</code> will actually panic when it runs the periodic check (though it will still not panic just by processing an <code>x/crisis</code> transaction). Since this panic is located in EndBlock, it is not caught by the panic-recovery machinery and does actually crash the node. Presumably few if any nodes actually run with this in production because of how long the invariant checks take, and this runs all of them every <code>X</code> blocks.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_27">79.4. Patches</h3>
<div class="paragraph">
<p>No patches will be released.</p>
</div>
<div class="paragraph">
<p>The <code>x/crisis</code> module was originally intended to allow chains to halt rather than continue with some unknown behaviour in the case of an invariant violation (safety over liveness). However, as chains mature, and especially as the potential <a href="https://github.com/osmosis-labs/osmosis/issues/570">cost of halting increases</a>, chains should consider carefully what invariants they really want to halt for, and what invariants are just sort of helpful sanity checks, but may not be worth halting for.</p>
</div>
<div class="paragraph">
<p>In some cases, chains have already broken the invariant calculations but have dealt with the consequences off-chain or during development. Halting these chains would be counter-productive.</p>
</div>
<div class="paragraph">
<p>The SDK team is working on new modules that allow chain developers to fine-tune the chain invariants and the necessary actions.</p>
</div>
<div class="paragraph">
<p>Hence, the decision was made that the <code>x/crisis</code> module will not be patched for chain halts. The module will be deprecated when new modules take over its responsibilities.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_21">79.5. Workarounds</h3>
<div class="paragraph">
<p>In case of a valid invariant check failure that requires a chain halt, the network validators are encouraged to coordinate off-chain for network halts. This has been an already established process for security patches.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_12">79.6. References</h3>
<div class="paragraph">
<p>SDK developer epic about invariant checking: <a href="https://github.com/cosmos/cosmos-sdk/issues/15706" class="bare">https://github.com/cosmos/cosmos-sdk/issues/15706</a>
Public report: <a href="https://github.com/cosmos/cosmos-sdk/issues/15325" class="bare">https://github.com/cosmos/cosmos-sdk/issues/15325</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_3_github_comcosmoscosmos_sdks_xcrisis_does_not_charge_constantfee">80. L-3 github.com/cosmos/cosmos-sdk&#8217;s x/crisis does not charge ConstantFee</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-w5w5-2882-47pc">GHSA-w5w5-2882-47pc</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">-</span><span class="tok-nx">sdk</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.45.4</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_xcrisis_does_not_charge_constantfee">80.1. x/crisis does not charge ConstantFee</h3>

</div>
<div class="sect2">
<h3 id="_impact_29">80.2. Impact</h3>
<div class="paragraph">
<p>If a transaction is sent to the <code>x/crisis</code> module to check an invariant, the ConstantFee parameter of the chain is NOT charged. All versions of the <code>x/crisis</code> module are affected on all versions of the Cosmos SDK.</p>
</div>
</div>
<div class="sect2">
<h3 id="_details_4">80.3. Details</h3>
<div class="paragraph">
<p>The <code>x/crisis</code> module is supposed to allow anyone to halt a chain in the event of a violated invariant by sending a <code>MsgVerifyInvariant</code> with the name of the invariant. Processing this message takes extra processing power hence a <code>ConstantFee</code> was introduced on the chain that is charged as extra from the reporter for the extra computational work. This is supposed to avert spammers on the chain making nodes do extra computations using this transaction. By not charging the <code>ConstantFee</code>, the transactions related to invariant checking are relatively cheaper compared to the computational need and other transactions.</p>
</div>
<div class="paragraph">
<p>That said, the submitter still has to pay the transaction fee to put the transaction on the network, hence using this weakness for spamming is limited by the usual mechanisms.</p>
</div>
<div class="paragraph">
<p>Synthetic testing showed up to a 20% increase in CPU usage on a validator node that is spammed by hundreds of <code>MsgVerifyInvariant</code> messages which still makes this an expensive operation to carry out on a live blockchain network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_28">80.4. Patches</h3>
<div class="paragraph">
<p>The <code>ConstantFee</code> charge of the <code>x/crisis</code> module will either be fixed or disabled in an upcoming regular release of the Cosmos SDK.</p>
</div>
<div class="paragraph">
<p>The <code>x/crisis</code> module was originally intended to allow chains to halt rather than continue with some unknown behavior in the case of an invariant violation (safety over liveness). However, as chains mature, and especially as the potential <a href="https://github.com/osmosis-labs/osmosis/issues/570">cost of halting increases</a>, chains should consider carefully what invariants they really want to halt for, and what invariants are just sort of helpful sanity checks.</p>
</div>
<div class="paragraph">
<p>The SDK team is working on new modules that allow chain developers to fine-tune the chain invariants and the necessary actions.</p>
</div>
<div class="paragraph">
<p>Hence, the decision was made that the <code>x/crisis</code> module will be deprecated when new modules take over its responsibilities.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_22">80.5. Workarounds</h3>
<div class="paragraph">
<p>There is no workaround posted. Validators are advised to leave some extra computing room on their servers for possible spamming scenarios. (This is a good measure in any case.)</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_13">80.6. References</h3>
<div class="paragraph">
<p>SDK developer epic about invariant checking: <a href="https://github.com/cosmos/cosmos-sdk/issues/15706" class="bare">https://github.com/cosmos/cosmos-sdk/issues/15706</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_4_asa_2024_003_missing_blockedaddressed_validation_in_vesting_module">81. L-4 ASA-2024-003: Missing <code>BlockedAddressed</code> Validation in Vesting Module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-4j93-fm92-rp4m">GHSA-4j93-fm92-rp4m</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">-</span><span class="tok-nx">sdk</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.45.4</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_3_510">81.1. CVSS Score: 3.5/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 62. CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adjacent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_asa_2024_003_missing_blockedaddressed_validation_in_vesting_module">81.2. ASA-2024-003: Missing <code>BlockedAddressed</code> Validation in Vesting Module</h3>
<div class="paragraph">
<p><strong>Component</strong>: Cosmos SDK
<strong>Criticality</strong>: Low
<strong>Affected Versions</strong>: Cosmos SDK versions &#8656; 0.50.3; &#8656; 0.47.8
<strong>Affected Users</strong>: Chain developers, Validator and Node operators
<strong>Impact</strong>: Denial of Service</p>
</div>
</div>
<div class="sect2">
<h3 id="_description_2">81.3. Description</h3>
<div class="paragraph">
<p>A vulnerability was identified in the <code>x/auth/vesting</code> module, which can allow a user to create a periodic vesting account on a blocked address, for example a non-initialized module account. Additional validation was added to prevent creation of a periodic vesting account in this scenario.</p>
</div>
<div class="paragraph">
<p>If this case is triggered, there is the potential for a chain halt if the uninitialized account in question is called by <code>GetModuleAccount</code> in <code>Begin</code>/<code>EndBlock</code> of a module. This combination of an uninitialized blocked module account is not common.</p>
</div>
</div>
<div class="sect2">
<h3 id="_next_steps_for_impacted_parties_2">81.4. Next Steps for Impacted Parties</h3>
<div class="paragraph">
<p>If your chain has uninitialized blocked module accounts, it is recommended to proactively initialize them, as they are often initialized during a chain migration or during init genesis.</p>
</div>
<div class="paragraph">
<p>If you are a chain developer on an affected version of the Cosmos SDK, it is advised to update to the latest available version of the Cosmos SDK for your project.  Once a patched version is available, it is recommended that network operators upgrade.</p>
</div>
<div class="paragraph">
<p>A Github Security Advisory for this issue is available in the Cosmos-SDK <a href="https://github.com/cosmos/cosmos-sdk/security/advisories">repository</a>. For more information about Cosmos SDK, see <a href="https://docs.cosmos.network/" class="bare">https://docs.cosmos.network/</a>.</p>
</div>
<div class="paragraph">
<p>This issue was found by <a href="https://github.com/dongsam">Dongsam</a> who reported it to the Cosmos Bug Bounty Program on HackerOne on January 30, 2024. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos" class="bare">https://hackerone.com/cosmos</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_5_asa_2024_005_potential_slashing_evasion_during_re_delegation">82. L-5 ASA-2024-005: Potential slashing evasion during re-delegation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/372.html">CWE-372</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-86h5-xcpx-cfqc">GHSA-86h5-xcpx-cfqc</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Golang_Cosmos/go.mod#L6</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="go"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-w">	</span><span class="tok-nx">github</span><span class="tok-p">.</span><span class="tok-nx">com</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">/</span><span class="tok-nx">cosmos</span><span class="tok-o">-</span><span class="tok-nx">sdk</span><span class="tok-w"> </span><span class="tok-nx">v0</span><span class="tok-mf">.45.4</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_asa_2024_005_potential_slashing_evasion_during_re_delegation">82.1. ASA-2024-005: Potential slashing evasion during re-delegation</h3>
<div class="paragraph">
<p><strong>Component</strong>: Cosmos SDK
<strong>Criticality</strong>: Low
<strong>Affected Versions</strong>: Cosmos SDK versions &#8656; 0.50.4; &#8656; 0.47.9
<strong>Affected Users</strong>: Chain developers, Validator and Node operators
<strong>Impact</strong>: Slashing Evasion</p>
</div>
</div>
<div class="sect2">
<h3 id="_summary_5">82.2. Summary</h3>
<div class="paragraph">
<p>An issue was identified in the slashing mechanism that may allow for the evasion of slashing penalties during a slashing event. If a delegation contributed to byzantine behavior of a validator, and the validator has not yet been slashed, it may be possible for that delegation to evade a pending slashing penalty through re-delegation behavior. Additional validation logic was added to restrict this behavior.</p>
</div>
</div>
<div class="sect2">
<h3 id="_next_steps_for_impacted_parties_3">82.3. Next Steps for Impacted Parties</h3>
<div class="paragraph">
<p>If you are a chain developer on an affected version of the Cosmos SDK, it is advised to update to the latest available version of the Cosmos SDK for your project.  Once a patched version is available, it is recommended that network operators upgrade.</p>
</div>
<div class="paragraph">
<p>A Github Security Advisory for this issue is available in the Cosmos-SDK <a href="https://github.com/cosmos/cosmos-sdk/security/advisories/GHSA-86h5-xcpx-cfqc">repository</a>. For more information about Cosmos SDK, see <a href="https://docs.cosmos.network/" class="bare">https://docs.cosmos.network/</a>.</p>
</div>
<div class="paragraph">
<p>This issue was found by cat shark (Khanh) who reported it to the Cosmos Bug Bounty Program on HackerOne on December 6, 2024. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos" class="bare">https://hackerone.com/cosmos</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_6_lenient_parsing_of_content_length_header_when_prefixed_with_plus_sign">83. L-6 Lenient Parsing of Content-Length Header When Prefixed with Plus Sign</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/444.html">CWE-444</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32715">CVE-2021-32715</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-f3pg-qwvg-p99c">GHSA-f3pg-qwvg-p99c</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2259" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L2259</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;hyper&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.12.36&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;5c843caf6296fc1f93444735205af9ed4e109a539005abb2564ae1d6fad34c52&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_3_110">83.1. CVSS Score: 3.1/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 63. CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_summary_6">83.2. Summary</h3>
<div class="paragraph">
<p>hyper&#8217;s HTTP/1 server code had a flaw that incorrectly parses and accepts requests with a <code>Content-Length</code> header with a prefixed plus sign, when it should have been rejected as illegal. This combined with an upstream HTTP proxy that doesn&#8217;t parse such <code>Content-Length</code> headers, but forwards them, can result in "request smuggling" or "desync attacks".</p>
</div>
</div>
<div class="sect2">
<h3 id="_vulnerability_2">83.3. Vulnerability</h3>
<div class="paragraph">
<p>The flaw exists in all prior versions of hyper, if built with <a href="https://github.com/rust-lang/rust/pull/28826/commits/123a83326fb95366e94a3be1a74775df4db97739"><code>rustc</code> v1.5.0 or newer</a>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>GET / HTTP/1.1
Host: example.com
Content-Length: +3

abc</code></pre>
</div>
</div>
<div class="paragraph">
<p>This request gets accepted and hyper reads the body as abc. The request <em>should</em> be rejected, according to RFC 7230, since the ABNF for <code>Content-Length</code> only allows for <code>DIGIT`s. This is due to using the `FromStr</code> implementation for <code>u64</code> in the standard library. By differing from the spec, it is possible to send requests like these to endpoints that have different HTTP implementations, with different interpretations of the payload semantics, and cause "desync attacks".</p>
</div>
<div class="paragraph">
<p>In this particular case, an upstream proxy would need to error when parsing the <code>Content-Length</code>, but <em>not</em> reject the request (swallowing its own error), and forwarding the request as-is with the <code>Content-Length</code> still included. <em>Then</em> the upstream proxy and hyper would disagree on the length of the request body. The combination of these factors would be extremely rare.</p>
</div>
<div class="paragraph">
<p>Read more about desync attacks: <a href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn" class="bare">https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_impact_30">83.4. Impact</h3>
<div class="paragraph">
<p>To determine if vulnerable, all these things must be true:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Using hyper as an HTTP server</strong>. While the lenient decoder also exists in the client, a vulnerability does not exist around <em>responses</em>.</p>
</li>
<li>
<p><strong>Using HTTP/1</strong>. The HTTP/2 code uses a stricter parser.</p>
</li>
<li>
<p><strong>Using a vulnerable HTTP proxy upstream to hyper</strong>. If an upstream proxy correctly rejects the illegal <code>Content-Length</code> header, <strong>OR</strong> can parse the length with the plus sign, the desync attack cannot succeed.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_patches_29">83.5. Patches</h3>
<div class="paragraph">
<p>We have released the following patch versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>v0.14.10 (to be released when this advisor is published)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_23">83.6. Workarounds</h3>
<div class="paragraph">
<p>Besides upgrading hyper, you can take the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reject requests manually that contain a plus sign prefix in the <code>Content-Length</code> header.</p>
</li>
<li>
<p>Ensure any upstream proxy handles <code>Content-Length</code> headers with a plus sign prefix.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_credits_6">83.7. Credits</h3>
<div class="paragraph">
<p>This issue was initially reported by <a href="https://grenfeldt.dev/">Mattias Grenfeldt</a> and Asta Olofsson.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_7_tokioioreadhalftunsplit_is_unsound">84. L-7 <code>tokio::io::ReadHalf&lt;T&gt;::unsplit</code> is Unsound</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-4q83-7cq4-p6wg">GHSA-4q83-7cq4-p6wg</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7837" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L7837</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;tokio&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.1.22&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;5a09c0b5bb588872ab2f09afa13ee6e9dac11e10a0ec9e8e3ba39a5a5d530af6&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>tokio::io::ReadHalf&lt;T&gt;::unsplit</code> can violate the <code>Pin</code> contract</p>
</div>
<div class="paragraph">
<p>The soundness issue is described in the <a href="https://github.com/tokio-rs/tokio/issues/5372">tokio/issues#5372</a></p>
</div>
<div class="paragraph">
<p>Specific set of conditions needed to trigger an issue (a !Unpin type in ReadHalf)
is unusual, combined with the difficulty of making any arbitrary use-after-free
exploitable in Rust without doing a lot of careful alignment of data types in
the surrounding code.</p>
</div>
<div class="paragraph">
<p>The <code>tokio</code> feature <code>io-util</code> is also required to be enabled to trigger this
soundness issue.</p>
</div>
<div class="paragraph">
<p>Thanks to zachs18 reporting the issue to Tokio team responsibly and taiki-e
and carllerche appropriately responding and fixing the soundness bug.</p>
</div>
<div class="paragraph">
<p>Tokio before 0.2.0 used <code>futures</code> 0.1 that did not have <code>Pin</code>, so it is not
affected by this issue.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_8_race_condition_enabling_link_following_and_time_of_check_time_of_use_toctou_race_condition_in_remove_dir_all">85. L-8 Race Condition Enabling Link Following and Time-of-check Time-of-use (TOCTOU) Race Condition in remove_dir_all</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/366.html">CWE-366</a>, <a href="https://cwe.mitre.org/data/definitions/367.html">CWE-367</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-mc8h-8q98-g5hr">GHSA-mc8h-8q98-g5hr</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5300" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L5300</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;remove_dir_all&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.5.3&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;3acd125665422973a33ac9d3dd2df85edad0f4ae9b00dafb1a05e43a9f5ef8e7&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>remove_dir_all</code> crate is a Rust library that offers additional features over the Rust standard library <code>fs::remove_dir_all</code> function. It suffers the same class of failure as the code it was layering over: TOCTOU race conditions, with the ability to cause arbitrary paths to be deleted by substituting a symlink for a path after the type of the path was checked.</p>
</div>
<div class="paragraph">
<p>Thanks to the Rust security team for identifying the problem and alerting us to it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_9_undefined_behavior_in_rust_runtime_functions">86. L-9 Undefined Behavior in Rust runtime functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/758.html">CWE-758</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-30624">CVE-2023-30624</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-ch89-5g45-qwc7">GHSA-ch89-5g45-qwc7</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_3_910">86.1. CVSS Score: 3.9/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 64. CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_31">86.2. Impact</h3>
<div class="paragraph">
<p>Wasmtime&#8217;s implementation of managing per-instance state, such as tables and memories, contains LLVM-level undefined behavior. This undefined behavior was found to cause runtime-level issues when compiled with LLVM 16 which causes some writes, which are critical for correctness, to be optimized away. Vulnerable versions of Wasmtime compiled with Rust 1.70, which is currently in beta, or later are known to have incorrectly compiled functions. Versions of Wasmtime compiled with the current Rust stable release, 1.69, and prior are not known at this time to have any issues, but can theoretically exhibit potential issues.</p>
</div>
<div class="paragraph">
<p>The underlying problem is that Wasmtime&#8217;s runtime state for an instance involves a Rust-defined structure called <code>Instance</code> which has a trailing <code>VMContext</code> structure after it. This <code>VMContext</code> structure has a runtime-defined layout that is unique per-module. This representation cannot be expressed with safe code in Rust so <code>unsafe</code> code is required to maintain this state. The code doing this, however, has methods which take <code>&amp;self</code> as an argument but modify data in the <code>VMContext</code> part of the allocation. This means that pointers derived from <code>&amp;self</code> are mutated. This is typically not allowed, except in the presence of <code>UnsafeCell</code>, in Rust. When compiled to LLVM these functions have <code>noalias readonly</code> parameters which means it&#8217;s UB to write through the pointers.</p>
</div>
<div class="paragraph">
<p>Wasmtime&#8217;s internal representation and management of <code>VMContext</code> has been updated to use <code>&amp;mut self</code> methods where appropriate. Additionally verification tools for <code>unsafe</code> code in Rust, such as <code>cargo miri</code>, are planned to be executed on the <code>main</code> branch soon to fix any Rust-level issues that may be exploited in future compiler versions.</p>
</div>
<div class="paragraph">
<p>Precomplied binaries available for Wasmtime from GitHub releases have been compiled with at most LLVM 15 so are not known to be vulnerable. As mentioned above, however, it&#8217;s still recommended to update.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_30">86.3. Patches</h3>
<div class="paragraph">
<p>Wasmtime version 6.0.2, 7.0.1, and 8.0.1 have been issued which contain the patch necessary to work correctly on LLVM 16 and have no known UB on LLVM 15 and earlier.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_24">86.4. Workarounds</h3>
<div class="paragraph">
<p>If Wasmtime is compiled with Rust 1.69 and prior, which use LLVM 15, then there are no known issues. There is a theoretical possibility for UB to exploited, however, so it&#8217;s recommended that users upgrade to a patched version of Wasmtime. Users using beta Rust (1.70 at this time) or nightly Rust (1.71 at this time) must update to a patched version to work correctly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_14">86.5. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/security/advisories/GHSA-ch89-5g45-qwc7">GitHub Advisory</a></p>
</li>
<li>
<p><a href="https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/ecK-6G2yi90">Mailing list announcement</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_12">86.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_10_atty_potential_unaligned_read">87. L-10 atty potential unaligned read</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, GHSA ID: <a href="https://github.com/advisories/GHSA-g98v-hv3f-hcfr">GHSA-g98v-hv3f-hcfr</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L390" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L390</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;atty&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.2.14&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;d9b39be18770d11421cdb1b9947a45dd3f37e93092cbf377614828a319d5fee8&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>On windows, <code>atty</code> dereferences a potentially unaligned pointer.</p>
</div>
<div class="paragraph">
<p>In practice however, the pointer won&#8217;t be unaligned unless a custom global allocator is used.</p>
</div>
<div class="paragraph">
<p>In particular, the <code>System</code> allocator on windows uses <code>HeapAlloc</code>, which guarantees a large enough alignment.</p>
</div>
<div class="sect2">
<h3 id="_atty_is_unmaintained">87.1. atty is Unmaintained</h3>
<div class="paragraph">
<p>A Pull Request with a fix has been provided over a year ago but the maintainer seems to be unreachable.</p>
</div>
<div class="paragraph">
<p>Last release of <code>atty</code> was almost 3 years ago.</p>
</div>
</div>
<div class="sect2">
<h3 id="_possible_alternatives">87.2. Possible Alternative(s)</h3>
<div class="paragraph">
<p>The below list has not been vetted in any way and may or may not contain alternatives;</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://doc.rust-lang.org/stable/std/io/trait.IsTerminal.html">std::io::IsTerminal</a> - Stable since Rust 1.70.0</p>
</li>
<li>
<p><a href="https://crates.io/crates/is-terminal">is-terminal</a> - Standalone crate supporting Rust older than 1.70.0"</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_l_11_wasmtime_trap_code_c_api_function_has_out_of_bounds_write_vulnerability">88. L-11 wasmtime_trap_code C API function has out of bounds write vulnerability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tags: <code>runtime</code>, Weakness: <a href="https://cwe.mitre.org/data/definitions/787.html">CWE-787</a>, CVE ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-39394">CVE-2022-39394</a>, GHSA ID: <a href="https://github.com/advisories/GHSA-h84q-m8rr-3v9q">GHSA-h84q-m8rr-3v9q</a></p>
</div>
<div class="listingblock">
<div class="title">File <a href="https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590" class="bare">https://github.com/HalbornSecurity/CTFs/blob/e0e91e535617f9ed3bfeb5db740e7c9782dca1ee/HalbornCTF_Rust_Substrate/Cargo.lock#L8590</a></div>
<div class="content">
<pre class="pygments highlight"><code data-lang="rust"><span></span><span class="tok-o">++++</span><span class="tok-w"> </span><b class="conum">(1)</b>
<span class="tok-p">[[</span><span class="tok-n">package</span><span class="tok-p">]]</span>
<span class="tok-n">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;wasmtime&quot;</span>
<span class="tok-n">version</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;0.22.0&quot;</span>
<span class="tok-n">source</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;registry+https://github.com/rust-lang/crates.io-index&quot;</span>
<span class="tok-n">checksum</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;7426055cb92bd9a1e9469b48154d8d6119cd8c498c8b70284e420342c05dc45d&quot;</span>
<span class="tok-o">++++</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_cvss_score_3_810">88.1. CVSS Score: 3.8/10</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 65. CVSS:3.1/AV:L/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:L</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">CVSS base metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack vector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attack complexity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Privileges required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User interaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unchange</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Confidentiality</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Availability</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_impact_32">88.2. Impact</h3>
<div class="paragraph">
<p>There is a bug in Wasmtime&#8217;s C API implementation where the definition of the <code>wasmtime_trap_code</code> does not match its declared signature in the <code>wasmtime/trap.h</code> header file. This discrepancy causes the function implementation to perform a 4-byte write into a 1-byte buffer provided by the caller. This can lead to three zero bytes being written beyond the 1-byte location provided by the caller.</p>
</div>
</div>
<div class="sect2">
<h3 id="_patches_31">88.3. Patches</h3>
<div class="paragraph">
<p>This bug has been patched and users should upgrade to Wasmtime 2.0.2.</p>
</div>
</div>
<div class="sect2">
<h3 id="_workarounds_25">88.4. Workarounds</h3>
<div class="paragraph">
<p>This can be worked around by providing a 4-byte buffer casted to a 1-byte buffer when calling <code>wasmtime_trap_code</code>. Users of the <code>wasmtime</code> crate are not affected by this issue, only users of the C API function <code>wasmtime_trap_code</code> are affected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_15">88.5. References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.wasmtime.dev/c-api/trap_8h.html#a6580f4f209d3eaebb6e8b9a901a30b7a">Definition of <code>wasmtime_trap_code</code></a></p>
</li>
<li>
<p><a href="https://groups.google.com/a/bytecodealliance.org/g/sec-announce/c/c1HBDDJwNPA">Mailing list announcement</a></p>
</li>
<li>
<p><a href="https://github.com/bytecodealliance/wasmtime/commit/5b6d5e78de106503b3b9add218bb3d2b1d63c493">Patch to fix for <code>main</code> branch</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_more_information_13">88.6. For more information</h3>
<div class="paragraph">
<p>If you have any questions or comments about this advisory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reach out to us on <a href="https://bytecodealliance.zulipchat.com/#narrow/stream/217126-wasmtime">the Bytecode Alliance Zulip chat</a></p>
</li>
<li>
<p>Open an issue in <a href="https://github.com/bytecodealliance/wasmtime/">the bytecodealliance/wasmtime repository</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="_informational" class="sect0">V: Informational</h1>
<div class="sect1">
<h2 id="_i_1_malicious_ds_store_file">89. I-1 Malicious <code>.DS_Store</code> file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I ran a dsstore parser <a href="#2">[2]</a> to extract the metadata from <code>/.DS_Store</code> binary file. I found that <code>/.DS_Store</code> file is a malicious file and has probably been tampered with. If you want to learn more about parsing the .DS_Store file and its security implications see article <a href="#3">[3]</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><code>.DS_Store</code> file can leak information about the structure of a users directory or server. This information can be used by an attacker to identify the directories and could even expose sensitive information like private keys.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Output from parsing <code>.DS_Store</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="shell"><span></span>Count:<span class="tok-w">  </span><span class="tok-m">4</span>
HalbornCTF_Rust_Substrate
HalbornCTF_Rust_Substrate
HalbornCTF_Rust_Substrate
HalbornCTF_Solidity_Ethereum</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_impact_33">89.1. Impact</h3>
<div class="paragraph">
<p>The content shows 3 directories of the same name <code>HalbornCTF_Rust_Substrate</code> followed by <code>HalbornCTF_Solidity_Ethereum</code> which contradicts what is currently present in this repository. This indicated with a <strong>HIGH</strong> probability that <code>.DS_Store</code> has a bug or a malicious actor could have tampered with this file. A file system is unlikely to have 3 directories with the same name store within the same directory. I ask you to follow my recommendations below to mitigate this vulnerability.</p>
</div>
</div>
<div class="sect2">
<h3 id="_recommendation">89.2. Recommendation</h3>
<div class="ulist">
<ul>
<li>
<p>Remove the <code>.DS_Store</code> file from the repository see <a href="http://stackoverflow.com/questions/1139762/ddg#1139797">stackoverflow example here</a>.</p>
</li>
<li>
<p>Create <code>.gitignore</code> file at the root of your repository and add <code>.DS_Store</code> to prevent it from being added to the repository in the future.</p>
</li>
<li>
<p>Additionally use an <a href="https://git-scm.com/docs/githooks#update">update hook</a> to prevent certain files from being pushed to your repositories, see <a href="https://stackoverflow.com/a/4145628/1657610">stackoverflow example here</a>. This can prevent anyone from force pushing a file even if it has already been included in your <code>.gitignore</code>.</p>
</li>
<li>
<p>I recommend that anyone working on this project to take pre-cautions by working in an isolated virtual enviroment to prevent exposing your system files to malicious third parties who could also try to comprimise your system when sharing code.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tools_used">Exhibit A: Tools Used</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dependabot">A.1. Dependabot</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_challenges">Exhibit B: Challenges</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_context">B.1. Context</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_terminology">Terminology</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_references_16">References</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="python-dsstore"></a>[2] <a href="https://github.com/gehaxelt/Python-dsstore" class="bare">https://github.com/gehaxelt/Python-dsstore</a></p>
</li>
<li>
<p><a id="parsing-dsstor"></a>[3] <a href="https://0day.work/parsing-the-ds_store-file-format/" class="bare">https://0day.work/parsing-the-ds_store-file-format/</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version v1.0<br>
Last updated 2024-04-01 19:36:59 -0500
</div>
</div>
</body>
</html>